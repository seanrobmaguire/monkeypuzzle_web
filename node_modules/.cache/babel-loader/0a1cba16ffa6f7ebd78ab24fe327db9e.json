{"ast":null,"code":"var _jsxFileName = \"/Users/gareth/Desktop/monkeypuzzle/src/App.js\";\nimport React, { Component } from 'react';\nimport Slideout from 'slideout'; //import Components\n\nimport MainUI from './Components/MainUI';\nimport Menu from './Components/Menu';\nimport './CSS/monkeypuzzle.css'; //import './CSS/font-awesome.min.css';\n//import './CSS/jquery.qtip.min.css';\n//import './CSS/bootstrap.min.css';\n\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport './CSS/App.css'; //import fuctions from SADFACE\n\nimport { update_resource, remove_resources_from_nodes, loadSADFace, saveSADFace, delete_resource, get_sd, import_json, add_resource, export_cytoscape, add_resource_metadata } from './lib/Sadface';\n\nclass App extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      tabs: [],\n      last_number: 0,\n      tab_id: \"\",\n      sd: get_sd(),\n      showResourcePane: true,\n      test: {},\n      current_tab: 0,\n      cy_data: null,\n      selected: '',\n      jpg: '',\n      png: '',\n      fileName: '',\n      json: '',\n      current_sadface_doc: '',\n      cy: null,\n      remove_all_tabs: false,\n      resourceType: 'text',\n      update_local_storage: false,\n      focused: null,\n      selectedText: null,\n      focus: false\n    };\n    this.toggleButton = this.toggleButton.bind(this);\n    this.add_to_tabs_arr = this.add_to_tabs_arr.bind(this);\n    this.download = this.download.bind(this);\n    this.loadJSON = this.loadJSON.bind(this);\n    this.loadTabs = this.loadTabs.bind(this);\n    this.get_resource = this.get_resource.bind(this);\n    this.download = this.download.bind(this);\n    this.toggleResourcePane = this.toggleResourcePane.bind(this);\n    this.add_resource_metadata = this.add_resource_metadata.bind(this);\n    this.setActiveTab = this.setActiveTab.bind(this);\n    this.download = this.download.bind(this);\n    this.fileManager = this.fileManager.bind(this);\n    this.setCyData = this.setCyData.bind(this); //ResourcePane Functions\n\n    this.add_tab = this.add_tab.bind(this);\n    this.remove_tab = this.remove_tab.bind(this);\n    this.change_title = this.change_title.bind(this);\n    this.change_content = this.change_content.bind(this);\n    this.set_text_resource_content = this.set_text_resource_content.bind(this);\n    this.add_tab_to_tab_array = this.add_tab_to_tab_array.bind(this);\n    this.setType = this.setType.bind(this);\n    this.load_tab = this.load_tab.bind(this);\n    this.updateTab = this.updateTab.bind(this);\n    this.getTab = this.getTab.bind(this);\n    this.setSelectedText = this.setSelectedText.bind(this); //Menu\n\n    this.handleSetPng = this.handleSetPng.bind(this);\n    this.handleSetJpg = this.handleSetJpg.bind(this);\n    this.load_demo_argument = this.load_demo_argument.bind(this);\n    this.setFileName = this.setFileName.bind(this); //Cytoscape\n\n    this.clearSelection = this.clearSelection.bind(this);\n  }\n\n  add_to_tabs_arr(tab_id) {\n    this.setState(state => {\n      const tabs = state.tabs.concat(tab_id);\n      return {\n        tabs\n      };\n    }, function () {\n      console.log(\"tabs\");\n    }.bind(this));\n  }\n\n  openAddBoardModal() {\n    this.setState({\n      boardAddModalShow: true\n    }, function () {\n      console.log(this.state.boardAddModalShow);\n    });\n  }\n\n  add_tab() {\n    let newTab = {};\n    console.log('load tab null');\n    newTab = add_resource(' ');\n    console.log(newTab, 'newTab');\n    add_resource_metadata(newTab.id, 'title', '');\n    newTab.metadata = {\n      title: ''\n    };\n    console.log(newTab, 'newTab with metadata');\n    localStorage.setItem(\"state\", JSON.stringify(get_sd()));\n    newTab.type = this.state.resourceType;\n    this.add_tab_to_tab_array(newTab);\n  }\n\n  add_tab_to_tab_array(newTab) {\n    this.setState(state => {\n      const tabs = this.state.tabs.concat(newTab);\n      return {\n        tabs\n      };\n    }, () => {\n      console.log(this.state.tabs, 'added to array');\n      this.setActiveTab(newTab.id);\n    });\n  }\n\n  setType(type) {\n    this.setState({\n      resourceType: type\n    }, () => console.log(this.state.resourceType, 'type set'));\n  }\n\n  test(index) {\n    this.setState({\n      current_tab: index\n    });\n    console.log(this.current_tab);\n  }\n\n  setActiveTab(value) {\n    this.setState({\n      current_tab: value\n    }, function () {\n      console.log(this.state.current_tab, 'active');\n    });\n  }\n\n  add_resource_metadata(resource_id, key, value) {\n    /*\n    Add metadata, a key:value pair to the resource dict identified\n    by the supplied atom ID.    \n    */\n    if (resource_id && key && value) {\n      this.sate.sd.resources.forEach(function (res) {\n        if (res.id === resource_id) {\n          res.metadata[key] = value;\n        }\n      });\n    }\n  } //Menu function\n\n\n  handleSetPng(png) {\n    this.setState({\n      png: png\n    }, () => console.log('PNG set'));\n  }\n\n  handleSetJpg(jpg) {\n    this.setState({\n      jpg: jpg\n    }, () => console.log('JPG set'));\n  }\n\n  componentDidMount() {\n    this.slideout = new Slideout({\n      'panel': document.getElementById('panel'),\n      'menu': document.getElementById('menu'),\n      \"fx\": \"ease\",\n      \"side\": \"right\",\n      \"duration\": 500,\n      \"padding\": 256,\n      \"tolerance\": 70\n    });\n  }\n\n  remove_tab(i) {\n    delete_resource(this.state.current_tab);\n    remove_resources_from_nodes(this.state.current_tab);\n    localStorage.setItem(\"state\", JSON.stringify(get_sd()));\n\n    if (this.state.tabs.length >= 1 && i != -1) {\n      this.setState(state => {\n        const tabs = state.tabs.filter((item, j) => i !== j);\n        return {\n          tabs\n        };\n      }, () => {\n        console.log(this.state.tabs.length, 'current tabs');\n        let newCurrent = this.state.tabs[this.state.tabs.length - 1].id;\n        console.log(newCurrent, 'newCurrent');\n        console.log(this.state.tabs, 'tabs');\n        this.setState({\n          current_tab: newCurrent\n        }, () => console.log(this.state.current_tab, 'current tabs'));\n      });\n    }\n  }\n\n  remove_all_tabs() {\n    this.setState({\n      tabs: [],\n      last_number: 1\n    }, () => {\n      console.log(this.state.tabs, 'remove all tabs');\n    });\n  }\n\n  toggleButton() {\n    this.slideout.toggle();\n  }\n\n  fileManager(operation, filetype, tab_id) {\n    /*\n    Write text from tab to file or does a SADFace save operation\n    */\n    console.log(operation, filetype, tab_id);\n\n    if (\"save\" == operation) {\n      let tab_to_download = this.getTab(this.state.current_tab);\n      console.log(tab_to_download); // if it's a txt file\n\n      if (\"txt\" == filetype) {\n        if (tab_to_download.metadata.title !== '') {\n          var filename = tab_to_download.metadata.title + \".txt\";\n        } else {\n          var filename = \"tab\" + this.state.current_tab + \"_text.txt\";\n        }\n\n        var text = tab_to_download.content;\n        this.download(filename, text);\n      } // if it's a JSON file\n\n\n      if (\"json\" == filetype) {\n        var filename = this.state.fileName;\n        console.log(filename, 'filename');\n\n        if (filename.length == 0) {\n          filename = \"default\";\n        }\n\n        saveSADFace(filename, filetype);\n      }\n    } //if it's a load operation\n\n\n    if (\"load\" == operation) {\n      // if it's a txt file\n      if (\"txt\" == filetype) {\n        var files = document.getElementById(\"load\" + this.state.current_tab).files;\n        var file = files[0];\n        var filename = file.name;\n        var reader = new FileReader();\n\n        reader.onload = function (e) {\n          var content = reader.result; //  document.getElementById(this.state.current_tab).innerText = content;\n\n          update_resource(tab_id, content, filename);\n          this.updateTab(filename, content);\n        }.bind(this);\n\n        reader.readAsText(file);\n      } // if it's a JSON file\n\n\n      if (\"json\" == filetype) {\n        console.log('IMPORT JSON');\n        var files = document.getElementById(\"loadJSON\").files;\n        var file = files[0];\n        var reader = loadSADFace(file);\n\n        if (reader != null) {\n          reader.onload = function (e) {\n            var result = reader.result;\n            localStorage.setItem(\"state\", result);\n            this.loadJSON(result);\n            var json = JSON.parse(result);\n            this.setState({\n              remove_all_tabs: !this.state.remove_all_tabs\n            }, () => console.log(this.state.remove_all_tabs));\n          }.bind(this);\n        }\n      }\n    }\n  }\n\n  updateTab(title, content) {\n    const tabs = this.state.tabs.slice();\n    tabs.forEach(tab => {\n      if (tab.id === this.state.current_tab) {\n        if (title != '') {\n          tab.metadata.title = title;\n        }\n\n        if (content != '') {\n          tab.content = content;\n        }\n      }\n    });\n    this.setState({\n      tabs\n    });\n  }\n\n  getTab(id) {\n    let getTab = this.state.tabs.find(el => el.id == id);\n    return getTab;\n  }\n\n  loadJSON(json_value) {\n    let importJSON = import_json(json_value);\n    localStorage.setItem(\"state\", JSON.stringify(get_sd()));\n    this.setState({\n      current_sadface_doc: JSON.stringify(get_sd())\n    }, () => {\n      console.log(this.state.current_sadface_doc, 'current_sadface_doc set');\n    });\n    this.setState({\n      json: importJSON\n    }, () => {\n      console.log(this.state.json, 'json state set');\n      this.setState({\n        tabs: [],\n        last_number: 0,\n        current_tab: ''\n      }, () => {\n        console.log(this.state.tabs, 'empty tabs');\n        console.log(this.state.json.resources, 'resources');\n        this.loadTabs(this.state.json.resources);\n      });\n      this.setCyData(export_cytoscape(this.state.json));\n    });\n  }\n\n  setCyData(val) {\n    this.setState({\n      cy_data: val\n    }, () => console.log('cy_data set'));\n  }\n\n  download(filename, text) {\n    /*\n    Downloads a file given its filename and its text using utf-8 charset\n    */\n    console.log(\"Downloading \" + filename);\n    var outfile = document.createElement(\"a\");\n    outfile.setAttribute(\"href\", \"data:text/plain;charset=utf-8,\" + encodeURIComponent(text));\n    outfile.setAttribute(\"download\", filename);\n    outfile.style.display = \"none\";\n    document.body.appendChild(outfile);\n    outfile.click();\n    document.body.removeChild(outfile);\n  }\n\n  get_resource(resource_id) {\n    /*\n    Retrieve the resource dict identified by the supplied resource ID\n     Returns: An resource dict\n    */\n    if (resource_id) {\n      var resource;\n      const index = this.state.tabs.findIndex(tab => tab.tab_id === resource_id);\n      const tabs = [...this.state.tabs];\n      resource = tabs[index];\n      return resource;\n    }\n  }\n\n  isTab_id(tab) {\n    return tab.tab_id;\n  }\n\n  loadTabs(resources) {\n    console.log(resources.length, 'load tabs resources');\n\n    if (resources.length >= 1) {\n      this.setState(state => {\n        const tabs = this.state.tabs.concat(resources);\n        return {\n          tabs\n        };\n      }, () => {\n        console.log(this.state.tabs, 'added to array');\n        console.log(this.state.tabs[this.state.tabs.length - 1].id, 'tabs length');\n        this.setActiveTab(this.state.tabs[this.state.tabs.length - 1].id);\n      });\n    }\n  }\n\n  load_tab(resource) {\n    if (resource != null) {\n      console.log(resource, 'load_tab');\n      this.add_tab(resource);\n    }\n  }\n\n  update_resource(resource_id, content, title) {\n    /*\n    Given an ID for an existing resource, update the content and metadata of the resource.\n    Updates the resource in sd;\n    */\n    if (resource_id && (content || title)) {\n      console.log(\"update resource\");\n      var resource;\n      const index = this.state.tabs.findIndex(tab => tab.tab_id === resource_id);\n      const tabs = [...this.state.tabs];\n      resource = tabs[index];\n\n      if (resource !== null && resource !== undefined) {\n        if (content !== null && content !== undefined) {\n          resource.content = content;\n        }\n\n        if (title !== null && title !== undefined) {\n          resource.title = title;\n        }\n        /*  this.state.sd.resources.forEach((res) => {\n              if(res.id === resource_id) {\n                  res = resource;\n              }\n          });*/\n\n      } else {\n        throw \"Could not update the resource: \" + resource_id;\n      }\n\n      this.setState({\n        tabs\n      }, () => {\n        console.log(\"update tabs\");\n      });\n    }\n  } //Resource Pane Functions\n\n\n  change_title(tab_id, val) {\n    this.set_text_resource_title(tab_id, val);\n    this.updateTab(val, '');\n  }\n\n  set_text_resource_title(tab_id, title) {\n    console.log(\"set text resource title\" + tab_id + title);\n    this.update_resource(tab_id, null, title);\n    this.setState({\n      update_local_storage: !this.state.update_local_storage\n    });\n  }\n\n  change_content(tab_id, val) {\n    this.set_text_resource_content(tab_id, val);\n    this.updateTab('', val);\n    console.log(get_sd(), 'get sd');\n    console.log(this.state.tabs, 'tabs');\n  }\n\n  set_text_resource_content(tab_id, text) {\n    this.update_resource(tab_id, text, null);\n    this.setState({\n      update_local_storage: !this.state.update_local_storage\n    });\n  }\n\n  setSelectedText(text) {\n    this.setState({\n      selectedText: text\n    }, () => console.log(this.state.selectedText, 'selectedText set')); // this.setFocus();    \n  }\n\n  setFocus() {\n    this.setState({\n      focus: !this.state.focus\n    }, () => console.log(this.state.focus, 'focus set'));\n  }\n\n  clearSelection() {\n    if (window.getSelection) {\n      if (window.getSelection().empty) {\n        // Chrome\n        window.getSelection().empty();\n      }\n\n      if (window.getSelection().removeAllRanges) {\n        // Firefox\n        window.getSelection().removeAllRanges();\n      }\n    }\n\n    if (document.selection) {\n      // IE?\n      document.selection.empty();\n    }\n\n    this.setState({\n      selectedText: null\n    }, () => console.log(this.state.selectedText, 'selectedText Reset'));\n  } // Slide In Functions\n\n\n  toggleResourcePane() {\n    this.setState({\n      showResourcePane: !this.state.showResourcePane\n    });\n  }\n\n  clear_local_storage() {\n    localStorage.clear();\n    window.location.reload(false);\n  }\n\n  setFileName(file_name) {\n    console.log('filename APP');\n    this.setState({\n      fileName: file_name\n    }, () => console.log(this.state.fileName, 'filename app'));\n  }\n\n  load_demo_argument() {\n    var demo_sadface_doc = \"{\\\"analyst_email\\\":\\\"40170722@live.napier.ac.uk\\\",\\\"analyst_name\\\":\\\"Nathan Mair\\\",\\\"created\\\":\\\"2018-02-23T02:27:36\\\",\\\"edges\\\":[{\\\"id\\\":\\\"a1s1\\\",\\\"source_id\\\":\\\"a1\\\",\\\"target_id\\\":\\\"s1\\\"},{\\\"id\\\":\\\"a2s1\\\",\\\"source_id\\\":\\\"a2\\\",\\\"target_id\\\":\\\"s1\\\"},{\\\"id\\\":\\\"a3s2\\\",\\\"source_id\\\":\\\"a3\\\",\\\"target_id\\\":\\\"s2\\\"},{\\\"id\\\":\\\"s2a5\\\",\\\"source_id\\\":\\\"s2\\\",\\\"target_id\\\":\\\"a5\\\"},{\\\"id\\\":\\\"s1a4\\\",\\\"source_id\\\":\\\"s1\\\",\\\"target_id\\\":\\\"a4\\\"},{\\\"id\\\":\\\"a4s2\\\",\\\"source_id\\\":\\\"a4\\\",\\\"target_id\\\":\\\"s2\\\"}],\\\"edited\\\":\\\"2018-02-23T02:27:36\\\",\\\"id\\\":\\\"94a975db-25ae-4d25-93cc-1c07c932e2f9\\\",\\\"metadata\\\":{},\\\"nodes\\\":[{\\\"id\\\":\\\"a1\\\",\\\"metadata\\\":{},\\\"sources\\\":[],\\\"text\\\":\\\"Every person is going to die\\\",\\\"type\\\":\\\"atom\\\"},{\\\"id\\\":\\\"a2\\\",\\\"metadata\\\":{},\\\"sources\\\":[],\\\"text\\\":\\\"You are a person\\\",\\\"type\\\":\\\"atom\\\"},{\\\"id\\\":\\\"a3\\\",\\\"metadata\\\":{\\\"test\\\":\\\"test\\\"},\\\"sources\\\":[],\\\"text\\\":\\\"If you are going to die then you should treasure every moment\\\",\\\"type\\\":\\\"atom\\\"},{\\\"id\\\":\\\"a4\\\",\\\"metadata\\\":{},\\\"sources\\\":[],\\\"text\\\":\\\"You are going to die\\\",\\\"type\\\":\\\"atom\\\"},{\\\"id\\\":\\\"a5\\\",\\\"metadata\\\":{},\\\"sources\\\":[],\\\"text\\\":\\\"You should treasure every moment\\\",\\\"type\\\":\\\"atom\\\"},{\\\"id\\\":\\\"s1\\\",\\\"name\\\":\\\"Support\\\",\\\"type\\\":\\\"scheme\\\"},{\\\"id\\\":\\\"s2\\\",\\\"name\\\":\\\"Support\\\",\\\"type\\\":\\\"scheme\\\"}],\\\"resources\\\": []}\";\n    localStorage.setItem(\"state\", demo_sadface_doc);\n    this.setCyData(export_cytoscape(import_json(demo_sadface_doc))); //this.setState({cy_data: export_cytoscape(import_json(demo_sadface_doc))}, () =>\n    //    console.log(this.state.cy_data, 'cy_data'));\n  }\n\n  render() {\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 550\n      },\n      __self: this\n    }, React.createElement(Menu //functions\n    , {\n      toggleResourcePane: this.toggleResourcePane,\n      load_demo_argument: this.load_demo_argument,\n      setFileName: this.setFileName,\n      fileManager: this.fileManager //state\n      ,\n      png: this.state.png,\n      jpg: this.state.jpg,\n      fileName: this.state.fileName,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 554\n      },\n      __self: this\n    }), React.createElement(MainUI, {\n      toggleSlideIn: () => this.toggleButton(),\n      addTab: () => this.add_tab(),\n      tabs: this.state.tabs,\n      setType: this.setType,\n      remove_tab: this.remove_tab,\n      fileManager: this.fileManager,\n      showResourcePane: this.state.showResourcePane,\n      current_tab: this.state.current_tab,\n      setActiveTab: this.setActiveTab,\n      fileManager: this.fileManager,\n      change_title: this.change_title,\n      change_content: this.change_content,\n      loadTabs: this.loadTabs,\n      cy_data: this.state.cy_data,\n      setCyData: this.setCyData,\n      loadJSON: this.loadJSON,\n      handleSetPng: this.handleSetPng,\n      handleSetJpg: this.handleSetJpg,\n      remove_all_tabs: this.state.remove_all_tabs,\n      update_local_storage: this.state.update_local_storage,\n      set_focus: this.set_focus,\n      focused: this.state.focused,\n      selectedText: this.state.selectedText,\n      setSelectedText: this.setSelectedText,\n      clearSelection: this.clearSelection,\n      focus: this.state.focus,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 566\n      },\n      __self: this\n    }));\n  }\n\n}\n\nexport default App;","map":{"version":3,"sources":["/Users/gareth/Desktop/monkeypuzzle/src/App.js"],"names":["React","Component","Slideout","MainUI","Menu","update_resource","remove_resources_from_nodes","loadSADFace","saveSADFace","delete_resource","get_sd","import_json","add_resource","export_cytoscape","add_resource_metadata","App","constructor","props","state","tabs","last_number","tab_id","sd","showResourcePane","test","current_tab","cy_data","selected","jpg","png","fileName","json","current_sadface_doc","cy","remove_all_tabs","resourceType","update_local_storage","focused","selectedText","focus","toggleButton","bind","add_to_tabs_arr","download","loadJSON","loadTabs","get_resource","toggleResourcePane","setActiveTab","fileManager","setCyData","add_tab","remove_tab","change_title","change_content","set_text_resource_content","add_tab_to_tab_array","setType","load_tab","updateTab","getTab","setSelectedText","handleSetPng","handleSetJpg","load_demo_argument","setFileName","clearSelection","setState","concat","console","log","openAddBoardModal","boardAddModalShow","newTab","id","metadata","title","localStorage","setItem","JSON","stringify","type","index","value","resource_id","key","sate","resources","forEach","res","componentDidMount","slideout","document","getElementById","i","length","filter","item","j","newCurrent","toggle","operation","filetype","tab_to_download","filename","text","content","files","file","name","reader","FileReader","onload","e","result","readAsText","parse","slice","tab","find","el","json_value","importJSON","val","outfile","createElement","setAttribute","encodeURIComponent","style","display","body","appendChild","click","removeChild","resource","findIndex","isTab_id","undefined","set_text_resource_title","setFocus","window","getSelection","empty","removeAllRanges","selection","clear_local_storage","clear","location","reload","file_name","demo_sadface_doc","render","set_focus"],"mappings":";AAAA,OAAOA,KAAP,IAAeC,SAAf,QAA+B,OAA/B;AACA,OAAOC,QAAP,MAAqB,UAArB,C,CAEA;;AACA,OAAOC,MAAP,MAAmB,qBAAnB;AACA,OAAOC,IAAP,MAAiB,mBAAjB;AAEA,OAAO,wBAAP,C,CACA;AACA;AACA;;AACA,OAAO,sCAAP;AACA,OAAO,eAAP,C,CAGA;;AAEA,SAAQC,eAAR,EAAwBC,2BAAxB,EAAqDC,WAArD,EAAiEC,WAAjE,EAA8EC,eAA9E,EAA+FC,MAA/F,EAAsGC,WAAtG,EAAmHC,YAAnH,EAAiIC,gBAAjI,EAAkJC,qBAAlJ,QAA8K,eAA9K;;AAMA,MAAMC,GAAN,SAAkBd,SAAlB,CAA2B;AAC1Be,EAAAA,WAAW,CAACC,KAAD,EAAO;AACjB,UAAMA,KAAN;AACA,SAAKC,KAAL,GAAa;AACZC,MAAAA,IAAI,EAAE,EADM;AAEZC,MAAAA,WAAW,EAAE,CAFD;AAGZC,MAAAA,MAAM,EAAC,EAHK;AAIHC,MAAAA,EAAE,EAAEZ,MAAM,EAJP;AAKHa,MAAAA,gBAAgB,EAAE,IALf;AAMHC,MAAAA,IAAI,EAAC,EANF;AAOHC,MAAAA,WAAW,EAAE,CAPV;AAQHC,MAAAA,OAAO,EAAE,IARN;AASHC,MAAAA,QAAQ,EAAE,EATP;AAUHC,MAAAA,GAAG,EAAC,EAVD;AAWHC,MAAAA,GAAG,EAAE,EAXF;AAYHC,MAAAA,QAAQ,EAAC,EAZN;AAaHC,MAAAA,IAAI,EAAE,EAbH;AAcHC,MAAAA,mBAAmB,EAAC,EAdjB;AAeHC,MAAAA,EAAE,EAAC,IAfA;AAgBHC,MAAAA,eAAe,EAAE,KAhBd;AAiBHC,MAAAA,YAAY,EAAE,MAjBX;AAkBHC,MAAAA,oBAAoB,EAAE,KAlBnB;AAmBHC,MAAAA,OAAO,EAAE,IAnBN;AAoBHC,MAAAA,YAAY,EAAE,IApBX;AAqBHC,MAAAA,KAAK,EAAE;AArBJ,KAAb;AAyBM,SAAKC,YAAL,GAAoB,KAAKA,YAAL,CAAkBC,IAAlB,CAAuB,IAAvB,CAApB;AACA,SAAKC,eAAL,GAAsB,KAAKA,eAAL,CAAqBD,IAArB,CAA0B,IAA1B,CAAtB;AACA,SAAKE,QAAL,GAAgB,KAAKA,QAAL,CAAcF,IAAd,CAAmB,IAAnB,CAAhB;AACA,SAAKG,QAAL,GAAgB,KAAKA,QAAL,CAAcH,IAAd,CAAmB,IAAnB,CAAhB;AACA,SAAKI,QAAL,GAAe,KAAKA,QAAL,CAAcJ,IAAd,CAAmB,IAAnB,CAAf;AACA,SAAKK,YAAL,GAAmB,KAAKA,YAAL,CAAkBL,IAAlB,CAAuB,IAAvB,CAAnB;AACA,SAAKE,QAAL,GAAgB,KAAKA,QAAL,CAAcF,IAAd,CAAmB,IAAnB,CAAhB;AACA,SAAKM,kBAAL,GAAyB,KAAKA,kBAAL,CAAwBN,IAAxB,CAA6B,IAA7B,CAAzB;AACA,SAAK3B,qBAAL,GAA4B,KAAKA,qBAAL,CAA2B2B,IAA3B,CAAgC,IAAhC,CAA5B;AACA,SAAKO,YAAL,GAAoB,KAAKA,YAAL,CAAkBP,IAAlB,CAAuB,IAAvB,CAApB;AACA,SAAKE,QAAL,GAAgB,KAAKA,QAAL,CAAcF,IAAd,CAAmB,IAAnB,CAAhB;AACA,SAAKQ,WAAL,GAAmB,KAAKA,WAAL,CAAiBR,IAAjB,CAAsB,IAAtB,CAAnB;AACA,SAAKS,SAAL,GAAiB,KAAKA,SAAL,CAAeT,IAAf,CAAoB,IAApB,CAAjB,CAvCW,CAyCX;;AACA,SAAKU,OAAL,GAAe,KAAKA,OAAL,CAAaV,IAAb,CAAkB,IAAlB,CAAf;AACA,SAAKW,UAAL,GAAiB,KAAKA,UAAL,CAAgBX,IAAhB,CAAqB,IAArB,CAAjB;AACA,SAAKY,YAAL,GAAoB,KAAKA,YAAL,CAAkBZ,IAAlB,CAAuB,IAAvB,CAApB;AACA,SAAKa,cAAL,GAAqB,KAAKA,cAAL,CAAoBb,IAApB,CAAyB,IAAzB,CAArB;AACA,SAAKc,yBAAL,GAAiC,KAAKA,yBAAL,CAA+Bd,IAA/B,CAAoC,IAApC,CAAjC;AACA,SAAKe,oBAAL,GAA4B,KAAKA,oBAAL,CAA0Bf,IAA1B,CAA+B,IAA/B,CAA5B;AACA,SAAKgB,OAAL,GAAe,KAAKA,OAAL,CAAahB,IAAb,CAAkB,IAAlB,CAAf;AACA,SAAKiB,QAAL,GAAgB,KAAKA,QAAL,CAAcjB,IAAd,CAAmB,IAAnB,CAAhB;AACA,SAAKkB,SAAL,GAAiB,KAAKA,SAAL,CAAelB,IAAf,CAAoB,IAApB,CAAjB;AACA,SAAKmB,MAAL,GAAc,KAAKA,MAAL,CAAYnB,IAAZ,CAAiB,IAAjB,CAAd;AACA,SAAKoB,eAAL,GAAuB,KAAKA,eAAL,CAAqBpB,IAArB,CAA0B,IAA1B,CAAvB,CApDW,CAqDX;;AACA,SAAKqB,YAAL,GAAoB,KAAKA,YAAL,CAAkBrB,IAAlB,CAAuB,IAAvB,CAApB;AACA,SAAKsB,YAAL,GAAoB,KAAKA,YAAL,CAAkBtB,IAAlB,CAAuB,IAAvB,CAApB;AACA,SAAKuB,kBAAL,GAA0B,KAAKA,kBAAL,CAAwBvB,IAAxB,CAA6B,IAA7B,CAA1B;AACA,SAAKwB,WAAL,GAAmB,KAAKA,WAAL,CAAiBxB,IAAjB,CAAsB,IAAtB,CAAnB,CAzDW,CA0DX;;AACA,SAAKyB,cAAL,GAAsB,KAAKA,cAAL,CAAoBzB,IAApB,CAAyB,IAAzB,CAAtB;AAEH;;AAEDC,EAAAA,eAAe,CAACrB,MAAD,EAAQ;AACpB,SAAK8C,QAAL,CAAcjD,KAAK,IAAI;AACpB,YAAMC,IAAI,GAAGD,KAAK,CAACC,IAAN,CAAWiD,MAAX,CAAkB/C,MAAlB,CAAb;AACA,aAAO;AACJF,QAAAA;AADI,OAAP;AAEC,KAJJ,EAIM,YAAY;AACbkD,MAAAA,OAAO,CAACC,GAAR,CAAY,MAAZ;AACH,KAFI,CAEH7B,IAFG,CAEE,IAFF,CAJN;AAQH;;AACD8B,EAAAA,iBAAiB,GAAE;AAClB,SAAKJ,QAAL,CAAc;AAAEK,MAAAA,iBAAiB,EAAE;AAArB,KAAd,EAA2C,YAAY;AACpDH,MAAAA,OAAO,CAACC,GAAR,CAAY,KAAKpD,KAAL,CAAWsD,iBAAvB;AACH,KAFA;AAIH;;AAEGrB,EAAAA,OAAO,GAAE;AACL,QAAIsB,MAAM,GAAG,EAAb;AACAJ,IAAAA,OAAO,CAACC,GAAR,CAAY,eAAZ;AACAG,IAAAA,MAAM,GAAG7D,YAAY,CAAC,GAAD,CAArB;AACAyD,IAAAA,OAAO,CAACC,GAAR,CAAYG,MAAZ,EAAoB,QAApB;AACA3D,IAAAA,qBAAqB,CAAC2D,MAAM,CAACC,EAAR,EAAY,OAAZ,EAAqB,EAArB,CAArB;AAEAD,IAAAA,MAAM,CAACE,QAAP,GAAkB;AAACC,MAAAA,KAAK,EAAE;AAAR,KAAlB;AACAP,IAAAA,OAAO,CAACC,GAAR,CAAYG,MAAZ,EAAoB,sBAApB;AAGAI,IAAAA,YAAY,CAACC,OAAb,CAAqB,OAArB,EAA8BC,IAAI,CAACC,SAAL,CAAetE,MAAM,EAArB,CAA9B;AACA+D,IAAAA,MAAM,CAACQ,IAAP,GAAc,KAAK/D,KAAL,CAAWiB,YAAzB;AACA,SAAKqB,oBAAL,CAA0BiB,MAA1B;AACH;;AAEDjB,EAAAA,oBAAoB,CAACiB,MAAD,EAAQ;AACxB,SAAKN,QAAL,CAAcjD,KAAK,IAAI;AACnB,YAAMC,IAAI,GAAG,KAAKD,KAAL,CAAWC,IAAX,CAAgBiD,MAAhB,CAAuBK,MAAvB,CAAb;AACI,aAAO;AACHtD,QAAAA;AADG,OAAP;AAGH,KALL,EAKO,MAAM;AACDkD,MAAAA,OAAO,CAACC,GAAR,CAAY,KAAKpD,KAAL,CAAWC,IAAvB,EAA6B,gBAA7B;AACD,WAAK6B,YAAL,CAAkByB,MAAM,CAACC,EAAzB;AACF,KART;AAUH;;AAELjB,EAAAA,OAAO,CAACwB,IAAD,EAAM;AACT,SAAKd,QAAL,CAAc;AAAChC,MAAAA,YAAY,EAAE8C;AAAf,KAAd,EAAoC,MAChCZ,OAAO,CAACC,GAAR,CAAY,KAAKpD,KAAL,CAAWiB,YAAvB,EAAqC,UAArC,CADJ;AAEH;;AAKGX,EAAAA,IAAI,CAAC0D,KAAD,EAAQ;AACR,SAAKf,QAAL,CAAc;AACV1C,MAAAA,WAAW,EAAEyD;AADH,KAAd;AAGAb,IAAAA,OAAO,CAACC,GAAR,CAAY,KAAK7C,WAAjB;AACH;;AAEDuB,EAAAA,YAAY,CAACmC,KAAD,EAAO;AACf,SAAKhB,QAAL,CAAc;AACV1C,MAAAA,WAAW,EAAE0D;AADH,KAAd,EAEG,YAAW;AACVd,MAAAA,OAAO,CAACC,GAAR,CAAY,KAAKpD,KAAL,CAAWO,WAAvB,EAAoC,QAApC;AACH,KAJD;AAQH;;AAEDX,EAAAA,qBAAqB,CAACsE,WAAD,EAAcC,GAAd,EAAmBF,KAAnB,EAA0B;AAC/C;;;;AAIA,QAAIC,WAAW,IAAIC,GAAf,IAAsBF,KAA1B,EAAiC;AAC7B,WAAKG,IAAL,CAAUhE,EAAV,CAAaiE,SAAb,CAAuBC,OAAvB,CAA+B,UAASC,GAAT,EAAc;AACzC,YAAGA,GAAG,CAACf,EAAJ,KAAWU,WAAd,EAA2B;AACvBK,UAAAA,GAAG,CAACd,QAAJ,CAAaU,GAAb,IAAoBF,KAApB;AACH;AACJ,OAJD;AAKH;AACJ,GApJ0B,CAsJ3B;;;AACArB,EAAAA,YAAY,CAACjC,GAAD,EAAK;AACb,SAAKsC,QAAL,CAAc;AAACtC,MAAAA,GAAG,EAAEA;AAAN,KAAd,EAA0B,MACtBwC,OAAO,CAACC,GAAR,CAAY,SAAZ,CADJ;AAEH;;AAEDP,EAAAA,YAAY,CAACnC,GAAD,EAAK;AACb,SAAKuC,QAAL,CAAc;AAACvC,MAAAA,GAAG,EAAEA;AAAN,KAAd,EAA0B,MACtByC,OAAO,CAACC,GAAR,CAAY,SAAZ,CADJ;AAEH;;AAEDoB,EAAAA,iBAAiB,GAAG;AACnB,SAAKC,QAAL,GAAgB,IAAIzF,QAAJ,CAAa;AAC1B,eAAS0F,QAAQ,CAACC,cAAT,CAAwB,OAAxB,CADiB;AAE1B,cAAQD,QAAQ,CAACC,cAAT,CAAwB,MAAxB,CAFkB;AAG1B,YAAM,MAHoB;AAI1B,cAAQ,OAJkB;AAK1B,kBAAY,GALc;AAM1B,iBAAW,GANe;AAO1B,mBAAa;AAPa,KAAb,CAAhB;AAUA;;AAEDzC,EAAAA,UAAU,CAAC0C,CAAD,EAAG;AACTrF,IAAAA,eAAe,CAAC,KAAKS,KAAL,CAAWO,WAAZ,CAAf;AACAnB,IAAAA,2BAA2B,CAAC,KAAKY,KAAL,CAAWO,WAAZ,CAA3B;AAEAoD,IAAAA,YAAY,CAACC,OAAb,CAAqB,OAArB,EAA6BC,IAAI,CAACC,SAAL,CAAetE,MAAM,EAArB,CAA7B;;AAEA,QAAI,KAAKQ,KAAL,CAAWC,IAAX,CAAgB4E,MAAhB,IAA0B,CAA1B,IAA+BD,CAAC,IAAI,CAAC,CAAzC,EAA2C;AAEvC,WAAK3B,QAAL,CAAcjD,KAAK,IAAG;AACtB,cAAMC,IAAI,GAAGD,KAAK,CAACC,IAAN,CAAW6E,MAAX,CAAkB,CAACC,IAAD,EAAOC,CAAP,KAAaJ,CAAC,KAAII,CAApC,CAAb;AACA,eAAO;AACH/E,UAAAA;AADG,SAAP;AAGH,OALG,EAKD,MAAM;AACLkD,QAAAA,OAAO,CAACC,GAAR,CAAY,KAAKpD,KAAL,CAAWC,IAAX,CAAgB4E,MAA5B,EAAoC,cAApC;AACA,YAAII,UAAU,GAAG,KAAKjF,KAAL,CAAWC,IAAX,CAAgB,KAAKD,KAAL,CAAWC,IAAX,CAAgB4E,MAAhB,GAAuB,CAAvC,EAA0CrB,EAA3D;AACAL,QAAAA,OAAO,CAACC,GAAR,CAAY6B,UAAZ,EAAwB,YAAxB;AACA9B,QAAAA,OAAO,CAACC,GAAR,CAAY,KAAKpD,KAAL,CAAWC,IAAvB,EAA6B,MAA7B;AACA,aAAKgD,QAAL,CAAc;AAAC1C,UAAAA,WAAW,EAAE0E;AAAd,SAAd,EAAyC,MACrC9B,OAAO,CAACC,GAAR,CAAY,KAAKpD,KAAL,CAAWO,WAAvB,EAAoC,cAApC,CADJ;AAIH,OAdG;AAiBH;AAEJ;;AAEDS,EAAAA,eAAe,GAAE;AACb,SAAKiC,QAAL,CAAc;AAAChD,MAAAA,IAAI,EAAE,EAAP;AAAWC,MAAAA,WAAW,EAAC;AAAvB,KAAd,EAAyC,MAAK;AAC1CiD,MAAAA,OAAO,CAACC,GAAR,CAAY,KAAKpD,KAAL,CAAWC,IAAvB,EAA4B,iBAA5B;AACC,KAFL;AAGH;;AAKDqB,EAAAA,YAAY,GAAE;AACV,SAAKmD,QAAL,CAAcS,MAAd;AACH;;AAMDnD,EAAAA,WAAW,CAACoD,SAAD,EAAYC,QAAZ,EAAsBjF,MAAtB,EAA8B;AACrC;;;AAIAgD,IAAAA,OAAO,CAACC,GAAR,CAAY+B,SAAZ,EAAuBC,QAAvB,EAAiCjF,MAAjC;;AACA,QAAI,UAAUgF,SAAd,EAA4B;AACxB,UAAIE,eAAe,GAAG,KAAK3C,MAAL,CAAY,KAAK1C,KAAL,CAAWO,WAAvB,CAAtB;AACA4C,MAAAA,OAAO,CAACC,GAAR,CAAYiC,eAAZ,EAFwB,CAGxB;;AACA,UAAI,SAASD,QAAb,EAAuB;AAEnB,YAAIC,eAAe,CAAC5B,QAAhB,CAAyBC,KAAzB,KAAmC,EAAvC,EAA2C;AACvC,cAAI4B,QAAQ,GAAGD,eAAe,CAAC5B,QAAhB,CAAyBC,KAAzB,GAA+B,MAA9C;AACH,SAFD,MAEO;AACH,cAAI4B,QAAQ,GAAG,QAAM,KAAKtF,KAAL,CAAWO,WAAjB,GAA6B,WAA5C;AACH;;AACD,YAAIgF,IAAI,GAAGF,eAAe,CAACG,OAA3B;AACA,aAAK/D,QAAL,CAAc6D,QAAd,EAAuBC,IAAvB;AACH,OAbuB,CAexB;;;AACA,UAAI,UAAUH,QAAd,EAAwB;AACrB,YAAIE,QAAQ,GAAG,KAAKtF,KAAL,CAAWY,QAA1B;AACAuC,QAAAA,OAAO,CAACC,GAAR,CAAYkC,QAAZ,EAAsB,UAAtB;;AACC,YAAGA,QAAQ,CAACT,MAAT,IAAmB,CAAtB,EAAwB;AAAES,UAAAA,QAAQ,GAAG,SAAX;AAAqB;;AAC5ChG,QAAAA,WAAW,CAACgG,QAAD,EAAWF,QAAX,CAAX;AACN;AACJ,KA5BoC,CA8BrC;;;AACA,QAAI,UAAUD,SAAd,EAAyB;AACrB;AACA,UAAI,SAASC,QAAb,EAAuB;AAGnB,YAAIK,KAAK,GAAGf,QAAQ,CAACC,cAAT,CAAwB,SAAO,KAAK3E,KAAL,CAAWO,WAA1C,EAAuDkF,KAAnE;AACA,YAAIC,IAAI,GAAGD,KAAK,CAAC,CAAD,CAAhB;AACA,YAAIH,QAAQ,GAAGI,IAAI,CAACC,IAApB;AACA,YAAIC,MAAM,GAAG,IAAIC,UAAJ,EAAb;;AACAD,QAAAA,MAAM,CAACE,MAAP,GAAgB,UAASC,CAAT,EAAY;AACxB,cAAIP,OAAO,GAAGI,MAAM,CAACI,MAArB,CADwB,CAE1B;;AACE7G,UAAAA,eAAe,CAACgB,MAAD,EAASqF,OAAT,EAAkBF,QAAlB,CAAf;AACA,eAAK7C,SAAL,CAAe6C,QAAf,EAAyBE,OAAzB;AACH,SALe,CAKdjE,IALc,CAKT,IALS,CAAhB;;AAMAqE,QAAAA,MAAM,CAACK,UAAP,CAAkBP,IAAlB;AACH,OAhBoB,CAiBrB;;;AACA,UAAI,UAAUN,QAAd,EAAwB;AACpBjC,QAAAA,OAAO,CAACC,GAAR,CAAY,aAAZ;AACA,YAAIqC,KAAK,GAAGf,QAAQ,CAACC,cAAT,CAAwB,UAAxB,EAAoCc,KAAhD;AACA,YAAIC,IAAI,GAAGD,KAAK,CAAC,CAAD,CAAhB;AACA,YAAIG,MAAM,GAAGvG,WAAW,CAACqG,IAAD,CAAxB;;AACA,YAAIE,MAAM,IAAI,IAAd,EAAmB;AACnBA,UAAAA,MAAM,CAACE,MAAP,GAAgB,UAASC,CAAT,EAAY;AACxB,gBAAIC,MAAM,GAAGJ,MAAM,CAACI,MAApB;AACArC,YAAAA,YAAY,CAACC,OAAb,CAAqB,OAArB,EAA6BoC,MAA7B;AACA,iBAAKtE,QAAL,CAAcsE,MAAd;AACA,gBAAInF,IAAI,GAAGgD,IAAI,CAACqC,KAAL,CAAWF,MAAX,CAAX;AACA,iBAAK/C,QAAL,CAAc;AAACjC,cAAAA,eAAe,EAAE,CAAC,KAAKhB,KAAL,CAAWgB;AAA9B,aAAd,EAA8D,MAC1DmC,OAAO,CAACC,GAAR,CAAY,KAAKpD,KAAL,CAAWgB,eAAvB,CADJ;AAEH,WAPe,CAOdO,IAPc,CAOT,IAPS,CAAhB;AAQH;AACA;AACJ;AACJ;;AAEDkB,EAAAA,SAAS,CAACiB,KAAD,EAAQ8B,OAAR,EAAgB;AACrB,UAAMvF,IAAI,GAAG,KAAKD,KAAL,CAAWC,IAAX,CAAgBkG,KAAhB,EAAb;AAEAlG,IAAAA,IAAI,CAACqE,OAAL,CAAc8B,GAAD,IAAQ;AACjB,UAAGA,GAAG,CAAC5C,EAAJ,KAAW,KAAKxD,KAAL,CAAWO,WAAzB,EAAsC;AAClC,YAAGmD,KAAK,IAAI,EAAZ,EAAe;AACX0C,UAAAA,GAAG,CAAC3C,QAAJ,CAAaC,KAAb,GAAqBA,KAArB;AACH;;AACD,YAAG8B,OAAO,IAAI,EAAd,EAAiB;AACjBY,UAAAA,GAAG,CAACZ,OAAJ,GAAcA,OAAd;AACH;AACA;AACJ,KATD;AAUA,SAAKvC,QAAL,CAAc;AAAChD,MAAAA;AAAD,KAAd;AAEH;;AAEDyC,EAAAA,MAAM,CAACc,EAAD,EAAI;AACN,QAAId,MAAM,GAAG,KAAK1C,KAAL,CAAWC,IAAX,CAAgBoG,IAAhB,CAAqBC,EAAE,IAAIA,EAAE,CAAC9C,EAAH,IAASA,EAApC,CAAb;AACA,WAAOd,MAAP;AAEH;;AAEDhB,EAAAA,QAAQ,CAAC6E,UAAD,EAAa;AACjB,QAAIC,UAAU,GAAG/G,WAAW,CAAC8G,UAAD,CAA5B;AACA5C,IAAAA,YAAY,CAACC,OAAb,CAAqB,OAArB,EAA6BC,IAAI,CAACC,SAAL,CAAetE,MAAM,EAArB,CAA7B;AACA,SAAKyD,QAAL,CAAc;AAACnC,MAAAA,mBAAmB,EAAE+C,IAAI,CAACC,SAAL,CAAetE,MAAM,EAArB;AAAtB,KAAd,EAA+D,MAAK;AAChE2D,MAAAA,OAAO,CAACC,GAAR,CAAY,KAAKpD,KAAL,CAAWc,mBAAvB,EAA4C,yBAA5C;AACH,KAFD;AAIA,SAAKmC,QAAL,CAAc;AAACpC,MAAAA,IAAI,EAAE2F;AAAP,KAAd,EAAkC,MAAM;AACpCrD,MAAAA,OAAO,CAACC,GAAR,CAAY,KAAKpD,KAAL,CAAWa,IAAvB,EAA6B,gBAA7B;AACA,WAAKoC,QAAL,CAAc;AAAChD,QAAAA,IAAI,EAAE,EAAP;AAAWC,QAAAA,WAAW,EAAC,CAAvB;AAA0BK,QAAAA,WAAW,EAAE;AAAvC,OAAd,EAA0D,MAAK;AAC3D4C,QAAAA,OAAO,CAACC,GAAR,CAAY,KAAKpD,KAAL,CAAWC,IAAvB,EAA6B,YAA7B;AACAkD,QAAAA,OAAO,CAACC,GAAR,CAAY,KAAKpD,KAAL,CAAWa,IAAX,CAAgBwD,SAA5B,EAAsC,WAAtC;AACA,aAAK1C,QAAL,CAAc,KAAK3B,KAAL,CAAWa,IAAX,CAAgBwD,SAA9B;AAEH,OALD;AAMA,WAAKrC,SAAL,CAAerC,gBAAgB,CAAC,KAAKK,KAAL,CAAWa,IAAZ,CAA/B;AACH,KATD;AAUH;;AAIDmB,EAAAA,SAAS,CAACyE,GAAD,EAAK;AACV,SAAKxD,QAAL,CAAc;AAACzC,MAAAA,OAAO,EAAEiG;AAAV,KAAd,EAA6B,MACzBtD,OAAO,CAACC,GAAR,CAAY,aAAZ,CADJ;AAEH;;AAGD3B,EAAAA,QAAQ,CAAC6D,QAAD,EAAWC,IAAX,EAAiB;AACrB;;;AAGApC,IAAAA,OAAO,CAACC,GAAR,CAAY,iBAAekC,QAA3B;AACA,QAAIoB,OAAO,GAAGhC,QAAQ,CAACiC,aAAT,CAAuB,GAAvB,CAAd;AACAD,IAAAA,OAAO,CAACE,YAAR,CAAqB,MAArB,EAA6B,mCAAmCC,kBAAkB,CAACtB,IAAD,CAAlF;AACAmB,IAAAA,OAAO,CAACE,YAAR,CAAqB,UAArB,EAAiCtB,QAAjC;AAEAoB,IAAAA,OAAO,CAACI,KAAR,CAAcC,OAAd,GAAwB,MAAxB;AACArC,IAAAA,QAAQ,CAACsC,IAAT,CAAcC,WAAd,CAA0BP,OAA1B;AAEAA,IAAAA,OAAO,CAACQ,KAAR;AAEAxC,IAAAA,QAAQ,CAACsC,IAAT,CAAcG,WAAd,CAA0BT,OAA1B;AACH;;AAGD9E,EAAAA,YAAY,CAACsC,WAAD,EAAa;AACrB;;;;AAKA,QAAGA,WAAH,EAAe;AACX,UAAIkD,QAAJ;AACA,YAAMpD,KAAK,GAAG,KAAKhE,KAAL,CAAWC,IAAX,CAAgBoH,SAAhB,CAA2BjB,GAAD,IAASA,GAAG,CAACjG,MAAJ,KAAe+D,WAAlD,CAAd;AACA,YAAMjE,IAAI,GAAG,CAAC,GAAG,KAAKD,KAAL,CAAWC,IAAf,CAAb;AACAmH,MAAAA,QAAQ,GAAGnH,IAAI,CAAC+D,KAAD,CAAf;AACA,aAAOoD,QAAP;AACH;AACJ;;AAEDE,EAAAA,QAAQ,CAAClB,GAAD,EAAK;AACT,WAAOA,GAAG,CAACjG,MAAX;AACH;;AAQDwB,EAAAA,QAAQ,CAAC0C,SAAD,EAAW;AACflB,IAAAA,OAAO,CAACC,GAAR,CAAYiB,SAAS,CAACQ,MAAtB,EAA8B,qBAA9B;;AACA,QAAGR,SAAS,CAACQ,MAAV,IAAoB,CAAvB,EAAyB;AACzB,WAAK5B,QAAL,CAAcjD,KAAK,IAAI;AACf,cAAMC,IAAI,GAAG,KAAKD,KAAL,CAAWC,IAAX,CAAgBiD,MAAhB,CAAuBmB,SAAvB,CAAb;AACI,eAAO;AACHpE,UAAAA;AADG,SAAP;AAGH,OALT,EAKW,MAAM;AACDkD,QAAAA,OAAO,CAACC,GAAR,CAAY,KAAKpD,KAAL,CAAWC,IAAvB,EAA6B,gBAA7B;AACAkD,QAAAA,OAAO,CAACC,GAAR,CAAY,KAAKpD,KAAL,CAAWC,IAAX,CAAgB,KAAKD,KAAL,CAAWC,IAAX,CAAgB4E,MAAhB,GAAyB,CAAzC,EAA4CrB,EAAxD,EAA4D,aAA5D;AACF,aAAK1B,YAAL,CAAkB,KAAK9B,KAAL,CAAWC,IAAX,CAAgB,KAAKD,KAAL,CAAWC,IAAX,CAAgB4E,MAAhB,GAAyB,CAAzC,EAA4CrB,EAA9D;AACD,OATb;AAYA;AACF;;AAGFhB,EAAAA,QAAQ,CAAC4E,QAAD,EAAW;AACf,QAAIA,QAAQ,IAAI,IAAhB,EAAsB;AAClBjE,MAAAA,OAAO,CAACC,GAAR,CAAYgE,QAAZ,EAAsB,UAAtB;AACA,WAAKnF,OAAL,CAAamF,QAAb;AAEH;AACJ;;AAEDjI,EAAAA,eAAe,CAAC+E,WAAD,EAAcsB,OAAd,EAAuB9B,KAAvB,EAA8B;AACzC;;;;AAMA,QAAIQ,WAAW,KAAKsB,OAAO,IAAI9B,KAAhB,CAAf,EAAuC;AACnCP,MAAAA,OAAO,CAACC,GAAR,CAAY,iBAAZ;AAEA,UAAIgE,QAAJ;AACA,YAAMpD,KAAK,GAAG,KAAKhE,KAAL,CAAWC,IAAX,CAAgBoH,SAAhB,CAA2BjB,GAAD,IAASA,GAAG,CAACjG,MAAJ,KAAe+D,WAAlD,CAAd;AACA,YAAMjE,IAAI,GAAG,CAAC,GAAG,KAAKD,KAAL,CAAWC,IAAf,CAAb;AACAmH,MAAAA,QAAQ,GAAGnH,IAAI,CAAC+D,KAAD,CAAf;;AAEA,UAAIoD,QAAQ,KAAK,IAAb,IAAqBA,QAAQ,KAAKG,SAAtC,EAAiD;AAC7C,YAAI/B,OAAO,KAAK,IAAZ,IAAoBA,OAAO,KAAK+B,SAApC,EAA+C;AAC3CH,UAAAA,QAAQ,CAAC5B,OAAT,GAAmBA,OAAnB;AACH;;AACD,YAAI9B,KAAK,KAAK,IAAV,IAAkBA,KAAK,KAAK6D,SAAhC,EAA2C;AACvCH,UAAAA,QAAQ,CAAC1D,KAAT,GAAiBA,KAAjB;AACH;AACH;;;;;;AAKD,OAZD,MAYO;AACH,cAAO,oCAAkCQ,WAAzC;AACH;;AACD,WAAKjB,QAAL,CAAc;AAAChD,QAAAA;AAAD,OAAd,EAAsB,MAAK;AACvBkD,QAAAA,OAAO,CAACC,GAAR,CAAY,aAAZ;AACH,OAFD;AAGH;AACJ,GA1b0B,CA4b3B;;;AACAjB,EAAAA,YAAY,CAAChC,MAAD,EAASsG,GAAT,EAAc;AACtB,SAAKe,uBAAL,CAA6BrH,MAA7B,EAAqCsG,GAArC;AACA,SAAKhE,SAAL,CAAegE,GAAf,EAAoB,EAApB;AACH;;AAEDe,EAAAA,uBAAuB,CAACrH,MAAD,EAASuD,KAAT,EAAe;AAClCP,IAAAA,OAAO,CAACC,GAAR,CAAY,4BAA2BjD,MAA3B,GAAoCuD,KAAhD;AACA,SAAKvE,eAAL,CAAqBgB,MAArB,EAA6B,IAA7B,EAAmCuD,KAAnC;AACA,SAAKT,QAAL,CAAc;AAAC/B,MAAAA,oBAAoB,EAAE,CAAC,KAAKlB,KAAL,CAAWkB;AAAnC,KAAd;AACC;;AAELkB,EAAAA,cAAc,CAACjC,MAAD,EAASsG,GAAT,EAAa;AACvB,SAAKpE,yBAAL,CAA+BlC,MAA/B,EAAuCsG,GAAvC;AACI,SAAKhE,SAAL,CAAe,EAAf,EAAmBgE,GAAnB;AACAtD,IAAAA,OAAO,CAACC,GAAR,CAAY5D,MAAM,EAAlB,EAAsB,QAAtB;AACA2D,IAAAA,OAAO,CAACC,GAAR,CAAY,KAAKpD,KAAL,CAAWC,IAAvB,EAA6B,MAA7B;AAEP;;AAEDoC,EAAAA,yBAAyB,CAAClC,MAAD,EAASoF,IAAT,EAAc;AACnC,SAAKpG,eAAL,CAAqBgB,MAArB,EAA6BoF,IAA7B,EAAmC,IAAnC;AACA,SAAKtC,QAAL,CAAc;AAAC/B,MAAAA,oBAAoB,EAAE,CAAC,KAAKlB,KAAL,CAAWkB;AAAnC,KAAd;AACH;;AAEDyB,EAAAA,eAAe,CAAC4C,IAAD,EAAM;AACjB,SAAKtC,QAAL,CAAc;AAAC7B,MAAAA,YAAY,EAAEmE;AAAf,KAAd,EAAoC,MAChCpC,OAAO,CAACC,GAAR,CAAY,KAAKpD,KAAL,CAAWoB,YAAvB,EAAqC,kBAArC,CADJ,EADiB,CAGd;AACN;;AAEDqG,EAAAA,QAAQ,GAAE;AACN,SAAKxE,QAAL,CAAc;AAAC5B,MAAAA,KAAK,EAAE,CAAC,KAAKrB,KAAL,CAAWqB;AAApB,KAAd,EAA0C,MACtC8B,OAAO,CAACC,GAAR,CAAY,KAAKpD,KAAL,CAAWqB,KAAvB,EAA8B,WAA9B,CADJ;AAEH;;AAED2B,EAAAA,cAAc,GAAG;AACb,QAAI0E,MAAM,CAACC,YAAX,EAAyB;AACrB,UAAID,MAAM,CAACC,YAAP,GAAsBC,KAA1B,EAAiC;AAAG;AAChCF,QAAAA,MAAM,CAACC,YAAP,GAAsBC,KAAtB;AACH;;AACD,UAAIF,MAAM,CAACC,YAAP,GAAsBE,eAA1B,EAA2C;AAAG;AAC1CH,QAAAA,MAAM,CAACC,YAAP,GAAsBE,eAAtB;AACH;AACJ;;AACD,QAAInD,QAAQ,CAACoD,SAAb,EAAwB;AAAG;AACvBpD,MAAAA,QAAQ,CAACoD,SAAT,CAAmBF,KAAnB;AACH;;AACD,SAAK3E,QAAL,CAAc;AAAC7B,MAAAA,YAAY,EAAE;AAAf,KAAd,EAAoC,MAChC+B,OAAO,CAACC,GAAR,CAAY,KAAKpD,KAAL,CAAWoB,YAAvB,EAAqC,oBAArC,CADJ;AAEH,GA9e0B,CAgf3B;;;AACAS,EAAAA,kBAAkB,GAAE;AAChB,SAAKoB,QAAL,CAAc;AAAC5C,MAAAA,gBAAgB,EAAE,CAAC,KAAKL,KAAL,CAAWK;AAA/B,KAAd;AACH;;AAGD0H,EAAAA,mBAAmB,GAAG;AAClBpE,IAAAA,YAAY,CAACqE,KAAb;AACAN,IAAAA,MAAM,CAACO,QAAP,CAAgBC,MAAhB,CAAuB,KAAvB;AACH;;AAEAnF,EAAAA,WAAW,CAACoF,SAAD,EAAW;AACnBhF,IAAAA,OAAO,CAACC,GAAR,CAAY,cAAZ;AACA,SAAKH,QAAL,CAAc;AAACrC,MAAAA,QAAQ,EAAEuH;AAAX,KAAd,EAAqC,MACnChF,OAAO,CAACC,GAAR,CAAY,KAAKpD,KAAL,CAAWY,QAAvB,EAAiC,cAAjC,CADF;AAED;;AAEHkC,EAAAA,kBAAkB,GAAE;AACjB,QAAIsF,gBAAgB,GAAG,yxCAAvB;AAECzE,IAAAA,YAAY,CAACC,OAAb,CAAqB,OAArB,EAA6BwE,gBAA7B;AACA,SAAKpG,SAAL,CAAerC,gBAAgB,CAACF,WAAW,CAAC2I,gBAAD,CAAZ,CAA/B,EAJgB,CAKhB;AACA;AACH;;AAGDC,EAAAA,MAAM,GAAE;AAEJ,WACC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAIA,oBAAC,IAAD,CACG;AADH;AAEG,MAAA,kBAAkB,EAAE,KAAKxG,kBAF5B;AAGG,MAAA,kBAAkB,EAAE,KAAKiB,kBAH5B;AAIG,MAAA,WAAW,EAAE,KAAKC,WAJrB;AAKG,MAAA,WAAW,EAAE,KAAKhB,WALrB,CAMG;AANH;AAOG,MAAA,GAAG,EAAE,KAAK/B,KAAL,CAAWW,GAPnB;AAQG,MAAA,GAAG,EAAE,KAAKX,KAAL,CAAWU,GARnB;AASG,MAAA,QAAQ,EAAI,KAAKV,KAAL,CAAWY,QAT1B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAJA,EAgBG,oBAAC,MAAD;AACA,MAAA,aAAa,EAAE,MAAM,KAAKU,YAAL,EADrB;AAEA,MAAA,MAAM,EAAI,MAAM,KAAKW,OAAL,EAFhB;AAGA,MAAA,IAAI,EAAI,KAAKjC,KAAL,CAAWC,IAHnB;AAIA,MAAA,OAAO,EAAE,KAAKsC,OAJd;AAKA,MAAA,UAAU,EAAE,KAAKL,UALjB;AAMA,MAAA,WAAW,EAAE,KAAKH,WANlB;AAOA,MAAA,gBAAgB,EAAE,KAAK/B,KAAL,CAAWK,gBAP7B;AAQA,MAAA,WAAW,EAAE,KAAKL,KAAL,CAAWO,WARxB;AASA,MAAA,YAAY,EAAE,KAAKuB,YATnB;AAUA,MAAA,WAAW,EAAE,KAAKC,WAVlB;AAWA,MAAA,YAAY,EAAE,KAAKI,YAXnB;AAYA,MAAA,cAAc,EAAE,KAAKC,cAZrB;AAaA,MAAA,QAAQ,EAAG,KAAKT,QAbhB;AAcA,MAAA,OAAO,EAAG,KAAK3B,KAAL,CAAWQ,OAdrB;AAeA,MAAA,SAAS,EAAI,KAAKwB,SAflB;AAgBA,MAAA,QAAQ,EAAI,KAAKN,QAhBjB;AAkBA,MAAA,YAAY,EAAE,KAAKkB,YAlBnB;AAmBA,MAAA,YAAY,EAAE,KAAKC,YAnBnB;AAqBA,MAAA,eAAe,EAAE,KAAK7C,KAAL,CAAWgB,eArB5B;AAuBA,MAAA,oBAAoB,EAAE,KAAKhB,KAAL,CAAWkB,oBAvBjC;AAwBA,MAAA,SAAS,EAAE,KAAKoH,SAxBhB;AAyBA,MAAA,OAAO,EAAG,KAAKtI,KAAL,CAAWmB,OAzBrB;AA0BA,MAAA,YAAY,EAAE,KAAKnB,KAAL,CAAWoB,YA1BzB;AA2BA,MAAA,eAAe,EAAE,KAAKuB,eA3BtB;AA4BA,MAAA,cAAc,EAAE,KAAKK,cA5BrB;AA6BA,MAAA,KAAK,EAAE,KAAKhD,KAAL,CAAWqB,KA7BlB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAhBH,CADD;AAyDH;;AAtkB0B;;AA8lB3B,eAAexB,GAAf","sourcesContent":["import React, {Component} from 'react';\nimport Slideout from 'slideout';\n\n//import Components\nimport MainUI from './Components/MainUI';\nimport Menu from './Components/Menu';\n\nimport './CSS/monkeypuzzle.css';\n//import './CSS/font-awesome.min.css';\n//import './CSS/jquery.qtip.min.css';\n//import './CSS/bootstrap.min.css';\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport './CSS/App.css';\n\n\n//import fuctions from SADFACE\n\nimport {update_resource,remove_resources_from_nodes, loadSADFace,saveSADFace, delete_resource, get_sd,import_json, add_resource, export_cytoscape,add_resource_metadata} from './lib/Sadface'; \n\n\n\n\n\nclass App extends Component{\n\tconstructor(props){\n\t\tsuper(props);\n\t\tthis.state = {\n\t\t\ttabs: [],\n\t\t\tlast_number: 0,\n\t\t\ttab_id:\"\",\n            sd: get_sd(),\n            showResourcePane: true,\n            test:{},\n            current_tab: 0,\n            cy_data: null,\n            selected: '',\n            jpg:'',\n            png: '',\n            fileName:'',\n            json: '',\n            current_sadface_doc:'',\n            cy:null,\n            remove_all_tabs: false,\n            resourceType: 'text',\n            update_local_storage: false,\n            focused: null,\n            selectedText: null,\n            focus: false,\n        };\n\n\n        this.toggleButton = this.toggleButton.bind(this);\n        this.add_to_tabs_arr =this.add_to_tabs_arr.bind(this);\n        this.download = this.download.bind(this);\n        this.loadJSON = this.loadJSON.bind(this);\n        this.loadTabs =this.loadTabs.bind(this);\n        this.get_resource =this.get_resource.bind(this);\n        this.download = this.download.bind(this);\n        this.toggleResourcePane =this.toggleResourcePane.bind(this);\n        this.add_resource_metadata =this.add_resource_metadata.bind(this);\n        this.setActiveTab = this.setActiveTab.bind(this);\n        this.download = this.download.bind(this);\n        this.fileManager = this.fileManager.bind(this);\n        this.setCyData = this.setCyData.bind(this);\n\n        //ResourcePane Functions\n        this.add_tab = this.add_tab.bind(this);\n        this.remove_tab =this.remove_tab.bind(this);\n        this.change_title = this.change_title.bind(this);\n        this.change_content =this.change_content.bind(this);\n        this.set_text_resource_content = this.set_text_resource_content.bind(this);\n        this.add_tab_to_tab_array = this.add_tab_to_tab_array.bind(this);\n        this.setType = this.setType.bind(this);\n        this.load_tab = this.load_tab.bind(this);\n        this.updateTab = this.updateTab.bind(this);\n        this.getTab = this.getTab.bind(this);\n        this.setSelectedText = this.setSelectedText.bind(this);\n        //Menu\n        this.handleSetPng = this.handleSetPng.bind(this);\n        this.handleSetJpg = this.handleSetJpg.bind(this);\n        this.load_demo_argument = this.load_demo_argument.bind(this);\n        this.setFileName = this.setFileName.bind(this);\n        //Cytoscape\n        this.clearSelection = this.clearSelection.bind(this);\n\n    }\n\n    add_to_tabs_arr(tab_id){\n       this.setState(state => {\n          const tabs = state.tabs.concat(tab_id);\n          return {\n             tabs,\n         }}, function () {\n            console.log(\"tabs\");\n        }.bind(this));\n\n   }\n   openAddBoardModal(){\n    this.setState({ boardAddModalShow: true }, function () {\n       console.log(this.state.boardAddModalShow);\n   });\n\n}\n\n    add_tab(){\n        let newTab = {}\n        console.log('load tab null')\n        newTab = add_resource(' ');\n        console.log(newTab, 'newTab');\n        add_resource_metadata(newTab.id, 'title', '');\n\n        newTab.metadata = {title: ''}\n        console.log(newTab, 'newTab with metadata')\n\n\n        localStorage.setItem(\"state\", JSON.stringify(get_sd()));\n        newTab.type = this.state.resourceType;\n        this.add_tab_to_tab_array(newTab);   \n    }\n    \n    add_tab_to_tab_array(newTab){\n        this.setState(state => {\n            const tabs = this.state.tabs.concat(newTab);\n                return {\n                    tabs,\n                }\n            }, () => {\n                    console.log(this.state.tabs, 'added to array');\n                   this.setActiveTab(newTab.id);\n                }\n        );\n    }\n\nsetType(type){\n    this.setState({resourceType: type}, () =>\n        console.log(this.state.resourceType, 'type set'));\n}\n\n\n\n\n    test(index) {\n        this.setState({\n            current_tab: index\n        });\n        console.log(this.current_tab);\n    }\n\n    setActiveTab(value){\n        this.setState({\n            current_tab: value\n        }, function (){\n            console.log(this.state.current_tab, 'active');\n        });\n\n\n\n    }\n\n    add_resource_metadata(resource_id, key, value) {\n    /*\n    Add metadata, a key:value pair to the resource dict identified\n    by the supplied atom ID.    \n    */\n    if (resource_id && key && value) {\n        this.sate.sd.resources.forEach(function(res) {\n            if(res.id === resource_id) {\n                res.metadata[key] = value;\n            }\n        });\n    }\n}\n\n//Menu function\nhandleSetPng(png){\n    this.setState({png: png}, () =>\n        console.log('PNG set'));\n}\n\nhandleSetJpg(jpg){\n    this.setState({jpg: jpg}, () =>\n        console.log('JPG set'));\n}\n\ncomponentDidMount() {\n this.slideout = new Slideout({\n    'panel': document.getElementById('panel'),\n    'menu': document.getElementById('menu'),\n    \"fx\": \"ease\",\n    \"side\": \"right\",\n    \"duration\": 500,\n    \"padding\": 256,\n    \"tolerance\": 70,\n\n});\n}\n\nremove_tab(i){\n    delete_resource(this.state.current_tab);\n    remove_resources_from_nodes(this.state.current_tab);\n\n    localStorage.setItem(\"state\",JSON.stringify(get_sd()));\n    \n    if (this.state.tabs.length >= 1 && i != -1){\n\n        this.setState(state =>{\n        const tabs = state.tabs.filter((item, j) => i !==j);\n        return {\n            tabs,\n        };\n    }, () => {    \n        console.log(this.state.tabs.length, 'current tabs');\n        let newCurrent = this.state.tabs[this.state.tabs.length-1].id\n        console.log(newCurrent, 'newCurrent');\n        console.log(this.state.tabs, 'tabs');\n        this.setState({current_tab: newCurrent}, () =>\n            console.log(this.state.current_tab, 'current tabs')\n            ); \n    \n    });\n\n          \n    }\n    \n};\n\nremove_all_tabs(){\n    this.setState({tabs: [], last_number:1}, () =>{\n        console.log(this.state.tabs,'remove all tabs');\n        });\n}\n\n\n\n\ntoggleButton(){\n    this.slideout.toggle();\n}\n\n\n\n\n\nfileManager(operation, filetype, tab_id) {\n    /*\n    Write text from tab to file or does a SADFace save operation\n    */\n\n    console.log(operation, filetype, tab_id);\n    if (\"save\" == operation)    {\n        let tab_to_download = this.getTab(this.state.current_tab);\n        console.log(tab_to_download);\n        // if it's a txt file\n        if (\"txt\" == filetype) {   \n\n            if (tab_to_download.metadata.title !== '') {\n                var filename = tab_to_download.metadata.title+\".txt\";\n            } else {\n                var filename = \"tab\"+this.state.current_tab+\"_text.txt\";\n            }\n            var text = tab_to_download.content;\n            this.download(filename,text);\n        }\n        \n        // if it's a JSON file\n        if (\"json\" == filetype) {\n           var filename = this.state.fileName;\n           console.log(filename, 'filename');\n            if(filename.length == 0){ filename = \"default\"}\n               saveSADFace(filename, filetype);\n        }\n    }\n    \n    //if it's a load operation\n    if (\"load\" == operation) {\n        // if it's a txt file\n        if (\"txt\" == filetype) {\n            \n\n            var files = document.getElementById(\"load\"+this.state.current_tab).files;\n            var file = files[0];\n            var filename = file.name;\n            var reader = new FileReader();      \n            reader.onload = function(e) {\n                var content = reader.result;\n              //  document.getElementById(this.state.current_tab).innerText = content;\n                update_resource(tab_id, content, filename);\n                this.updateTab(filename, content);\n            }.bind(this);\n            reader.readAsText(file);\n        }\n        // if it's a JSON file\n        if (\"json\" == filetype) {\n            console.log('IMPORT JSON');\n            var files = document.getElementById(\"loadJSON\").files;\n            var file = files[0];\n            var reader = loadSADFace(file);\n            if (reader != null){\n            reader.onload = function(e) {\n                var result = reader.result;\n                localStorage.setItem(\"state\",result);\n                this.loadJSON(result);\n                var json = JSON.parse(result);\n                this.setState({remove_all_tabs: !this.state.remove_all_tabs}, () =>\n                    console.log(this.state.remove_all_tabs));\n            }.bind(this);\n        }\n        }\n    }\n}\n\nupdateTab(title, content){\n    const tabs = this.state.tabs.slice();\n\n    tabs.forEach((tab) =>{\n        if(tab.id === this.state.current_tab) {\n            if(title != ''){\n                tab.metadata.title = title;\n            }\n            if(content != ''){\n            tab.content = content;\n        }\n        }\n    });\n    this.setState({tabs});\n\n}\n\ngetTab(id){\n    let getTab = this.state.tabs.find(el => el.id == id);\n    return getTab;\n\n}\n\nloadJSON(json_value) {\n    let importJSON = import_json(json_value);\n    localStorage.setItem(\"state\",JSON.stringify(get_sd()));\n    this.setState({current_sadface_doc: JSON.stringify(get_sd())}, () =>{\n        console.log(this.state.current_sadface_doc, 'current_sadface_doc set')\n    });\n\n    this.setState({json: importJSON}, () => {\n        console.log(this.state.json, 'json state set');\n        this.setState({tabs: [], last_number:0, current_tab: ''}, () =>{\n            console.log(this.state.tabs, 'empty tabs');\n            console.log(this.state.json.resources,'resources');\n            this.loadTabs(this.state.json.resources);\n\n        });\n        this.setCyData(export_cytoscape(this.state.json));\n    });      \n}\n\n\n\nsetCyData(val){\n    this.setState({cy_data: val},() =>\n        console.log('cy_data set'));\n}\n\n\ndownload(filename, text) {\n    /*\n    Downloads a file given its filename and its text using utf-8 charset\n    */\n    console.log(\"Downloading \"+filename);\n    var outfile = document.createElement(\"a\");\n    outfile.setAttribute(\"href\", \"data:text/plain;charset=utf-8,\" + encodeURIComponent(text));\n    outfile.setAttribute(\"download\", filename);\n\n    outfile.style.display = \"none\";\n    document.body.appendChild(outfile);\n\n    outfile.click();\n\n    document.body.removeChild(outfile);\n}\n\n\nget_resource(resource_id){\n    /*\n    Retrieve the resource dict identified by the supplied resource ID\n\n    Returns: An resource dict\n    */\n    if(resource_id){\n        var resource;\n        const index = this.state.tabs.findIndex((tab) => tab.tab_id === resource_id);\n        const tabs = [...this.state.tabs]\n        resource = tabs[index];\n        return resource;\n    }\n}\n\nisTab_id(tab){\n    return tab.tab_id\n}\n\n\n\n\n\n\n\nloadTabs(resources){\n    console.log(resources.length, 'load tabs resources');\n    if(resources.length >= 1){\n    this.setState(state => {\n            const tabs = this.state.tabs.concat(resources);\n                return {\n                    tabs,\n                }\n            }, () => {\n                    console.log(this.state.tabs, 'added to array');\n                    console.log(this.state.tabs[this.state.tabs.length - 1].id, 'tabs length');\n                  this.setActiveTab(this.state.tabs[this.state.tabs.length - 1].id);\n                }\n        );\n    \n   }\n }\n\n\nload_tab(resource) {\n    if (resource != null) {\n        console.log(resource, 'load_tab');\n        this.add_tab(resource);\n        \n    }\n}\n\nupdate_resource(resource_id, content, title) {\n    /*\n    Given an ID for an existing resource, update the content and metadata of the resource.\n    Updates the resource in sd;\n    */\n    \n\n    if (resource_id && (content || title)) {\n        console.log(\"update resource\");\n\n        var resource;\n        const index = this.state.tabs.findIndex((tab) => tab.tab_id === resource_id);\n        const tabs = [...this.state.tabs]\n        resource = tabs[index];\n\n        if (resource !== null && resource !== undefined) {\n            if (content !== null && content !== undefined) {\n                resource.content = content;\n            }\n            if (title !== null && title !== undefined) {\n                resource.title = title;\n            }\n          /*  this.state.sd.resources.forEach((res) => {\n                if(res.id === resource_id) {\n                    res = resource;\n                }\n            });*/\n        } else {\n            throw (\"Could not update the resource: \"+resource_id);\n        }\n        this.setState({tabs}, () =>{\n            console.log(\"update tabs\");\n        });\n    }\n}\n\n//Resource Pane Functions\nchange_title(tab_id, val) {\n    this.set_text_resource_title(tab_id, val);\n    this.updateTab(val, '');\n}\n\nset_text_resource_title(tab_id, title){\n    console.log(\"set text resource title\" +tab_id + title)\n    this.update_resource(tab_id, null, title);\n    this.setState({update_local_storage: !this.state.update_local_storage});\n    }\n\nchange_content(tab_id, val){\n    this.set_text_resource_content(tab_id, val);\n        this.updateTab('', val);\n        console.log(get_sd(), 'get sd');\n        console.log(this.state.tabs, 'tabs');\n\n}\n\nset_text_resource_content(tab_id, text){\n    this.update_resource(tab_id, text, null);\n    this.setState({update_local_storage: !this.state.update_local_storage});\n}\n\nsetSelectedText(text){\n    this.setState({selectedText: text}, () =>\n        console.log(this.state.selectedText, 'selectedText set'));\n       // this.setFocus();    \n}\n\nsetFocus(){\n    this.setState({focus: !this.state.focus}, () =>\n        console.log(this.state.focus, 'focus set'));\n}\n\nclearSelection() {\n    if (window.getSelection) {\n        if (window.getSelection().empty) {  // Chrome\n            window.getSelection().empty();\n        } \n        if (window.getSelection().removeAllRanges) {  // Firefox\n            window.getSelection().removeAllRanges();\n        }\n    } \n    if (document.selection) {  // IE?\n        document.selection.empty();\n    }\n    this.setState({selectedText: null}, () =>\n        console.log(this.state.selectedText, 'selectedText Reset'));\n}\n\n// Slide In Functions\ntoggleResourcePane(){\n    this.setState({showResourcePane: !this.state.showResourcePane})\n}\n\n\nclear_local_storage() {\n    localStorage.clear();\n    window.location.reload(false);\n}\n\n setFileName(file_name){\n    console.log('filename APP');\n    this.setState({fileName: file_name}, () => \n      console.log(this.state.fileName, 'filename app'));\n  }\n\nload_demo_argument(){\n   var demo_sadface_doc = \"{\\\"analyst_email\\\":\\\"40170722@live.napier.ac.uk\\\",\\\"analyst_name\\\":\\\"Nathan Mair\\\",\\\"created\\\":\\\"2018-02-23T02:27:36\\\",\\\"edges\\\":[{\\\"id\\\":\\\"a1s1\\\",\\\"source_id\\\":\\\"a1\\\",\\\"target_id\\\":\\\"s1\\\"},{\\\"id\\\":\\\"a2s1\\\",\\\"source_id\\\":\\\"a2\\\",\\\"target_id\\\":\\\"s1\\\"},{\\\"id\\\":\\\"a3s2\\\",\\\"source_id\\\":\\\"a3\\\",\\\"target_id\\\":\\\"s2\\\"},{\\\"id\\\":\\\"s2a5\\\",\\\"source_id\\\":\\\"s2\\\",\\\"target_id\\\":\\\"a5\\\"},{\\\"id\\\":\\\"s1a4\\\",\\\"source_id\\\":\\\"s1\\\",\\\"target_id\\\":\\\"a4\\\"},{\\\"id\\\":\\\"a4s2\\\",\\\"source_id\\\":\\\"a4\\\",\\\"target_id\\\":\\\"s2\\\"}],\\\"edited\\\":\\\"2018-02-23T02:27:36\\\",\\\"id\\\":\\\"94a975db-25ae-4d25-93cc-1c07c932e2f9\\\",\\\"metadata\\\":{},\\\"nodes\\\":[{\\\"id\\\":\\\"a1\\\",\\\"metadata\\\":{},\\\"sources\\\":[],\\\"text\\\":\\\"Every person is going to die\\\",\\\"type\\\":\\\"atom\\\"},{\\\"id\\\":\\\"a2\\\",\\\"metadata\\\":{},\\\"sources\\\":[],\\\"text\\\":\\\"You are a person\\\",\\\"type\\\":\\\"atom\\\"},{\\\"id\\\":\\\"a3\\\",\\\"metadata\\\":{\\\"test\\\":\\\"test\\\"},\\\"sources\\\":[],\\\"text\\\":\\\"If you are going to die then you should treasure every moment\\\",\\\"type\\\":\\\"atom\\\"},{\\\"id\\\":\\\"a4\\\",\\\"metadata\\\":{},\\\"sources\\\":[],\\\"text\\\":\\\"You are going to die\\\",\\\"type\\\":\\\"atom\\\"},{\\\"id\\\":\\\"a5\\\",\\\"metadata\\\":{},\\\"sources\\\":[],\\\"text\\\":\\\"You should treasure every moment\\\",\\\"type\\\":\\\"atom\\\"},{\\\"id\\\":\\\"s1\\\",\\\"name\\\":\\\"Support\\\",\\\"type\\\":\\\"scheme\\\"},{\\\"id\\\":\\\"s2\\\",\\\"name\\\":\\\"Support\\\",\\\"type\\\":\\\"scheme\\\"}],\\\"resources\\\": []}\";\n\n    localStorage.setItem(\"state\",demo_sadface_doc);\n    this.setCyData(export_cytoscape(import_json(demo_sadface_doc)))\n    //this.setState({cy_data: export_cytoscape(import_json(demo_sadface_doc))}, () =>\n    //    console.log(this.state.cy_data, 'cy_data'));\n}\n\n\nrender(){\n\n    return (\n    \t<div>\n\n\n\n    \t<Menu \n        //functions\n        toggleResourcePane={this.toggleResourcePane}\n        load_demo_argument={this.load_demo_argument}\n        setFileName={this.setFileName}\n        fileManager={this.fileManager}\n        //state\n        png={this.state.png}\n        jpg={this.state.jpg}\n        fileName = {this.state.fileName}\n        />\n\n        <MainUI\n        toggleSlideIn={() => this.toggleButton()}\n        addTab = {() => this.add_tab()}\n        tabs = {this.state.tabs}\n        setType={this.setType}\n        remove_tab={this.remove_tab}\n        fileManager={this.fileManager}\n        showResourcePane={this.state.showResourcePane}\n        current_tab={this.state.current_tab}\n        setActiveTab={this.setActiveTab}\n        fileManager={this.fileManager}\n        change_title={this.change_title}\n        change_content={this.change_content}\n        loadTabs= {this.loadTabs}\n        cy_data= {this.state.cy_data}\n        setCyData = {this.setCyData}\n        loadJSON = {this.loadJSON}\n\n        handleSetPng={this.handleSetPng}\n        handleSetJpg={this.handleSetJpg}\n\n        remove_all_tabs={this.state.remove_all_tabs}\n\n        update_local_storage={this.state.update_local_storage}\n        set_focus={this.set_focus}\n        focused ={this.state.focused} \n        selectedText={this.state.selectedText}\n        setSelectedText={this.setSelectedText}\n        clearSelection={this.clearSelection}\n        focus={this.state.focus}\n\n\n\n\n\n        />\n\n        </div>\n\n        );\n}\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}