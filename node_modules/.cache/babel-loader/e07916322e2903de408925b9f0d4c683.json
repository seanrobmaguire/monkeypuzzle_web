{"ast":null,"code":"var _jsxFileName = \"/Users/gareth/Desktop/monkeypuzzle/src/App.js\";\nimport React, { Component } from 'react';\nimport Slideout from 'slideout'; //import Components\n//import MainUI from './Components/MainUI';\n\nimport Menu from './Components/Menu/Menu';\nimport MenuTrigger from './Components/Menu/MenuTrigger';\nimport ResourcePane from './Components/ResourcePane/ResourcePane';\nimport Cytoscape from './Components/VisualisationPane/Cytoscape';\nimport './CSS/monkeypuzzle.css'; //import './CSS/font-awesome.min.css';\n//import './CSS/jquery.qtip.min.css';\n//import './CSS/bootstrap.min.css';\n\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport './CSS/App.css'; //import fuctions from SADFACE\n\nimport { add_resource, download, update_resource, remove_resources_from_nodes, loadSADFace, saveSADFace, delete_resource, get_sd, import_json, export_cytoscape } from './lib/Sadface';\n\nclass App extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      tabs: [],\n      last_number: 0,\n      tab_id: \"\",\n      sd: get_sd(),\n      showResourcePane: true,\n      //  current_tab: 0,\n      demo: null,\n      selected: '',\n      jpg: '',\n      png: '',\n      fileName: '',\n      json: '',\n      current_sadface_doc: null,\n      cy: null,\n      remove_all_tabs: false,\n      resourceType: 'text',\n      update_local_storage: false,\n      selectedText: null,\n      focus: true,\n      newAtomFromText: null\n    };\n    this.toggleButton = this.toggleButton.bind(this);\n    this.loadJSON = this.loadJSON.bind(this);\n    this.loadTabs = this.loadTabs.bind(this);\n    this.toggleResourcePane = this.toggleResourcePane.bind(this); // this.setActiveTab = this.setActiveTab.bind(this);\n\n    this.fileManager = this.fileManager.bind(this); //      this.setCyData = this.setCyData.bind(this);\n    //ResourcePane Functions\n    //  this.add_tab = this.add_tab.bind(this);\n    // this.remove_tab =this.remove_tab.bind(this);\n\n    this.change_title = this.change_title.bind(this);\n    this.change_content = this.change_content.bind(this);\n    this.set_text_resource_content = this.set_text_resource_content.bind(this); //  this.setType = this.setType.bind(this);\n\n    this.updateTab = this.updateTab.bind(this);\n    this.getTab = this.getTab.bind(this);\n    this.setSelectedText = this.setSelectedText.bind(this);\n    this.setFocus = this.setFocus.bind(this);\n    this.addAtomFromText = this.addAtomFromText.bind(this); //Menu\n\n    this.handleSetPng = this.handleSetPng.bind(this);\n    this.handleSetJpg = this.handleSetJpg.bind(this);\n    this.load_demo_argument = this.load_demo_argument.bind(this);\n    this.setFileName = this.setFileName.bind(this); //Cytoscape\n\n    this.clearSelection = this.clearSelection.bind(this);\n    this.setCurrentSadFaceDoc = this.setCurrentSadFaceDoc.bind(this);\n  } //ResourcePane\n\n\n  addTab() {\n    console.log(\"add tab\");\n    let newTab = {};\n    newTab = add_resource(' ');\n    add_resource_metadata(newTab.id, 'title', '');\n    newTab.metadata = {\n      title: ''\n    };\n    localStorage.setItem(\"state\", JSON.stringify(get_sd()));\n    newTab.type = this.state.resourceType;\n    this.addTabToArray(newTab);\n    console.log(get_sd());\n  }\n\n  addTabToArray(newTab) {\n    this.setState(state => {\n      const tabs = this.state.tabs.concat(newTab);\n      return {\n        tabs\n      };\n    }, () => {\n      console.log(this.state.tabs, 'added to array');\n      this.setActiveTab(newTab.id);\n    });\n  }\n\n  setActiveTab(value) {\n    console.log(\"setActiveTabs\");\n    this.setState({\n      current_tab: value\n    }, function () {\n      console.log(this.state.current_tab, 'active');\n    });\n  }\n\n  remove_tab(i, tabId) {\n    delete_resource(tabId);\n    remove_resources_from_nodes(tabId);\n    localStorage.setItem(\"state\", JSON.stringify(get_sd()));\n\n    if (this.state.tabs.length >= 1 && i !== -1) {\n      this.setState(state => {\n        const tabs = state.tabs.filter((item, j) => i !== j);\n        return {\n          tabs\n        };\n      }, () => {\n        if (this.state.tabs.length >= 1) {\n          this.setActiveTab(this.state.tabs[this.state.tabs.length - 1].id);\n        }\n      });\n    }\n  }\n\n  addAtomFromText() {\n    if (this.state.selectedText !== null) {\n      this.setState({\n        newAtomFromText: !true\n      }, () => console.log(this.state.newAtomFromText, \"set addAtomFromText\"));\n    }\n  } //Menu function\n\n\n  handleSetPng(png) {\n    this.setState({\n      png: png\n    }, () => console.log('PNG set'));\n  }\n\n  handleSetJpg(jpg) {\n    this.setState({\n      jpg: jpg\n    }, () => console.log('JPG set'));\n  }\n\n  componentDidMount() {\n    this.slideout = new Slideout({\n      'panel': document.getElementById('panel'),\n      'menu': document.getElementById('menu'),\n      \"fx\": \"ease\",\n      \"side\": \"right\",\n      \"duration\": 500,\n      \"padding\": 256,\n      \"tolerance\": 70\n    });\n  } // remove_tab(i, tabId){\n  //     delete_resource(tabId);\n  //     remove_resources_from_nodes(tabId);\n  //     localStorage.setItem(\"state\",JSON.stringify(get_sd()));\n  //     if (this.state.tabs.length >= 1 && i !== -1){\n  //         this.setState(state =>{\n  //         const tabs = state.tabs.filter((item, j) => i !==j);\n  //         return {\n  //             tabs,\n  //         };\n  //     }, () => {    \n  //        console.log(\"resource deleted\");\n  //          });\n  //     }\n  // };\n\n\n  remove_all_tabs() {\n    this.setState({\n      tabs: [],\n      last_number: 1\n    }, () => {\n      console.log(this.state.tabs, 'remove all tabs');\n    });\n  }\n\n  toggleButton() {\n    this.slideout.toggle();\n  }\n\n  fileManager(operation, filetype, tab_id, files) {\n    /*\n    Write text from tab to file or does a SADFace save operation\n    */\n    if (\"save\" === operation) {\n      let filename = '';\n      let tab_to_download = this.getTab(tab_id);\n      console.log(tab_to_download); // if it's a txt file\n\n      if (\"txt\" === filetype) {\n        if (tab_to_download.metadata.title !== '') {\n          filename = tab_to_download.metadata.title + \".txt\";\n        } else {\n          filename = \"tab\" + this.state.current_tab + \"_text.txt\";\n        }\n\n        let text = tab_to_download.content;\n        download(filename, text);\n      } // if it's a JSON file\n\n\n      if (\"json\" === filetype) {\n        let filename = this.state.fileName;\n        console.log(filename, 'filename');\n\n        if (filename.length === 0) {\n          filename = \"default\";\n        }\n\n        saveSADFace(filename, filetype);\n      }\n    } //if it's a load operation\n\n\n    if (\"load\" === operation) {\n      // if it's a txt file\n      if (\"txt\" === filetype) {\n        let file = files[0];\n        let filename = file.name;\n        let reader = new FileReader();\n\n        reader.onload = function (e) {\n          var content = reader.result;\n          update_resource(tab_id, content, filename);\n          this.updateTab(filename, content);\n        }.bind(this);\n\n        reader.readAsText(file);\n      } // if it's a JSON file\n\n\n      if (\"json\" === filetype) {\n        console.log('IMPORT JSON');\n        let files = document.getElementById(\"loadJSON\").files;\n        let file = files[0];\n        let reader = loadSADFace(file);\n\n        if (reader !== null) {\n          reader.onload = function (e) {\n            let result = reader.result;\n            localStorage.setItem(\"state\", result);\n            this.loadJSON(result); //let json = JSON.parse(result);\n\n            this.setState({\n              remove_all_tabs: !this.state.remove_all_tabs\n            }, () => console.log(this.state.remove_all_tabs));\n          }.bind(this);\n        }\n      }\n    }\n  }\n\n  updateTab(tab_id, title, content) {\n    const tabs = this.state.tabs.slice();\n    tabs.forEach(tab => {\n      if (tab.id === this.state.tab_id) {\n        if (title !== '') {\n          tab.metadata.title = title;\n        }\n\n        if (content !== '') {\n          tab.content = content;\n        }\n      }\n    });\n    this.setState({\n      tabs\n    });\n  }\n\n  loadJSON(json_value) {\n    let importJSON = import_json(json_value);\n    localStorage.setItem(\"state\", JSON.stringify(get_sd()));\n    this.setCurrentSadFaceDoc(JSON.stringify(get_sd()));\n    this.setState({\n      json: importJSON\n    }, () => {\n      console.log('json state set');\n      this.setState({\n        tabs: [],\n        last_number: 0,\n        current_tab: ''\n      }, () => {\n        console.log('empty tabs');\n        this.loadTabs(this.state.json.resources);\n      });\n      this.setCyData(export_cytoscape(this.state.json));\n    });\n  }\n\n  setCurrentSadFaceDoc(value) {\n    this.setState({\n      current_sadface_doc: value\n    }, () => console.log('current_sadface_doc set'));\n  }\n\n  setDemo(val) {\n    this.setState({\n      demo: val\n    }, () => console.log('demo set'));\n  }\n\n  loadTabs(resources) {\n    console.log(resources.length, 'load tabs resources');\n\n    if (resources.length >= 1) {\n      this.setState(state => {\n        const tabs = this.state.tabs.concat(resources);\n        return {\n          tabs\n        };\n      }, () => {\n        console.log('added to array'); //                  this.setActiveTab(this.state.tabs[this.state.tabs.length - 1].id);\n      });\n    }\n  } //Resource Pane Functions\n\n\n  change_title(tab_id, val) {\n    console.log(tab_id, val, \"change title app\");\n    this.set_text_resource_title(tab_id, val);\n    this.updateTab(tab_id, val, '');\n  }\n\n  set_text_resource_title(tab_id, title) {\n    update_resource(tab_id, null, title);\n    this.setState({\n      update_local_storage: !this.state.update_local_storage\n    });\n  }\n\n  change_content(tab_id, val) {\n    this.set_text_resource_content(tab_id, val);\n    this.updateTab(tab_id, '', val);\n  }\n\n  set_text_resource_content(tab_id, text) {\n    update_resource(tab_id, text, null);\n    this.setState({\n      update_local_storage: !this.state.update_local_storage\n    });\n  }\n\n  setSelectedText(text) {\n    if (text !== null && text.length > 0) {\n      this.setState(state => ({\n        selectedText: text,\n        focus: false\n      }), () => console.log(this.state.selectedText, \"FOCUS\"));\n    } else {\n      this.setState(() => ({\n        selectedText: null,\n        focus: true\n      }), () => console.log(this.state.focus, this.state.selectedText, \"NO FOCUS\"));\n    }\n  }\n\n  setFocus() {\n    this.setState({\n      focus: !this.state.focus\n    }, () => console.log(this.state.focus, 'focus set'));\n  }\n\n  clearSelection() {\n    console.log(\"clear selection\");\n\n    if (window.getSelection) {\n      if (window.getSelection().empty) {\n        // Chrome\n        window.getSelection().empty();\n      }\n\n      if (window.getSelection().removeAllRanges) {\n        // Firefox\n        window.getSelection().removeAllRanges();\n      }\n    }\n\n    if (document.selection) {\n      // IE?\n      document.selection.empty();\n    }\n\n    this.setState(() => ({\n      selectedText: null,\n      focus: true\n    }));\n  } // Slide In Functions\n\n\n  toggleResourcePane() {\n    this.setState({\n      showResourcePane: !this.state.showResourcePane\n    });\n  }\n\n  setFileName(file_name) {\n    console.log('filename APP');\n    this.setState({\n      fileName: file_name\n    }, () => console.log(this.state.fileName, 'filename app'));\n  }\n\n  load_demo_argument() {\n    var demo_sadface_doc = \"{\\\"analyst_email\\\":\\\"40170722@live.napier.ac.uk\\\",\\\"analyst_name\\\":\\\"Nathan Mair\\\",\\\"created\\\":\\\"2018-02-23T02:27:36\\\",\\\"edges\\\":[{\\\"id\\\":\\\"a1s1\\\",\\\"source_id\\\":\\\"a1\\\",\\\"target_id\\\":\\\"s1\\\"},{\\\"id\\\":\\\"a2s1\\\",\\\"source_id\\\":\\\"a2\\\",\\\"target_id\\\":\\\"s1\\\"},{\\\"id\\\":\\\"a3s2\\\",\\\"source_id\\\":\\\"a3\\\",\\\"target_id\\\":\\\"s2\\\"},{\\\"id\\\":\\\"s2a5\\\",\\\"source_id\\\":\\\"s2\\\",\\\"target_id\\\":\\\"a5\\\"},{\\\"id\\\":\\\"s1a4\\\",\\\"source_id\\\":\\\"s1\\\",\\\"target_id\\\":\\\"a4\\\"},{\\\"id\\\":\\\"a4s2\\\",\\\"source_id\\\":\\\"a4\\\",\\\"target_id\\\":\\\"s2\\\"}],\\\"edited\\\":\\\"2018-02-23T02:27:36\\\",\\\"id\\\":\\\"94a975db-25ae-4d25-93cc-1c07c932e2f9\\\",\\\"metadata\\\":{},\\\"nodes\\\":[{\\\"id\\\":\\\"a1\\\",\\\"metadata\\\":{},\\\"sources\\\":[],\\\"text\\\":\\\"Every person is going to die\\\",\\\"type\\\":\\\"atom\\\"},{\\\"id\\\":\\\"a2\\\",\\\"metadata\\\":{},\\\"sources\\\":[],\\\"text\\\":\\\"You are a person\\\",\\\"type\\\":\\\"atom\\\"},{\\\"id\\\":\\\"a3\\\",\\\"metadata\\\":{\\\"test\\\":\\\"test\\\"},\\\"sources\\\":[],\\\"text\\\":\\\"If you are going to die then you should treasure every moment\\\",\\\"type\\\":\\\"atom\\\"},{\\\"id\\\":\\\"a4\\\",\\\"metadata\\\":{},\\\"sources\\\":[],\\\"text\\\":\\\"You are going to die\\\",\\\"type\\\":\\\"atom\\\"},{\\\"id\\\":\\\"a5\\\",\\\"metadata\\\":{},\\\"sources\\\":[],\\\"text\\\":\\\"You should treasure every moment\\\",\\\"type\\\":\\\"atom\\\"},{\\\"id\\\":\\\"s1\\\",\\\"name\\\":\\\"Support\\\",\\\"type\\\":\\\"scheme\\\"},{\\\"id\\\":\\\"s2\\\",\\\"name\\\":\\\"Support\\\",\\\"type\\\":\\\"scheme\\\"}],\\\"resources\\\": []}\";\n    localStorage.setItem(\"state\", demo_sadface_doc);\n    this.setCyData(export_cytoscape(import_json(demo_sadface_doc))); //this.setState({cy_data: export_cytoscape(import_json(demo_sadface_doc))}, () =>\n    //    console.log(this.state.cy_data, 'cy_data'));\n  }\n\n  render() {\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 427\n      },\n      __self: this\n    }, React.createElement(Menu //functions\n    , {\n      toggleResourcePane: this.toggleResourcePane,\n      load_demo_argument: this.load_demo_argument,\n      setFileName: this.setFileName,\n      fileManager: this.fileManager //state\n      ,\n      png: this.state.png,\n      jpg: this.state.jpg,\n      fileName: this.state.fileName,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 431\n      },\n      __self: this\n    }), React.createElement(\"main\", {\n      id: \"panel\",\n      className: \"panel\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 443\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"ui-container\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 445\n      },\n      __self: this\n    }, React.createElement(ResourcePane //state\n    , {\n      tabs: this.state.tabs // add_tab_to_tab_array = {this.add_tab_to_tab_array}\n      // current_tab = {this.current_tab}\n      // tabs={this.state.tabs}\n      // remove_tab={this.remove_tab}\n      ,\n      showResourcePane: this.state.showResourcePane // setActiveTab={this.setActiveTab}\n      ,\n      fileManager: this.fileManager,\n      change_title: this.change_title,\n      change_content: this.change_content,\n      setType: this.setType,\n      set_focus: this.set_focus,\n      focus: this.focus,\n      selectedText: this.selectedText,\n      setSelectedText: this.setSelectedText,\n      clearSelection: this.clearSelection,\n      addAtomFromText: this.addAtomFromText,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 446\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: \"splitter\",\n      id: \"splitter\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 469\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: \"visualisation-pane\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 472\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      id: \"navbar\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 473\n      },\n      __self: this\n    }, React.createElement(MenuTrigger, {\n      className: \"btn-hamburger toggle-button\",\n      onClick: this.toggleButton,\n      showResourcePane: this.state.showResourcePane,\n      loadDemoArgument: this.loadDemoArgument,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 475\n      },\n      __self: this\n    }))))));\n  }\n\n}\n\nexport default App;","map":{"version":3,"sources":["/Users/gareth/Desktop/monkeypuzzle/src/App.js"],"names":["React","Component","Slideout","Menu","MenuTrigger","ResourcePane","Cytoscape","add_resource","download","update_resource","remove_resources_from_nodes","loadSADFace","saveSADFace","delete_resource","get_sd","import_json","export_cytoscape","App","constructor","props","state","tabs","last_number","tab_id","sd","showResourcePane","demo","selected","jpg","png","fileName","json","current_sadface_doc","cy","remove_all_tabs","resourceType","update_local_storage","selectedText","focus","newAtomFromText","toggleButton","bind","loadJSON","loadTabs","toggleResourcePane","fileManager","change_title","change_content","set_text_resource_content","updateTab","getTab","setSelectedText","setFocus","addAtomFromText","handleSetPng","handleSetJpg","load_demo_argument","setFileName","clearSelection","setCurrentSadFaceDoc","addTab","console","log","newTab","add_resource_metadata","id","metadata","title","localStorage","setItem","JSON","stringify","type","addTabToArray","setState","concat","setActiveTab","value","current_tab","remove_tab","i","tabId","length","filter","item","j","componentDidMount","slideout","document","getElementById","toggle","operation","filetype","files","filename","tab_to_download","text","content","file","name","reader","FileReader","onload","e","result","readAsText","slice","forEach","tab","json_value","importJSON","resources","setCyData","setDemo","val","set_text_resource_title","window","getSelection","empty","removeAllRanges","selection","file_name","demo_sadface_doc","render","setType","set_focus","loadDemoArgument"],"mappings":"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","sourcesContent":["import React, {Component} from 'react';\nimport Slideout from 'slideout';\n\n//import Components\n//import MainUI from './Components/MainUI';\nimport Menu from './Components/Menu/Menu';\nimport MenuTrigger from './Components/Menu/MenuTrigger';\nimport ResourcePane from './Components/ResourcePane/ResourcePane';\nimport Cytoscape from './Components/VisualisationPane/Cytoscape';\n\nimport './CSS/monkeypuzzle.css';\n//import './CSS/font-awesome.min.css';\n//import './CSS/jquery.qtip.min.css';\n//import './CSS/bootstrap.min.css';\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport './CSS/App.css';\n\n\n//import fuctions from SADFACE\n\nimport {add_resource,download, update_resource,remove_resources_from_nodes, loadSADFace,saveSADFace, delete_resource, get_sd,import_json, export_cytoscape} from './lib/Sadface'; \n\nclass App extends Component{\n\tconstructor(props){\n\t\tsuper(props);\n\t\tthis.state = {\n\t\t\ttabs: [],\n\t\t\tlast_number: 0,\n\t\t\ttab_id:\"\",\n            sd: get_sd(),\n            showResourcePane: true,\n          //  current_tab: 0,\n            demo: null,\n            selected: '',\n            jpg:'',\n            png: '',\n            fileName:'',\n            json: '',\n            current_sadface_doc:null,\n            cy:null,\n            remove_all_tabs: false,\n            resourceType: 'text',\n            update_local_storage: false,\n            selectedText: null,\n            focus: true,\n            newAtomFromText: null,\n        };\n\n\n        this.toggleButton = this.toggleButton.bind(this);\n        this.loadJSON = this.loadJSON.bind(this);\n        this.loadTabs =this.loadTabs.bind(this);\n        this.toggleResourcePane =this.toggleResourcePane.bind(this);\n       // this.setActiveTab = this.setActiveTab.bind(this);\n        this.fileManager = this.fileManager.bind(this);\n  //      this.setCyData = this.setCyData.bind(this);\n\n        //ResourcePane Functions\n      //  this.add_tab = this.add_tab.bind(this);\n       // this.remove_tab =this.remove_tab.bind(this);\n        this.change_title = this.change_title.bind(this);\n        this.change_content =this.change_content.bind(this);\n        this.set_text_resource_content = this.set_text_resource_content.bind(this);\n      //  this.setType = this.setType.bind(this);\n        this.updateTab = this.updateTab.bind(this);\n        this.getTab = this.getTab.bind(this);\n        this.setSelectedText = this.setSelectedText.bind(this);\n        this.setFocus = this.setFocus.bind(this);\n        this.addAtomFromText = this.addAtomFromText.bind(this);\n        //Menu\n        this.handleSetPng = this.handleSetPng.bind(this);\n        this.handleSetJpg = this.handleSetJpg.bind(this);\n        this.load_demo_argument = this.load_demo_argument.bind(this);\n        this.setFileName = this.setFileName.bind(this);\n        //Cytoscape\n        this.clearSelection = this.clearSelection.bind(this);\n        this.setCurrentSadFaceDoc = this.setCurrentSadFaceDoc.bind(this);\n\n    }\n//ResourcePane\n    addTab(){\n        console.log(\"add tab\");\n        let newTab = {}\n        newTab = add_resource(' ');\n        add_resource_metadata(newTab.id, 'title', '');\n\n        newTab.metadata = {title: ''}\n\n\n        localStorage.setItem(\"state\", JSON.stringify(get_sd()));\n        newTab.type = this.state.resourceType;\n        this.addTabToArray(newTab);   \n        console.log(get_sd());\n    }\n\n\n     addTabToArray(newTab){\n        this.setState(state => {\n            const tabs = this.state.tabs.concat(newTab);\n                return {\n                    tabs,\n                }\n            }, () => {\n                    console.log(this.state.tabs, 'added to array');\n                   this.setActiveTab(newTab.id);\n                }\n        );\n    }\n\n     setActiveTab(value){\n        console.log(\"setActiveTabs\");\n        this.setState({\n            current_tab: value\n        }, function (){\n            console.log(this.state.current_tab, 'active');\n        });\n    }\n\n      remove_tab(i, tabId){\n        delete_resource(tabId);\n        remove_resources_from_nodes(tabId);\n\n        localStorage.setItem(\"state\",JSON.stringify(get_sd()));\n        \n        if (this.state.tabs.length >= 1 && i !== -1){\n            this.setState(state =>{\n                const tabs = state.tabs.filter((item, j) => i !==j);\n                return {\n                    tabs,\n                };\n            }, () => {    \n            if(this.state.tabs.length >=1){\n                this.setActiveTab(this.state.tabs[this.state.tabs.length-1].id);\n            }\n            });      \n        }   \n    };\n\n\naddAtomFromText(){\n    if(this.state.selectedText !== null){\n        this.setState({newAtomFromText: !true}, () =>\n            console.log(this.state.newAtomFromText, \"set addAtomFromText\"));\n    }\n}\n\n//Menu function\nhandleSetPng(png){\n    this.setState({png: png}, () =>\n        console.log('PNG set'));\n}\n\nhandleSetJpg(jpg){\n    this.setState({jpg: jpg}, () =>\n        console.log('JPG set'));\n}\n\ncomponentDidMount() {\n    this.slideout = new Slideout({\n        'panel': document.getElementById('panel'),\n        'menu': document.getElementById('menu'),\n        \"fx\": \"ease\",\n        \"side\": \"right\",\n        \"duration\": 500,\n        \"padding\": 256,\n        \"tolerance\": 70,\n    });\n}\n\n// remove_tab(i, tabId){\n//     delete_resource(tabId);\n//     remove_resources_from_nodes(tabId);\n\n//     localStorage.setItem(\"state\",JSON.stringify(get_sd()));\n    \n//     if (this.state.tabs.length >= 1 && i !== -1){\n\n//         this.setState(state =>{\n//         const tabs = state.tabs.filter((item, j) => i !==j);\n//         return {\n//             tabs,\n//         };\n//     }, () => {    \n//        console.log(\"resource deleted\");\n//          });\n\n          \n//     }\n    \n// };\n\nremove_all_tabs(){\n    this.setState({tabs: [], last_number:1}, () =>{\n        console.log(this.state.tabs,'remove all tabs');\n        });\n}\n\ntoggleButton(){\n    this.slideout.toggle();\n}\n\nfileManager(operation, filetype, tab_id, files) {\n    /*\n    Write text from tab to file or does a SADFace save operation\n    */\n\n    if (\"save\" === operation)    {\n        let filename = '';\n        let tab_to_download = this.getTab(tab_id);\n        console.log(tab_to_download);\n        // if it's a txt file\n        if (\"txt\" === filetype) {   \n\n            if (tab_to_download.metadata.title !== '') {\n                 filename = tab_to_download.metadata.title+\".txt\";\n            } else {\n                 filename = \"tab\"+this.state.current_tab+\"_text.txt\";\n            }\n            let text = tab_to_download.content;\n            download(filename,text);\n        }\n        \n        // if it's a JSON file\n        if (\"json\" === filetype) {\n           let filename = this.state.fileName;\n           console.log(filename, 'filename');\n            if(filename.length === 0){ filename = \"default\"}\n               saveSADFace(filename, filetype);\n        }\n    }\n    \n    //if it's a load operation\n    if (\"load\" === operation) {\n        // if it's a txt file\n        if (\"txt\" === filetype) {\n            \n\n            let file = files[0];\n            let filename = file.name;\n            let reader = new FileReader();      \n            reader.onload = function(e) {\n                var content = reader.result;\n                update_resource(tab_id, content, filename);\n                this.updateTab(filename, content);\n            }.bind(this);\n            reader.readAsText(file);\n        }\n        // if it's a JSON file\n        if (\"json\" === filetype) {\n            console.log('IMPORT JSON');\n            let files = document.getElementById(\"loadJSON\").files;\n            let file = files[0];\n            let reader = loadSADFace(file);\n            if (reader !== null){\n            reader.onload = function(e) {\n                let result = reader.result;\n                localStorage.setItem(\"state\",result);\n                this.loadJSON(result);\n                //let json = JSON.parse(result);\n                this.setState({remove_all_tabs: !this.state.remove_all_tabs}, () =>\n                    console.log(this.state.remove_all_tabs));\n            }.bind(this);\n        }\n        }\n    }\n}\n\nupdateTab(tab_id, title, content){\n    const tabs = this.state.tabs.slice();\n\n    tabs.forEach((tab) =>{\n        if(tab.id === this.state.tab_id) {\n            if(title !== ''){\n                tab.metadata.title = title;\n            }\n            if(content !== ''){\n            tab.content = content;\n        }\n        }\n    });\n    this.setState({tabs});\n}\n\n\n\nloadJSON(json_value) {\n    let importJSON = import_json(json_value);\n    localStorage.setItem(\"state\",JSON.stringify(get_sd()));\n    this.setCurrentSadFaceDoc(JSON.stringify(get_sd()))\n   \n\n    this.setState({json: importJSON}, () => {\n        console.log('json state set');\n        this.setState({tabs: [], last_number:0, current_tab: ''}, () =>{\n            console.log('empty tabs');\n            this.loadTabs(this.state.json.resources);\n        });\n        this.setCyData(export_cytoscape(this.state.json));\n    });      \n}\n\nsetCurrentSadFaceDoc(value){\n    this.setState({current_sadface_doc: value}, () =>\n        console.log('current_sadface_doc set'));\n}\n\n\n\nsetDemo(val){\n    this.setState({demo: val},() =>\n        console.log('demo set'));\n}\n\n\nloadTabs(resources){\n    console.log(resources.length, 'load tabs resources');\n    if(resources.length >= 1){\n    this.setState(state => {\n            const tabs = this.state.tabs.concat(resources);\n                return {\n                    tabs,\n                }\n            }, () => {\n                    console.log('added to array');\n//                  this.setActiveTab(this.state.tabs[this.state.tabs.length - 1].id);\n                }\n        );\n    \n   }\n }\n\n\n\n\n\n//Resource Pane Functions\nchange_title(tab_id, val) {\n    console.log(tab_id, val, \"change title app\");\n    this.set_text_resource_title(tab_id, val);\n    this.updateTab(tab_id, val, '');\n}\n\nset_text_resource_title(tab_id, title){\n    update_resource(tab_id, null, title);\n    this.setState({update_local_storage: !this.state.update_local_storage});\n    }\n\nchange_content(tab_id, val){\n    this.set_text_resource_content(tab_id, val);\n    this.updateTab(tab_id, '', val);\n}\n\nset_text_resource_content(tab_id, text){\n    update_resource(tab_id, text, null);\n    this.setState({update_local_storage: !this.state.update_local_storage});\n}\n\nsetSelectedText(text){\n    if(text!== null && text.length > 0){\n        this.setState((state) => ({\n        selectedText: text,\n        focus: false,\n    }), () =>\n    console.log(this.state.selectedText, \"FOCUS\"));\n\n    }else{\n        this.setState(() => ({\n        selectedText: null,\n        focus: true,\n    }), () =>\n    console.log(this.state.focus, this.state.selectedText, \"NO FOCUS\"));\n    }\n    \n    \n            \n}\n\nsetFocus(){    \n        this.setState({focus: !this.state.focus}, () =>\n        console.log(this.state.focus, 'focus set'));\n}\n\nclearSelection() {\n    console.log(\"clear selection\");\n    if (window.getSelection) {\n        if (window.getSelection().empty) {  // Chrome\n            window.getSelection().empty();\n        } \n        if (window.getSelection().removeAllRanges) {  // Firefox\n            window.getSelection().removeAllRanges();\n        }\n    } \n    if (document.selection) {  // IE?\n        document.selection.empty();\n    }\n    this.setState(() => ({\n        selectedText: null,\n        focus: true,\n    }));\n}\n\n// Slide In Functions\ntoggleResourcePane(){\n    this.setState({showResourcePane: !this.state.showResourcePane})\n}\n\n setFileName(file_name){\n    console.log('filename APP');\n    this.setState({fileName: file_name}, () => \n      console.log(this.state.fileName, 'filename app'));\n  }\n\nload_demo_argument(){\n   var demo_sadface_doc = \"{\\\"analyst_email\\\":\\\"40170722@live.napier.ac.uk\\\",\\\"analyst_name\\\":\\\"Nathan Mair\\\",\\\"created\\\":\\\"2018-02-23T02:27:36\\\",\\\"edges\\\":[{\\\"id\\\":\\\"a1s1\\\",\\\"source_id\\\":\\\"a1\\\",\\\"target_id\\\":\\\"s1\\\"},{\\\"id\\\":\\\"a2s1\\\",\\\"source_id\\\":\\\"a2\\\",\\\"target_id\\\":\\\"s1\\\"},{\\\"id\\\":\\\"a3s2\\\",\\\"source_id\\\":\\\"a3\\\",\\\"target_id\\\":\\\"s2\\\"},{\\\"id\\\":\\\"s2a5\\\",\\\"source_id\\\":\\\"s2\\\",\\\"target_id\\\":\\\"a5\\\"},{\\\"id\\\":\\\"s1a4\\\",\\\"source_id\\\":\\\"s1\\\",\\\"target_id\\\":\\\"a4\\\"},{\\\"id\\\":\\\"a4s2\\\",\\\"source_id\\\":\\\"a4\\\",\\\"target_id\\\":\\\"s2\\\"}],\\\"edited\\\":\\\"2018-02-23T02:27:36\\\",\\\"id\\\":\\\"94a975db-25ae-4d25-93cc-1c07c932e2f9\\\",\\\"metadata\\\":{},\\\"nodes\\\":[{\\\"id\\\":\\\"a1\\\",\\\"metadata\\\":{},\\\"sources\\\":[],\\\"text\\\":\\\"Every person is going to die\\\",\\\"type\\\":\\\"atom\\\"},{\\\"id\\\":\\\"a2\\\",\\\"metadata\\\":{},\\\"sources\\\":[],\\\"text\\\":\\\"You are a person\\\",\\\"type\\\":\\\"atom\\\"},{\\\"id\\\":\\\"a3\\\",\\\"metadata\\\":{\\\"test\\\":\\\"test\\\"},\\\"sources\\\":[],\\\"text\\\":\\\"If you are going to die then you should treasure every moment\\\",\\\"type\\\":\\\"atom\\\"},{\\\"id\\\":\\\"a4\\\",\\\"metadata\\\":{},\\\"sources\\\":[],\\\"text\\\":\\\"You are going to die\\\",\\\"type\\\":\\\"atom\\\"},{\\\"id\\\":\\\"a5\\\",\\\"metadata\\\":{},\\\"sources\\\":[],\\\"text\\\":\\\"You should treasure every moment\\\",\\\"type\\\":\\\"atom\\\"},{\\\"id\\\":\\\"s1\\\",\\\"name\\\":\\\"Support\\\",\\\"type\\\":\\\"scheme\\\"},{\\\"id\\\":\\\"s2\\\",\\\"name\\\":\\\"Support\\\",\\\"type\\\":\\\"scheme\\\"}],\\\"resources\\\": []}\";\n\n    localStorage.setItem(\"state\",demo_sadface_doc);\n    this.setCyData(export_cytoscape(import_json(demo_sadface_doc)))\n    //this.setState({cy_data: export_cytoscape(import_json(demo_sadface_doc))}, () =>\n    //    console.log(this.state.cy_data, 'cy_data'));\n}\n\n\n\nrender(){\n\n    return (\n    \t<div>\n\n\n\n    \t<Menu \n        //functions\n        toggleResourcePane={this.toggleResourcePane}\n        load_demo_argument={this.load_demo_argument}\n        setFileName={this.setFileName}\n        fileManager={this.fileManager}\n        //state\n        png={this.state.png}\n        jpg={this.state.jpg}\n        fileName = {this.state.fileName}\n        />\n\n        <main id=\"panel\" className=\"panel\">\n\n        <div className=\"ui-container\">\n          <ResourcePane \n            //state\n            tabs={this.state.tabs}\n             // add_tab_to_tab_array = {this.add_tab_to_tab_array}\n             // current_tab = {this.current_tab}\n             // tabs={this.state.tabs}\n             // remove_tab={this.remove_tab}\n              showResourcePane={this.state.showResourcePane}\n             // setActiveTab={this.setActiveTab}\n              fileManager={this.fileManager}\n              change_title={this.change_title}\n              change_content={this.change_content}\n              setType={this.setType}\n              set_focus={this.set_focus}\n              focus = {this.focus}\n              selectedText={this.selectedText}\n              setSelectedText={this.setSelectedText}\n              clearSelection={this.clearSelection}\n              addAtomFromText={this.addAtomFromText}\n\n\n\n         />\n          <div className=\"splitter\" id=\"splitter\">\n          </div>\n\n          <div className=\"visualisation-pane\">\n              <div id=\"navbar\">\n                 \n                  <MenuTrigger\n                    className=\"btn-hamburger toggle-button\"\n                    onClick={this.toggleButton}\n                    showResourcePane={this.state.showResourcePane}\n                    loadDemoArgument={this.loadDemoArgument}\n                  />\n              </div>\n             {/*   <Cytoscape\n                demo = {this.state.demo}\n                setCyData = {this.setCyData} \n                handleSetPng = {this.handleSetPng}\n                handleSetJpg = {this.handleSetJpg}\n                loadJSON = {this.loadJSON}\n                selectedText = {this.state.selectedText}\n                clearSelection ={this.clearSelection}\n                newAtomFromText = {this.state.newAtomFromText}\n                showResourcePane = {this.state.showResourcePane}\n                current_sadface_doc = {this.state.current_sadface_doc}\n                setCurrentSadFaceDoc = {this.setCurrentSadFaceDoc}\n\n                />*/}\n          </div>\n      </div>\n        </main>\n{/*\n        // <MainUI\n        // toggleSlideIn={() => this.toggleButton()}\n        // add_tab_to_tab_array = {this.add_tab_to_tab_array}\n        // tabs = {this.state.tabs}\n        // setType={this.setType}\n        // remove_tab={this.remove_tab}\n        // fileManager={this.fileManager}\n        // showResourcePane={this.state.showResourcePane}\n        // current_tab={this.state.current_tab}\n        // setActiveTab={this.setActiveTab}\n        // fileManager={this.fileManager}\n        // change_title={this.change_title}\n        // change_content={this.change_content}\n        // loadTabs= {this.loadTabs}\n        // cy_data= {this.state.cy_data}\n        // setCyData = {this.setCyData}\n        // loadJSON = {this.loadJSON}\n\n        // handleSetPng={this.handleSetPng}\n        // handleSetJpg={this.handleSetJpg}\n\n        // remove_all_tabs={this.state.remove_all_tabs}\n\n        // update_local_storage={this.state.update_local_storage}\n        // set_focus={this.set_focus}\n        // selectedText={this.state.selectedText}\n        // setSelectedText={this.setSelectedText}\n        // clearSelection={this.clearSelection}\n        // focus={this.state.focus}\n        // addAtomFromText={this.addAtomFromText}\n        // newAtomFromText={this.state.newAtomFromText}\n\n\n\n\n\n        // />\n*/}\n        </div>\n\n        );\n}\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}