{"ast":null,"code":"var _jsxFileName = \"/Users/gareth/Desktop/monkeypuzzle/src/App.js\";\nimport React, { Component } from 'react';\nimport Slideout from 'slideout';\nimport ReactCytoscape from 'react-cytoscape'; //import Components\n\nimport ResourcePane from './Components/ResourcePane';\nimport MainUI from './Components/MainUI';\nimport Menu from './Components/Menu';\nimport Modal from './Components/Modal'; //import Test from './Test';\n\nimport './CSS/monkeypuzzle.css'; //import './CSS/font-awesome.min.css';\n\nimport './CSS/cytoscape-context-menus.css'; //import './CSS/jquery.qtip.min.css';\n//import './CSS/bootstrap.min.css';\n\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport './CSS/App.css'; //import fuctions from SADFACE\n\nimport { get_sd, import_json, add_resource, export_cytoscape, new_uuid, add_resource_metadata } from './lib/Sadface';\n\nclass App extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      tabs: [],\n      last_number: 0,\n      tab_id: \"\",\n      sd: {},\n      showResourcePane: true,\n      test: {},\n      activeTab: 0,\n      cy_data: null,\n      selected: ''\n    };\n    this.test = this.test.bind(this);\n    this.add_tab = this.add_tab.bind(this);\n    this.toggleButton = this.toggleButton.bind(this);\n    this.add_to_tabs_arr = this.add_to_tabs_arr.bind(this);\n    this.remove_tab = this.remove_tab.bind(this);\n    this.download = this.download.bind(this);\n    this.saveSADFace = this.saveSADFace.bind(this);\n    this.update_resource = this.update_resource.bind(this);\n    this.loadSADFace = this.loadSADFace.bind(this);\n    this.loadJSON = this.loadJSON.bind(this);\n    this.remove_all_tabs = this.remove_all_tabs.bind(this);\n    this.loadTabs = this.loadTabs.bind(this);\n    this.get_resource = this.get_resource.bind(this);\n    this.download = this.download.bind(this);\n    this.toggleResourcePane = this.toggleResourcePane.bind(this);\n    this.mp_reset = this.mp_reset.bind(this);\n    this.clear_local_storage = this.clear_local_storage.bind(this);\n    this.set_analyst_name = this.set_analyst_name.bind(this);\n    this.set_analyst_email = this.set_analyst_email.bind(this);\n    this.download_sadface = this.download_sadface.bind(this);\n    this.download_png = this.download_png.bind(this);\n    this.download_jpg = this.download_jpg.bind(this);\n    this.add_resource_metadata = this.add_resource_metadata.bind(this);\n    this.setActiveTab = this.setActiveTab.bind(this);\n    this.download = this.download.bind(this); //ResourcePane Functions\n\n    this.change_title = this.change_title.bind(this);\n    this.set_text_resource_content = this.set_text_resource_content.bind(this);\n    this.add_resource_header = this.add_resource_header.bind(this);\n    this.nextNumber = this.nextNumber.bind(this); //slide in\n\n    this.loadDemoArgument = this.loadDemoArgument.bind(this);\n  }\n\n  add_to_tabs_arr(tab_id) {\n    this.setState(state => {\n      const tabs = state.tabs.concat(tab_id);\n      return {\n        tabs\n      };\n    }, function () {\n      console.log(\"tabs\");\n    }.bind(this));\n  }\n\n  openAddBoardModal() {\n    this.setState({\n      boardAddModalShow: true\n    }, function () {\n      console.log(this.state.boardAddModalShow);\n    });\n  }\n\n  createNewTab() {}\n\n  next_number() {\n    var current_number = this.state.last_number;\n    this.setState({\n      last_number: this.state.last_number + 1\n    });\n    return current_number;\n  }\n\n  add_tab(load_id = null) {\n    let newTab = {};\n\n    if (load_id == null) {\n      var new_resource = add_resource(' ');\n      newTab.tab_id = new_resource.id;\n      add_resource_metadata(newTab.tab_id, 'title', '');\n      localStorage.setItem(\"state\", JSON.stringify(get_sd()));\n    } else {\n      newTab.tab_id = load_id;\n    }\n\n    this.add_resource_header(newTab); //  set_active_tab(tab_id+\"_body\");\n    // return this.state.tab_id\n    //SetState with callback ensures updated value is used\n\n    /*\n    this.setState(state => {\n            const tabs = state.tabs.concat(newTab);\n            return {\n                tabs,\n            }}, function () {\n                console.log(this.state.tabs.length);\n                length = this.state.tabs.length;\n                length = length -1;\n                console.log(\"llength\" +length);\n                this.setActiveTab(length);\n    \n            }        );\n    \n             */\n  }\n\n  add_resource_header(newTab) {\n    let tab_number = 33333;\n    tab_number = this.nextNumber();\n    console.log(tab_number, 'tab head');\n    newTab.tab_number = tab_number;\n    this.setState(state => {\n      const tabs = this.state.tabs.concat(newTab);\n      return {\n        tabs\n      };\n    }, function () {\n      console.log(this.state.tabs, 'header');\n    });\n  }\n\n  nextNumber() {\n    let num = 555;\n    console.log(num, '555');\n    this.setState({\n      last_number: this.state.last_number + 1\n    }, function () {\n      console.log(this.state.last_number, 'next');\n      num = this.state.last_number;\n      console.log(num, 'num');\n      return num;\n    });\n  }\n\n  test(index) {\n    this.setState({\n      activeTab: index\n    });\n    console.log(this.activeTab);\n  }\n\n  setActiveTab(value) {\n    this.setState({\n      activeTab: value\n    }, function () {\n      console.log(this.state.activeTab);\n    });\n  }\n\n  add_resource_metadata(resource_id, key, value) {\n    /*\n    Add metadata, a key:value pair to the resource dict identified\n    by the supplied atom ID.    \n    */\n    if (resource_id && key && value) {\n      this.sate.sd.resources.forEach(function (res) {\n        if (res.id === resource_id) {\n          res.metadata[key] = value;\n        }\n      });\n    }\n  }\n\n  new_resource(content) {\n    /*\n    Given the supplied content (String), create a new resource dict\n     The arguments that SADFace describes are either constructed directly in a tool that writes\n    them to this format, or else are sourced from elsewhere, e.g. an argumentative text or\n    webpage, or else perhaps another medium, such as audio or video. Currently SADFace supports\n    textual resources which are stored in the content key. Optionally a \n        \"url\":\"some web location\"\n    pair can be added to the metadata to indicate a specific web location. Alternatively:\n        \"doi\":\"digital object identifier\" - resolvable by dx.doi.org\n        \"magnet-link\":\"a torrent file\"\n        \"isbn\":\"for books\"\n    Metadata may also store additional bibliographic or referencing/citation information\n    as defined in bibtex formats.\n     Returns: A dict representing the new SADFace resource\n    */\n    if (content) {\n      var new_resource = {\n        \"id\": this.new_uuid(),\n        \"content\": content,\n        \"type\": \"text\",\n        \"metadata\": {}\n      };\n      return new_resource;\n    }\n  }\n\n  componentDidMount() {\n    this.slideout = new Slideout({\n      'panel': document.getElementById('panel'),\n      'menu': document.getElementById('menu'),\n      \"fx\": \"ease\",\n      \"side\": \"right\",\n      \"duration\": 500,\n      \"padding\": 256,\n      \"tolerance\": 70\n    });\n  }\n\n  remove_tab(i) {\n    this.setState(state => {\n      const tabs = state.tabs.filter((item, j) => i !== j);\n      return {\n        tabs\n      };\n    });\n    /*\n        delete_resource(current_tab);\n        sd.nodes.forEach((node) => {\n            if (node.type == 'atom') {\n                if (current_tab in node.sources) {\n                    delete_source(node.id, current_tab);\n                }\n            }\n        });\n        \n        localStorage.setItem(\"state\",JSON.stringify(get_sd()));\n        if (tabs.length >= 1 && idx != -1)\n        {\n            tabs.splice(idx, 1);\n            current_tab = tabs[tabs.length-1];\n            set_active_tab(current_tab+\"_body\");\n        }\n    */\n  }\n\n  remove_all_tabs() {\n    this.setState({\n      tabs: []\n    });\n    this.setState({\n      last_number: 1\n    });\n  }\n\n  toggleButton() {\n    this.slideout.toggle();\n  }\n\n  download(filename, text) {}\n\n  fileManager(operation, filetype, tab_id) {\n    /*\n    Write text from tab to file or does a SADFace save operation\n    */\n    console.log(operation, filetype, tab_id);\n\n    if (\"save\" == operation) {\n      // if it's a txt file\n      if (\"txt\" == filetype) {\n        if (document.getElementById(\"title_\" + tab_id).value !== '') {\n          var filename = document.getElementById(\"title_\" + tab_id).value + \".txt\";\n        } else {\n          var filename = \"tab\" + tab_id + \"_text.txt\";\n        }\n\n        var text = document.getElementById(tab_id).value;\n        this.download(filename, text);\n      } // if it's a JSON file\n\n\n      if (\"json\" == filetype) {\n        var filename = document.getElementById(\"export_filename\").value;\n\n        if (filename.length == 0) {\n          filename = \"default\";\n        }\n\n        this.saveSADFace(filename, filetype);\n      }\n    } //if it's a load operation\n\n\n    if (\"load\" == operation) {\n      // if it's a txt file\n      if (\"txt\" == filetype) {\n        var files = document.getElementById(\"load\" + tab_id).files;\n        var file = files[0];\n        var filename = file.name;\n        document.getElementById(\"title_\" + tab_id).innerText = filename;\n        console.log(file.name);\n        var reader = new FileReader();\n\n        reader.onload = function (e) {\n          var content = reader.result;\n          document.getElementById(tab_id).innerText = content;\n          this.update_resource(tab_id, content, filename);\n        };\n\n        reader.readAsText(file);\n      } // if it's a JSON file\n\n\n      if (\"json\" == filetype) {\n        var files = document.getElementById(\"loadJSON\").files;\n        var file = files[0];\n        var reader = this.loadSADFace(file);\n\n        reader.onload = function (e) {\n          var result = reader.result;\n          localStorage.setItem(\"state\", result);\n          this.loadJSON(result);\n          var json = JSON.parse(result);\n          this.remove_all_tabs();\n          this.loadTabs(json.resources);\n        };\n      }\n    }\n  }\n\n  download(filename, text) {\n    /*\n    Downloads a file given its filename and its text using utf-8 charset\n    */\n    console.log(\"Downloading \" + filename);\n    var outfile = document.createElement(\"a\");\n    outfile.setAttribute(\"href\", \"data:text/plain;charset=utf-8,\" + encodeURIComponent(text));\n    outfile.setAttribute(\"download\", filename);\n    outfile.style.display = \"none\";\n    document.body.appendChild(outfile);\n    outfile.click();\n    document.body.removeChild(outfile);\n  }\n\n  get_resource(resource_id) {\n    /*\n    Retrieve the resource dict identified by the supplied resource ID\n     Returns: An resource dict\n    */\n    if (resource_id) {\n      var resource;\n      const index = this.state.tabs.findIndex(tab => tab.tab_id === resource_id);\n      const tabs = [...this.state.tabs];\n      resource = tabs[index];\n      return resource;\n    }\n  }\n\n  isTab_id(tab) {\n    return tab.tab_id;\n  }\n\n  loadTabs() {}\n\n  saveSADFace() {}\n\n  loadSADFace() {}\n\n  loadJSON() {}\n\n  loadTabs(tabs) {\n    this.state.tabs.forEach(function (tab) {\n      this.load_tab(tab);\n    });\n  }\n\n  load_tab(resource) {\n    if (resource != null) {\n      var tab_id = resource.id;\n      this.add_tab(tab_id);\n      this.set_text_resource_title(tab_id, resource.metadata.title);\n      this.set_text_resource_content(tab_id, resource.content);\n    }\n  }\n\n  update_resource(resource_id, content, title) {\n    /*\n    Given an ID for an existing resource, update the content and metadata of the resource.\n    Updates the resource in sd;\n    */\n    if (resource_id && (content || title)) {\n      console.log(\"update resource\");\n      var resource;\n      const index = this.state.tabs.findIndex(tab => tab.tab_id === resource_id);\n      const tabs = [...this.state.tabs];\n      resource = tabs[index];\n\n      if (resource !== null && resource !== undefined) {\n        if (content !== null && content !== undefined) {\n          resource.content = content;\n        }\n\n        if (title !== null && title !== undefined) {\n          resource.title = title;\n        }\n        /*  this.state.sd.resources.forEach((res) => {\n              if(res.id === resource_id) {\n                  res = resource;\n              }\n          });*/\n\n      } else {\n        throw \"Could not update the resource: \" + resource_id;\n      }\n\n      this.setState({\n        tabs\n      }, () => {\n        console.log(\"update tabs\");\n      });\n    }\n  } //Resource Pane Functions\n\n\n  change_title(tab_id, val) {\n    console.log(\"change title\" + tab_id + val);\n    this.set_text_resource_title(tab_id, val);\n  }\n\n  set_text_resource_title(tab_id, title) {\n    console.log(\"set text resource title\" + tab_id + title);\n    this.update_resource(tab_id, null, title); //    this.update_local_storage();\n  }\n\n  change_content(tab_id, val) {\n    console.log(\"change content\" + tab_id + val);\n    this.set_text_resource_content(tab_id, val);\n  }\n\n  set_text_resource_content(tab_id, text) {\n    this.update_resource(tab_id, text, null); //update_local_storage();\n  } // Slide In Functions\n\n\n  toggleResourcePane() {\n    this.setState({\n      showResourcePane: !this.state.showResourcePane\n    });\n  }\n\n  mp_reset() {\n    this.clear_local_storage();\n  }\n\n  clear_local_storage() {\n    localStorage.clear();\n    window.location.reload(false);\n  }\n\n  set_analyst_name() {\n    console.log(\"set_analyst_name\");\n  }\n\n  set_analyst_email() {\n    console.log(\"set_analyst_email\");\n  }\n\n  download_sadface() {\n    console.log(\"download_sadface\");\n  }\n\n  download_png() {\n    console.log(\"download_png\");\n  }\n\n  download_jpg() {\n    console.log(\"download_jpg\");\n  }\n\n  loadDemoArgument() {\n    console.log('load demo');\n    var elements = [// list of graph elements to start with\n    {\n      // node a\n      data: {\n        id: 'a'\n      }\n    }, {\n      // node b\n      data: {\n        id: 'b'\n      }\n    }, {\n      // edge ab\n      data: {\n        id: 'ab',\n        source: 'a',\n        target: 'b'\n      }\n    }];\n    var demo_sadface_doc = \"{\\\"analyst_email\\\":\\\"40170722@live.napier.ac.uk\\\",\\\"analyst_name\\\":\\\"Nathan Mair\\\",\\\"created\\\":\\\"2018-02-23T02:27:36\\\",\\\"edges\\\":[{\\\"id\\\":\\\"a1s1\\\",\\\"source_id\\\":\\\"a1\\\",\\\"target_id\\\":\\\"s1\\\"},{\\\"id\\\":\\\"a2s1\\\",\\\"source_id\\\":\\\"a2\\\",\\\"target_id\\\":\\\"s1\\\"},{\\\"id\\\":\\\"a3s2\\\",\\\"source_id\\\":\\\"a3\\\",\\\"target_id\\\":\\\"s2\\\"},{\\\"id\\\":\\\"s2a5\\\",\\\"source_id\\\":\\\"s2\\\",\\\"target_id\\\":\\\"a5\\\"},{\\\"id\\\":\\\"s1a4\\\",\\\"source_id\\\":\\\"s1\\\",\\\"target_id\\\":\\\"a4\\\"},{\\\"id\\\":\\\"a4s2\\\",\\\"source_id\\\":\\\"a4\\\",\\\"target_id\\\":\\\"s2\\\"}],\\\"edited\\\":\\\"2018-02-23T02:27:36\\\",\\\"id\\\":\\\"94a975db-25ae-4d25-93cc-1c07c932e2f9\\\",\\\"metadata\\\":{},\\\"nodes\\\":[{\\\"id\\\":\\\"a1\\\",\\\"metadata\\\":{},\\\"sources\\\":[],\\\"text\\\":\\\"Every person is going to die\\\",\\\"type\\\":\\\"atom\\\"},{\\\"id\\\":\\\"a2\\\",\\\"metadata\\\":{},\\\"sources\\\":[],\\\"text\\\":\\\"You are a person\\\",\\\"type\\\":\\\"atom\\\"},{\\\"id\\\":\\\"a3\\\",\\\"metadata\\\":{\\\"test\\\":\\\"test\\\"},\\\"sources\\\":[],\\\"text\\\":\\\"If you are going to die then you should treasure every moment\\\",\\\"type\\\":\\\"atom\\\"},{\\\"id\\\":\\\"a4\\\",\\\"metadata\\\":{},\\\"sources\\\":[],\\\"text\\\":\\\"You are going to die\\\",\\\"type\\\":\\\"atom\\\"},{\\\"id\\\":\\\"a5\\\",\\\"metadata\\\":{},\\\"sources\\\":[],\\\"text\\\":\\\"You should treasure every moment\\\",\\\"type\\\":\\\"atom\\\"},{\\\"id\\\":\\\"s1\\\",\\\"name\\\":\\\"Support\\\",\\\"type\\\":\\\"scheme\\\"},{\\\"id\\\":\\\"s2\\\",\\\"name\\\":\\\"Support\\\",\\\"type\\\":\\\"scheme\\\"}],\\\"resources\\\": []}\";\n    localStorage.setItem(\"state\", demo_sadface_doc);\n    var cy_data = export_cytoscape(import_json(demo_sadface_doc)); // initCytoscape();\n\n    var elements = JSON.parse(cy_data);\n    console.log(elements);\n    this.setState({\n      cy_data: elements\n    }, () => console.log(this.state.cy_data));\n    console.log(this.state.cy_data);\n  }\n\n  render() {\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 569\n      },\n      __self: this\n    }, React.createElement(Menu, {\n      toggleResourcePane: this.toggleResourcePane,\n      mp_reset: this.mp_reset,\n      loadDemoArgument: this.loadDemoArgument,\n      set_analyst_name: this.set_analyst_name,\n      set_analyst_email: this.set_analyst_email,\n      download_sadface: this.download_sadface,\n      download_png: this.download_png,\n      download_jpg: this.download_jpg,\n      fileManager: this.fileManager,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 573\n      },\n      __self: this\n    }), React.createElement(MainUI, {\n      toggleSlideIn: () => this.toggleButton(),\n      addTab: () => this.add_tab(),\n      tabs: this.state.tabs,\n      remove_tab: this.remove_tab,\n      fileManager: this.fileManager,\n      showResourcePane: this.state.showResourcePane,\n      activeTab: this.state.activeTab,\n      setActiveTab: this.setActiveTab,\n      fileManager: this.fileManager,\n      change_title: this.change_title,\n      change_content: this.change_content,\n      new_uuid: this.new_uuid,\n      loadTabs: this.loadTabs,\n      cy_data: this.state.cy_data,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 586\n      },\n      __self: this\n    }));\n  }\n\n}\n\nexport default App;","map":{"version":3,"sources":["/Users/gareth/Desktop/monkeypuzzle/src/App.js"],"names":["React","Component","Slideout","ReactCytoscape","ResourcePane","MainUI","Menu","Modal","get_sd","import_json","add_resource","export_cytoscape","new_uuid","add_resource_metadata","App","constructor","props","state","tabs","last_number","tab_id","sd","showResourcePane","test","activeTab","cy_data","selected","bind","add_tab","toggleButton","add_to_tabs_arr","remove_tab","download","saveSADFace","update_resource","loadSADFace","loadJSON","remove_all_tabs","loadTabs","get_resource","toggleResourcePane","mp_reset","clear_local_storage","set_analyst_name","set_analyst_email","download_sadface","download_png","download_jpg","setActiveTab","change_title","set_text_resource_content","add_resource_header","nextNumber","loadDemoArgument","setState","concat","console","log","openAddBoardModal","boardAddModalShow","createNewTab","next_number","current_number","load_id","newTab","new_resource","id","localStorage","setItem","JSON","stringify","tab_number","num","index","value","resource_id","key","sate","resources","forEach","res","metadata","content","componentDidMount","slideout","document","getElementById","i","filter","item","j","toggle","filename","text","fileManager","operation","filetype","length","files","file","name","innerText","reader","FileReader","onload","e","result","readAsText","json","parse","outfile","createElement","setAttribute","encodeURIComponent","style","display","body","appendChild","click","removeChild","resource","findIndex","tab","isTab_id","load_tab","set_text_resource_title","title","undefined","val","change_content","clear","window","location","reload","elements","data","source","target","demo_sadface_doc","render"],"mappings":"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","sourcesContent":["import React, {Component} from 'react';\nimport Slideout from 'slideout';\nimport ReactCytoscape from 'react-cytoscape';\n\n//import Components\nimport ResourcePane from './Components/ResourcePane';\nimport MainUI from './Components/MainUI';\nimport Menu from './Components/Menu';\n\nimport Modal from './Components/Modal';\n\n\n//import Test from './Test';\n\n\nimport './CSS/monkeypuzzle.css';\n//import './CSS/font-awesome.min.css';\nimport './CSS/cytoscape-context-menus.css';\n//import './CSS/jquery.qtip.min.css';\n//import './CSS/bootstrap.min.css';\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport './CSS/App.css';\n\n\n//import fuctions from SADFACE\n\nimport {get_sd,import_json, add_resource, export_cytoscape, new_uuid,add_resource_metadata} from './lib/Sadface'; \n\n\n\n\n\nclass App extends Component{\n\tconstructor(props){\n\t\tsuper(props);\n\t\tthis.state = {\n\t\t\ttabs: [],\n\t\t\tlast_number: 0,\n\t\t\ttab_id:\"\",\n            sd: {},\n            showResourcePane: true,\n            test:{},\n            activeTab: 0,\n            cy_data: null,\n            selected: '',\n\n\n\n\n\n\t\t};\n        this.test = this.test.bind(this);\n\t\tthis.add_tab = this.add_tab.bind(this);\n\t\tthis.toggleButton = this.toggleButton.bind(this);\n\t\tthis.add_to_tabs_arr =this.add_to_tabs_arr.bind(this);\n        this.remove_tab =this.remove_tab.bind(this);\n        this.download = this.download.bind(this);\n        this.saveSADFace = this.saveSADFace.bind(this);\n        this.update_resource =this.update_resource.bind(this);\n        this.loadSADFace =this.loadSADFace.bind(this);\n        this.loadJSON = this.loadJSON.bind(this);\n        this.remove_all_tabs = this.remove_all_tabs.bind(this);\n        this.loadTabs =this.loadTabs.bind(this);\n        this.get_resource =this.get_resource.bind(this);\n        this.download = this.download.bind(this);\n        this.toggleResourcePane =this.toggleResourcePane.bind(this);\n        this.mp_reset =this.mp_reset.bind(this);\n        this.clear_local_storage = this.clear_local_storage.bind(this);\n        this.set_analyst_name = this.set_analyst_name.bind(this);\n        this.set_analyst_email =this.set_analyst_email.bind(this);\n        this.download_sadface =this.download_sadface.bind(this);\n        this.download_png =this.download_png.bind(this);\n        this.download_jpg = this.download_jpg.bind(this);\n        this.add_resource_metadata =this.add_resource_metadata.bind(this);\n        this.setActiveTab = this.setActiveTab.bind(this);\n        this.download = this.download.bind(this);\n\n        //ResourcePane Functions\n        this.change_title = this.change_title.bind(this);\n        this.set_text_resource_content = this.set_text_resource_content.bind(this);\n        this.add_resource_header = this.add_resource_header.bind(this);\n        this.nextNumber = this.nextNumber.bind(this);\n\n        //slide in\n        this.loadDemoArgument = this.loadDemoArgument.bind(this);\n\n\n\t}\n\n\n\n\n\n\n\n\n\nadd_to_tabs_arr(tab_id){\n\tthis.setState(state => {\n\t\tconst tabs = state.tabs.concat(tab_id);\n\t\treturn {\n\t\t\ttabs,\n\t\t}}, function () {\n            console.log(\"tabs\");\n        }.bind(this));\n\t\n}\nopenAddBoardModal(){\n        this.setState({ boardAddModalShow: true }, function () {\n             console.log(this.state.boardAddModalShow);\n        });\n\n}\n\ncreateNewTab(){\n}\n\n next_number(){\n \t var current_number = this.state.last_number\n \t this.setState({ last_number: this.state.last_number + 1})\n \t return current_number;\n }\n\n \t\n\n\t\n\n\tadd_tab(load_id=null){\n        let newTab = {};\n\t\tif (load_id == null) {\n            var new_resource = add_resource(' ');\n            newTab.tab_id = new_resource.id;\n            add_resource_metadata(newTab.tab_id, 'title', '');\n            localStorage.setItem(\"state\", JSON.stringify(get_sd()));\n        }else{ newTab.tab_id = load_id; }\n\n        this.add_resource_header(newTab);\n    \n\n         \n  //  set_active_tab(tab_id+\"_body\");\n   // return this.state.tab_id\n\n//SetState with callback ensures updated value is used\n/*\nthis.setState(state => {\n        const tabs = state.tabs.concat(newTab);\n        return {\n            tabs,\n        }}, function () {\n            console.log(this.state.tabs.length);\n            length = this.state.tabs.length;\n            length = length -1;\n            console.log(\"llength\" +length);\n            this.setActiveTab(length);\n\n        }        );\n\n         */    \n        \n    }\n    \n    add_resource_header(newTab){\n        \n        let tab_number = 33333;\n        tab_number = this.nextNumber();\n        console.log(tab_number, 'tab head');\n        newTab.tab_number = tab_number;\n        this.setState(state => {\n            const tabs = this.state.tabs.concat(newTab);\n            return {\n                tabs,\n            }}, function (){\n                console.log(this.state.tabs, 'header');\n            }\n            )\n            }\n   \n\n    nextNumber(){\n        let num = 555;\n        console.log(num, '555');\n      this.setState({ last_number: this.state.last_number + 1 }, function (){\n        console.log(this.state.last_number, 'next');\n         num = this.state.last_number;\n        console.log(num, 'num');\n        return num;\n      });\n     \n        \n        \n    }\n\n\n\n    test(index) {\n        this.setState({\n            activeTab: index\n        });\n        console.log(this.activeTab);\n    }\n\n setActiveTab(value){\n    this.setState({\n        activeTab: value\n    }, function (){\n        console.log(this.state.activeTab);\n    });\n   \n\n\n}\n\n    add_resource_metadata(resource_id, key, value) {\n    /*\n    Add metadata, a key:value pair to the resource dict identified\n    by the supplied atom ID.    \n    */\n    if (resource_id && key && value) {\n        this.sate.sd.resources.forEach(function(res) {\n            if(res.id === resource_id) {\n                res.metadata[key] = value;\n            }\n        });\n    }\n}\n\n\n\n\t new_resource(content) {\n    /*\n    Given the supplied content (String), create a new resource dict\n\n    The arguments that SADFace describes are either constructed directly in a tool that writes\n    them to this format, or else are sourced from elsewhere, e.g. an argumentative text or\n    webpage, or else perhaps another medium, such as audio or video. Currently SADFace supports\n    textual resources which are stored in the content key. Optionally a \n        \"url\":\"some web location\"\n    pair can be added to the metadata to indicate a specific web location. Alternatively:\n        \"doi\":\"digital object identifier\" - resolvable by dx.doi.org\n        \"magnet-link\":\"a torrent file\"\n        \"isbn\":\"for books\"\n    Metadata may also store additional bibliographic or referencing/citation information\n    as defined in bibtex formats.\n\n    Returns: A dict representing the new SADFace resource\n    */\n    if (content) {\n        var new_resource = {\"id\":this.new_uuid(), \"content\":content, \"type\":\"text\", \"metadata\":{}};\n        return new_resource;\n    }\n}\n\n\n\n\n\n\n\n \tcomponentDidMount() {\n  \tthis.slideout = new Slideout({\n    'panel': document.getElementById('panel'),\n    'menu': document.getElementById('menu'),\n    \"fx\": \"ease\",\n    \"side\": \"right\",\n    \"duration\": 500,\n    \"padding\": 256,\n    \"tolerance\": 70,\n\n  });\n}\n\nremove_tab(i){\n    this.setState(state =>{\n        const tabs = state.tabs.filter((item, j) => i !==j);\n        return {\n            tabs,\n        };\n    });\n/*\n    delete_resource(current_tab);\n    sd.nodes.forEach((node) => {\n        if (node.type == 'atom') {\n            if (current_tab in node.sources) {\n                delete_source(node.id, current_tab);\n            }\n        }\n    });\n    \n    localStorage.setItem(\"state\",JSON.stringify(get_sd()));\n    if (tabs.length >= 1 && idx != -1)\n    {\n        tabs.splice(idx, 1);\n        current_tab = tabs[tabs.length-1];\n        set_active_tab(current_tab+\"_body\");\n    }\n*/\n};\n\nremove_all_tabs(){\n    this.setState({tabs: []});\n    this.setState({last_number:1});\n\n\n}\n\n\n\n\ntoggleButton(){\n        this.slideout.toggle();\n\t}\n\n\n\ndownload(filename,text){\n\n}\n\n    fileManager(operation, filetype, tab_id) {\n    /*\n    Write text from tab to file or does a SADFace save operation\n    */\n\n    console.log(operation, filetype, tab_id);\n   if (\"save\" == operation)    {\n        // if it's a txt file\n        if (\"txt\" == filetype) {    \n            if (document.getElementById(\"title_\"+tab_id).value !== '') {\n                var filename = document.getElementById(\"title_\"+tab_id).value+\".txt\";\n            } else {\n                var filename = \"tab\"+tab_id+\"_text.txt\";\n            }\n            var text = document.getElementById(tab_id).value;\n            this.download(filename,text);\n        }\n        \n        // if it's a JSON file\n        if (\"json\" == filetype) {\n            var filename = document.getElementById(\"export_filename\").value;\n            if(filename.length == 0){ filename = \"default\"}\n            this.saveSADFace(filename, filetype);\n        }\n    }\n    \n    //if it's a load operation\n    if (\"load\" == operation) {\n        // if it's a txt file\n        if (\"txt\" == filetype) {\n            var files = document.getElementById(\"load\"+tab_id).files;\n            var file = files[0];\n            var filename = file.name;\n            document.getElementById(\"title_\"+tab_id).innerText = filename;\n            console.log(file.name);\n            var reader = new FileReader();      \n            reader.onload = function(e) {\n                var content = reader.result;\n                document.getElementById(tab_id).innerText = content;\n                this.update_resource(tab_id, content, filename);\n            }\n            reader.readAsText(file);\n        }\n        // if it's a JSON file\n        if (\"json\" == filetype) {\n            var files = document.getElementById(\"loadJSON\").files;\n            var file = files[0];\n            var reader = this.loadSADFace(file);\n            reader.onload = function(e) {\n                var result = reader.result;\n                localStorage.setItem(\"state\",result);\n                this.loadJSON(result);\n                var json = JSON.parse(result);\n                this.remove_all_tabs();\n                this.loadTabs(json.resources);\n            }\n        }\n    }\n}\n\ndownload(filename, text) {\n    /*\n    Downloads a file given its filename and its text using utf-8 charset\n    */\n    console.log(\"Downloading \"+filename);\n    var outfile = document.createElement(\"a\");\n    outfile.setAttribute(\"href\", \"data:text/plain;charset=utf-8,\" + encodeURIComponent(text));\n    outfile.setAttribute(\"download\", filename);\n\n    outfile.style.display = \"none\";\n    document.body.appendChild(outfile);\n\n    outfile.click();\n\n    document.body.removeChild(outfile);\n}\n\n\nget_resource(resource_id){\n    /*\n    Retrieve the resource dict identified by the supplied resource ID\n\n    Returns: An resource dict\n    */\n    if(resource_id){\n        var resource;\n        const index = this.state.tabs.findIndex((tab) => tab.tab_id === resource_id);\n        const tabs = [...this.state.tabs]\n        resource = tabs[index];\n        return resource;\n    }\n}\n\nisTab_id(tab){\n    return tab.tab_id\n}\nloadTabs(){\n\n}\n\nsaveSADFace(){\n\n}\n\nloadSADFace(){\n\n}\n\nloadJSON(){\n\n}\n\nloadTabs(tabs) {\n    this.state.tabs.forEach(function(tab) {\n       this.load_tab(tab);\n    });\n}\n\nload_tab(resource) {\n    if (resource != null) {\n        var tab_id = resource.id;\n        this.add_tab(tab_id);\n        this.set_text_resource_title(tab_id, resource.metadata.title);\n        this.set_text_resource_content(tab_id, resource.content);\n    }\n}\n\nupdate_resource(resource_id, content, title) {\n    /*\n    Given an ID for an existing resource, update the content and metadata of the resource.\n    Updates the resource in sd;\n    */\n    \n\n    if (resource_id && (content || title)) {\n        console.log(\"update resource\");\n\n        var resource;\n        const index = this.state.tabs.findIndex((tab) => tab.tab_id === resource_id);\n        const tabs = [...this.state.tabs]\n        resource = tabs[index];\n\n        if (resource !== null && resource !== undefined) {\n            if (content !== null && content !== undefined) {\n                resource.content = content;\n            }\n            if (title !== null && title !== undefined) {\n                resource.title = title;\n            }\n          /*  this.state.sd.resources.forEach((res) => {\n                if(res.id === resource_id) {\n                    res = resource;\n                }\n            });*/\n        } else {\n            throw (\"Could not update the resource: \"+resource_id);\n        }\n        this.setState({tabs}, () =>{\n            console.log(\"update tabs\");\n        });\n    }\n}\n\n//Resource Pane Functions\nchange_title(tab_id, val) {\n    console.log(\"change title\" +tab_id+val);\n    this.set_text_resource_title(tab_id, val)\n}\n\nset_text_resource_title(tab_id, title){\nconsole.log(\"set text resource title\" +tab_id + title)\n    this.update_resource(tab_id, null, title);\n//    this.update_local_storage();\n}\n\nchange_content(tab_id, val){\n    console.log(\"change content\" + tab_id + val);\n    this.set_text_resource_content(tab_id, val);\n}\n\nset_text_resource_content(tab_id, text){\n    this.update_resource(tab_id, text, null);\n    //update_local_storage();\n}\n\n// Slide In Functions\ntoggleResourcePane(){\n    this.setState({showResourcePane: !this.state.showResourcePane})\n}\nmp_reset()\n{\n    this.clear_local_storage();\n}\n\nclear_local_storage() {\n    localStorage.clear();\n    window.location.reload(false);\n}\n\n\n\nset_analyst_name(){\n    console.log(\"set_analyst_name\");\n}\n\nset_analyst_email(){\n    console.log(\"set_analyst_email\");\n}\n\ndownload_sadface(){\n    console.log(\"download_sadface\")\n}\n\ndownload_png(){\n    console.log(\"download_png\");\n}\n\ndownload_jpg(){\n    console.log(\"download_jpg\");\n}\n\nloadDemoArgument(){\n    console.log('load demo');\n    var elements = [ // list of graph elements to start with\n    { // node a\n      data: { id: 'a' }\n    },\n    { // node b\n      data: { id: 'b' }\n    },\n    { // edge ab\n      data: { id: 'ab', source: 'a', target: 'b' }\n    }\n  ];\n    var demo_sadface_doc = \"{\\\"analyst_email\\\":\\\"40170722@live.napier.ac.uk\\\",\\\"analyst_name\\\":\\\"Nathan Mair\\\",\\\"created\\\":\\\"2018-02-23T02:27:36\\\",\\\"edges\\\":[{\\\"id\\\":\\\"a1s1\\\",\\\"source_id\\\":\\\"a1\\\",\\\"target_id\\\":\\\"s1\\\"},{\\\"id\\\":\\\"a2s1\\\",\\\"source_id\\\":\\\"a2\\\",\\\"target_id\\\":\\\"s1\\\"},{\\\"id\\\":\\\"a3s2\\\",\\\"source_id\\\":\\\"a3\\\",\\\"target_id\\\":\\\"s2\\\"},{\\\"id\\\":\\\"s2a5\\\",\\\"source_id\\\":\\\"s2\\\",\\\"target_id\\\":\\\"a5\\\"},{\\\"id\\\":\\\"s1a4\\\",\\\"source_id\\\":\\\"s1\\\",\\\"target_id\\\":\\\"a4\\\"},{\\\"id\\\":\\\"a4s2\\\",\\\"source_id\\\":\\\"a4\\\",\\\"target_id\\\":\\\"s2\\\"}],\\\"edited\\\":\\\"2018-02-23T02:27:36\\\",\\\"id\\\":\\\"94a975db-25ae-4d25-93cc-1c07c932e2f9\\\",\\\"metadata\\\":{},\\\"nodes\\\":[{\\\"id\\\":\\\"a1\\\",\\\"metadata\\\":{},\\\"sources\\\":[],\\\"text\\\":\\\"Every person is going to die\\\",\\\"type\\\":\\\"atom\\\"},{\\\"id\\\":\\\"a2\\\",\\\"metadata\\\":{},\\\"sources\\\":[],\\\"text\\\":\\\"You are a person\\\",\\\"type\\\":\\\"atom\\\"},{\\\"id\\\":\\\"a3\\\",\\\"metadata\\\":{\\\"test\\\":\\\"test\\\"},\\\"sources\\\":[],\\\"text\\\":\\\"If you are going to die then you should treasure every moment\\\",\\\"type\\\":\\\"atom\\\"},{\\\"id\\\":\\\"a4\\\",\\\"metadata\\\":{},\\\"sources\\\":[],\\\"text\\\":\\\"You are going to die\\\",\\\"type\\\":\\\"atom\\\"},{\\\"id\\\":\\\"a5\\\",\\\"metadata\\\":{},\\\"sources\\\":[],\\\"text\\\":\\\"You should treasure every moment\\\",\\\"type\\\":\\\"atom\\\"},{\\\"id\\\":\\\"s1\\\",\\\"name\\\":\\\"Support\\\",\\\"type\\\":\\\"scheme\\\"},{\\\"id\\\":\\\"s2\\\",\\\"name\\\":\\\"Support\\\",\\\"type\\\":\\\"scheme\\\"}],\\\"resources\\\": []}\";\n\n    localStorage.setItem(\"state\",demo_sadface_doc);\n    var cy_data = export_cytoscape(import_json(demo_sadface_doc));\n   // initCytoscape();\n   var elements = JSON.parse(cy_data);\n   console.log(elements);\n   this.setState({cy_data: elements}, () => console.log(this.state.cy_data))\n   console.log(this.state.cy_data);\n  }\n\n \n  render(){\n\n    return (\n    \t<div>\n   \n      \n        \n    \t<Menu \n            toggleResourcePane={this.toggleResourcePane}\n            mp_reset={this.mp_reset}\n            loadDemoArgument={this.loadDemoArgument}\n            set_analyst_name={this.set_analyst_name}\n            set_analyst_email={this.set_analyst_email}\n            download_sadface={this.download_sadface}\n            download_png={this.download_png}\n            download_jpg={this.download_jpg}\n            fileManager={this.fileManager}\n\n        />\n\n\t\t\t<MainUI\n\t\t\t   toggleSlideIn={() => this.toggleButton()}\n\t\t\t   addTab = {() => this.add_tab()}\n\t\t\t   tabs = {this.state.tabs}\n               remove_tab={this.remove_tab}\n               fileManager={this.fileManager}\n               showResourcePane={this.state.showResourcePane}\n              activeTab={this.state.activeTab}\n              setActiveTab={this.setActiveTab}\n              fileManager={this.fileManager}\n              change_title={this.change_title}\n              change_content={this.change_content}\n              new_uuid = {this.new_uuid}\n              loadTabs= {this.loadTabs}\n              cy_data= {this.state.cy_data}\n               \n\n\n\t\t\t/>\n \n   </div>\n\n      );\n  }\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}