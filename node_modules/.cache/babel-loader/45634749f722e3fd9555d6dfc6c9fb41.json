{"ast":null,"code":"var _jsxFileName = \"/Users/gareth/Desktop/monkeypuzzle/src/Components/CytoContainer.js\";\nimport React, { Component } from 'react';\nimport cytoscape from 'cytoscape';\nimport cola from 'cytoscape-cola';\nimport edgehandles from 'cytoscape-edgehandles'; //import functions\n\nimport { now, new_uuid, export_cytoscape, import_json, add_scheme, add_edge, get_atom, delete_edge, get_sd, add_atom } from '../lib/Sadface';\ncytoscape.use(edgehandles);\ncytoscape.use(cola);\nvar cy = null;\nvar cm = null;\nvar selected = [];\nvar position = null;\nvar layout = null;\nvar running = false;\nvar cy_data = {};\nvar json;\nvar created_date = now();\nvar edited_date = now();\nvar analyst_email = \"Default Analyst Email\";\nvar analyst_name = \"Default Analsyst Name\";\nvar document_id = new_uuid();\nvar default_sadface_doc = \"{\\\"analyst_email\\\":\\\"\" + analyst_email + \"\\\",\\\"analyst_name\\\":\\\"\" + analyst_email + \"\\\",\\\"created\\\":\\\"\" + created_date + \"\\\",\\\"edges\\\":[],\\\"edited\\\":\\\"\" + edited_date + \"\\\",\\\"id\\\":\\\"\" + document_id + \"\\\",\\\"metadata\\\":{},\\\"nodes\\\":[],\\\"resources\\\": []}\";\nvar current_sadface_doc = null;\nvar focused = null;\nvar undo_stack = [];\nvar redo_stack = [];\nvar edit_atom = null;\nvar resource_pane_viewable_state = true;\ninitialise_monkeypuzzle();\n\nfunction initialise_monkeypuzzle() {\n  //load diagram if there is one in localStorage\n  if (localStorage.getItem(\"state\")) {\n    loadJSON(localStorage.getItem(\"state\"));\n    initCytoscape(); //else use default\n  } else {\n    current_sadface_doc = default_sadface_doc;\n    localStorage.setItem(\"state\", current_sadface_doc);\n    cy_data = export_cytoscape(import_json(current_sadface_doc));\n    initCytoscape();\n  }\n}\n\nfunction initCytoscape() {\n  cy = cytoscape({\n    container: document.getElementById(\"cy\"),\n    ready: function () {\n      window.cy = this;\n    },\n    elements: JSON.parse(cy_data),\n    style: [{\n      selector: \"node\",\n      style: {\n        \"content\": \"data(content)\",\n        \"text-opacity\": 0.7,\n        \"width\": \"auto\",\n        \"height\": \"auto\",\n        \"text-valign\": \"bottom\",\n        \"text-halign\": \"right\",\n        \"text-outline-color\": \"#eee\",\n        \"text-outline-width\": 1\n      }\n    }, {\n      selector: \"[typeshape]\",\n      style: {\n        \"shape\": \"data(typeshape)\"\n      }\n    }, {\n      selector: \"node[typeshape='diamond']\",\n      style: {\n        'background-color': '#CC9900'\n      }\n    }, {\n      selector: \"node[typeshape='diamond'][content='Conflict']\",\n      style: {\n        'background-color': 'red'\n      }\n    }, {\n      selector: \"node[typeshape='diamond'][content='Support']\",\n      style: {\n        'background-color': 'green'\n      }\n    }, {\n      selector: \"edge\",\n      style: {\n        \"line-color\": \"#9dbaea\",\n        \"target-arrow-shape\": \"triangle\",\n        \"target-arrow-color\": \"#9dbaea\",\n        \"curve-style\": \"bezier\"\n      }\n    }, {\n      selector: \":selected\",\n      style: {\n        \"border-width\": \"1\",\n        \"border-color\": \"black\",\n        \"background-color\": \"#3399CC\"\n      }\n    }, {\n      selector: \".atom-label\",\n      style: {\n        \"text-wrap\": \"wrap\",\n        \"text-max-width\": 160\n      }\n    }, {\n      selector: \".scheme-label\",\n      style: {\n        \"text-wrap\": \"wrap\",\n        \"text-max-width\": 160\n      }\n    }],\n    boxSelectionEnabled: false,\n    autounselectify: false,\n    selectionType: \"single\",\n    minZoom: 0.1,\n    maxZoom: 1.5\n  });\n  layout = build_cola_layout();\n  layout.run();\n  cy.elements(\"node[type = \\\"atom\\\"]\").qtip({\n    content: function () {\n      return 'ID: ' + this.id();\n    },\n    position: {\n      my: \"top center\",\n      at: \"bottom center\"\n    },\n    style: {\n      classes: \"qtip-bootstrap\",\n      tip: {\n        width: 16,\n        height: 8\n      }\n    }\n  });\n  cy.edgehandles({\n    toggleOffOnLeave: true,\n    handleNodes: \"node\",\n    handleSize: 10,\n    handleColor: \"orange\",\n    handleHitThreshold: 8,\n    handleLineWidth: 5,\n    //handleLineType: \"flat\",\n    handleOutlineColor: \"grey\",\n    edgeType: function () {\n      return \"flat\";\n    },\n    complete: function (event, sourceNode, targetNode, addedEles) {\n      if (targetNode.length !== 0) {\n        var source_id = targetNode[0].source().id();\n        var target_id = targetNode[0].target().id(); //get the mid point between source node and target node\n\n        var source_position = targetNode[0].source().position();\n        var target_position = targetNode[0].target().position();\n        position = {};\n        position.x = (source_position.x + target_position.x) / 2;\n        position.y = (source_position.y + target_position.y) / 2;\n\n        if (targetNode[0].source().data().type == \"atom\" && targetNode[0].target().data().type == \"atom\") {\n          var scheme = add_scheme(\"Support\");\n          var scheme_id = scheme.id;\n          var scheme_content = scheme.name; //remove the automatically generated edge\n\n          targetNode.remove();\n          cy.add([{\n            group: \"nodes\",\n            data: {\n              id: scheme_id.toString(),\n              content: scheme_content,\n              typeshape: \"diamond\"\n            },\n            classes: \"scheme-label\",\n            locked: false,\n            position: position\n          }]);\n          var edge1 = add_edge(source_id, scheme_id);\n          var edge2 = add_edge(scheme_id, target_id);\n          cy.add([{\n            group: \"edges\",\n            data: {\n              id: edge1.id.toString(),\n              source: source_id,\n              target: scheme_id\n            }\n          }, {\n            group: \"edges\",\n            data: {\n              id: edge2.id.toString(),\n              source: scheme_id,\n              target: target_id\n            }\n          }]);\n        } else {\n          targetNode.remove();\n          var edge = add_edge(source_id, target_id);\n          cy.add([{\n            group: \"edges\",\n            data: {\n              id: edge.id.toString(),\n              source: source_id,\n              target: target_id\n            }\n          }]);\n        }\n\n        update_local_storage();\n      } else {\n        targetNode.remove();\n      }\n    }\n  });\n  /*\n   *\n   * Set up context menus\n   *\n   * */\n\n  cm = cy.contextMenus({\n    menuItems: [{\n      id: \"edit-content\",\n      title: \"edit content\",\n      selector: \"node[type = \\\"atom\\\"]\",\n      onClickFunction: function (event) {\n        var target = event.target || event.cyTarget; // $(\"#editContentModal\").modal(\"show\");\n        //  $(\"#edit_atom_content\").val(target.data().content);\n\n        edit_atom = target;\n      },\n      hasTrailingDivider: false\n    }, {\n      id: \"edit-metadata\",\n      title: \"edit metadata\",\n      selector: \"node[type = \\\"atom\\\"]\",\n      onClickFunction: function (event) {\n        // $(\"#edit_metadata\").empty();\n        var target = event.target || event.cyTarget;\n        var atom = get_atom(target.id()); // var textArea = $(\"<textarea id=\\\"\"+target.id()+\"_metadata\\\" class=\\\"form-control\\\" rows=\\\"2\\\" >\"+JSON.stringify(atom.metadata)+\"</textarea>\");\n        // $(\"#edit_metadata\").append(textArea);\n        //  $(\"#editMetadataModal\").modal(\"show\");\n\n        edit_atom = target;\n      },\n      hasTrailingDivider: true\n    }, {\n      id: \"change-scheme\",\n      title: \"change scheme\",\n      selector: \"node[typeshape = \\\"diamond\\\"]\",\n      onClickFunction: function (event) {\n        var target = event.target || event.cyTarget; //  $(\"#editSchemeModal\").modal(\"show\");\n\n        edit_atom = target;\n      },\n      hasTrailingDivider: true\n    }, {\n      id: \"remove\",\n      title: \"remove\",\n      selector: \"node, edge\",\n      onClickFunction: function (event) {\n        var target = event.target || event.cyTarget;\n\n        if (selected.length !== 0) {\n          selected.forEach(function (node) {\n            delete_nodes(node);\n          });\n          selected = [];\n        } else {\n          if (target.data().type == \"atom\") {\n            delete_nodes(event);\n            target.remove();\n          } else if (target.data().typeshape == \"diamond\") {\n            delete_nodes(event);\n            target.remove();\n          } else {\n            delete_edge(target.id());\n            update_local_storage();\n            target.remove();\n          }\n        }\n      },\n      hasTrailingDivider: true\n    }, {\n      id: \"add-atom\",\n      title: \"add atom\",\n      coreAsWell: true,\n      onClickFunction: function (event) {\n        position = event.renderedPosition; //  $(\"#newAtomModal\").modal(\"show\");\n      }\n    }, {\n      id: \"add-scheme\",\n      title: \"add scheme\",\n      coreAsWell: true,\n      onClickFunction: function (event) {\n        position = event.position || event.cyPosition;\n        document.getElementById(\"sel1\").options.selectedIndex = 0; //  $(\"#newSchemeModal\").modal(\"show\");\n      },\n      hasTrailingDivider: true\n    }, {\n      id: \"redraw\",\n      title: \"redraw\",\n      coreAsWell: true,\n      onClickFunction: function (event) {\n        redraw_visualisation();\n      },\n      hasTrailingDivider: true\n    }, {\n      id: \"undo\",\n      title: \"undo\",\n      selector: \"node, edge\",\n      show: false,\n      coreAsWell: true,\n      onClickFunction: function (event) {\n        undo();\n      },\n      hasTrailingDivider: false\n    }, {\n      id: \"redo\",\n      title: \"redo\",\n      selector: \"node, edge\",\n      show: false,\n      coreAsWell: true,\n      onClickFunction: function (event) {\n        redo();\n\n        if (redo_stack == []) {\n          cm.hideMenuItem(\"redo\");\n        }\n      },\n      hasTrailingDivider: true\n    }, {\n      id: \"merge_nodes\",\n      title: \"merge nodes\",\n      selector: \"node\",\n      show: false,\n      coreAsWell: true,\n      onClickFunction: function (event) {\n        merge_nodes();\n      }\n    }]\n  });\n  cy.on(\"unselect\", \"node\", function (e) {\n    selected.pop(e);\n    cm.hideMenuItem(\"merge_nodes\");\n  });\n  cy.on(\"select\", \"node\", function (e) {\n    selected.push(e);\n\n    if (selected.length > 1) {\n      cm.showMenuItem(\"merge_nodes\");\n    } else {\n      cm.hideMenuItem(\"merge_nodes\");\n    }\n  });\n  cy.on(\"tap\", function (e) {//when cytoscape is tapped remove any focus from HTML elements like the tab textareas\n    //this mainly helps with keybinds\n    //        $(\":focus\").blur();\n  });\n  cy.on(\"layoutstart\", function () {\n    running = true;\n  });\n  cy.on(\"layoutstop\", function () {\n    running = false;\n    var png = cy.png({\n      full: true\n    }); //        $('#download_png').attr('href', png);\n\n    var jpg = cy.jpg({\n      full: true\n    }); //        $('#download_jpg').attr('href', jpg);\n  });\n  /*  $(\".resource-pane\").resizable({\n         handleSelector: \".splitter\",\n         resizeHeight: false,\n         resizeWidthFrom: \"right\",\n         //onDragStart: function (e, $el, opt) {},\n         onDragEnd: function (e, $el, opt) {\n             cy.resize();\n         }\n     });*/\n}\n\nfunction build_cola_layout(opts) {\n  var cola_params = {\n    name: \"cola\",\n    animate: true,\n    randomize: true,\n    padding: 100,\n    fit: false,\n    maxSimulationTime: 1500\n  };\n  var i = 0;\n\n  if (opts !== undefined) {\n    opts.forEach(function (opt) {\n      cola_params[i] = opts[i];\n      ++i;\n    });\n  }\n\n  return cy.makeLayout(cola_params);\n}\n\nfunction loadJSON(json_value) {\n  json = import_json(json_value);\n  localStorage.setItem(\"state\", JSON.stringify(get_sd()));\n  current_sadface_doc = JSON.stringify(get_sd()); //load any sources in the stored diagram state\n\n  window.onload = function () {\n    loadTabs(json.resources);\n  };\n\n  cy_data = export_cytoscape(json);\n\n  if (cy !== null) {\n    cy.elements().remove();\n    cy.json({\n      elements: JSON.parse(cy_data)\n    });\n    redraw_visualisation();\n  }\n}\n\nfunction loadTabs(tabs) {\n  tabs.forEach(function (tab) {//       load_tab(tab);    !!!!!fix this\n  });\n}\n/*\n *\n * Model Manipulation Functions\n *\n * */\n\n\nfunction add_new_atom_node(content) {\n  var meta = {\n    \"hello\": \"world\"\n  };\n  var new_atom = add_atom(content);\n  var atom_id = new_atom.id;\n\n  if (focused != null) {\n    add_source(atom_id, focused.id, content, 0, 0);\n  }\n\n  if (position == null) {\n    position = {\n      \"x\": cy.width() / 2,\n      \"y\": cy.height() / 2\n    };\n  }\n\n  cy.add([{\n    group: \"nodes\",\n    data: {\n      id: atom_id.toString(),\n      content: content,\n      type: \"atom\",\n      typeshape: \"roundrectangle\",\n      metadata: meta\n    },\n    classes: \"atom-label\",\n    locked: false,\n    renderedPosition: position\n  }]);\n  node = cy.getElementById(atom_id.toString());\n  node.qtip({\n    content: function () {\n      return 'ID: ' + this.id();\n    },\n    position: {\n      my: \"top center\",\n      at: \"bottom center\"\n    },\n    style: {\n      classes: \"qtip-bootstrap\",\n      tip: {\n        width: 16,\n        height: 8\n      }\n    }\n  });\n  position = null;\n  update_local_storage();\n}\n\nfunction get_selected_text() {\n  if (document.activeElement.tagName.toLowerCase() == \"textarea\") {\n    var selectedTextArea = document.activeElement;\n    var selection = selectedTextArea.value.substring(selectedTextArea.selectionStart, selectedTextArea.selectionEnd);\n    selectedTextArea.selectionStart = selectedTextArea.selectionEnd;\n  }\n\n  return selection;\n}\n\nfunction clear_selection() {\n  if (window.getSelection) {\n    if (window.getSelection().empty) {\n      // Chrome\n      window.getSelection().empty();\n    }\n\n    if (window.getSelection().removeAllRanges) {\n      // Firefox\n      window.getSelection().removeAllRanges();\n    }\n  }\n\n  if (document.selection) {\n    // IE?\n    document.selection.empty();\n  }\n}\n\nfunction set_focus(element) {\n  focused = document.getElementById(element.id); //.id;\n}\n\nfunction clear_focus() {\n  focused = null;\n}\n\nfunction update_local_storage() {\n  var undo_item = JSON.parse(current_sadface_doc);\n  undo_stack.push(undo_item);\n  redo_stack = [];\n  cm.showMenuItem(\"undo\");\n  cm.hideMenuItem(\"redo\");\n  localStorage.setItem(\"state\", JSON.stringify(get_sd()));\n  current_sadface_doc = JSON.stringify(get_sd());\n  update();\n}\n\nfunction undo() {\n  if (undo_stack.length != 0) {\n    var redo_item = get_sd();\n    redo_stack.push(redo_item);\n    state = undo_stack.pop();\n    loadJSON(JSON.stringify(state));\n\n    if (undo_stack.length == 0) {\n      cm.hideMenuItem(\"undo\");\n    }\n\n    cm.showMenuItem(\"redo\");\n  }\n}\n\nfunction redo() {\n  if (redo_stack.length != 0) {\n    var undo_item = get_sd();\n    undo_stack.push(undo_item);\n    state = redo_stack.pop();\n    loadJSON(JSON.stringify(state));\n\n    if (redo_stack.length == 0) {\n      cm.hideMenuItem(\"redo\");\n    }\n\n    cm.showMenuItem(\"undo\");\n  }\n}\n\nfunction dragover_handler(ev) {\n  ev.preventDefault();\n  ev.dataTransfer.dropEffect = \"move\";\n}\n\nfunction drop_handler(ev) {\n  ev.preventDefault();\n  position = {\n    x: ev.clientX - 280,\n    y: ev.clientY + 200\n  };\n  var selection = get_selected_text();\n\n  if (selection != null || selection != undefined) {\n    add_new_atom_node(selection);\n    clear_selection();\n    clear_focus();\n  } else {\n    console.log(\"Not a valid text selection.\");\n  }\n}\n\nfunction merge_nodes() {\n  //From all currently selected nodes, set first in selected to the base node, move all sources and edges related to each other node in selected to base node\n  var target;\n  var id;\n  var atom;\n  var baseNode = selected[0].target || selected[0].cyTarget;\n  var baseId = baseNode.id();\n  var baseAtom = get_atom(baseId);\n  var edge;\n\n  if (baseAtom.type == \"atom\") {\n    sds = get_sd();\n    var i = 0;\n    selected.forEach(function (node) {\n      var j = 0;\n\n      if (i > 0) {\n        target = selected[i].target || selected[i].cyTarget;\n        id = target.id();\n        atom = get_atom(id);\n\n        if (atom.type == \"atom\") {\n          atom.sources.forEach(function (source) {\n            add_source(baseId, atom.sources[j].resource_id, atom.sources[j].text, atom.sources[j].offset, atom.sources[j].length);\n            ++j;\n          });\n          j = 0;\n          sds.edges.forEach(function (edge) {\n            if (sds.edges[j].source_id == id) {\n              edge = add_edge(baseId, sds.edges[j].target_id);\n              cy.add([{\n                group: \"edges\",\n                data: {\n                  id: edge.id.toString(),\n                  source: baseId,\n                  target: sds.edges[j].target_id\n                }\n              }]);\n            }\n\n            if (sds.edges[j].target_id == id) {\n              edge = add_edge(sds.edges[j].source_id, baseId);\n              cy.add([]);\n            }\n\n            ++j;\n          });\n          delete_nodes(selected[i]);\n        } else {\n          alert(\"cannot merge scheme nodes\");\n        }\n      }\n\n      ++i;\n    });\n    selected = [];\n    cm.hideMenuItem(\"merge_nodes\");\n  } else {\n    alert(\"cannot merge scheme nodes\");\n  }\n}\n\nfunction edit_atom_content() {\n  var content = document.getElementById(\"edit_atom_content\").value;\n  var atom = cy.$(\"#\" + edit_atom.id());\n  update_atom_text(edit_atom.id(), content);\n  update_local_storage();\n  atom.data(\"content\", content);\n  edit_atom = null;\n}\n\nfunction edit_atom_metadata() {\n  var atom = cy.$(\"#\" + edit_atom.id());\n  var content = document.getElementById(atom.id() + \"_metadata\").value;\n\n  if (JSON.parse(content)) {\n    var metadata = JSON.parse(content);\n    update_atom_metadata(atom.id(), metadata);\n    update_local_storage();\n    edit_atom = null;\n  } else {\n    alert(\"Metadata not in JSON format, unable to update\");\n  }\n}\n\nfunction edit_scheme_content() {\n  var scheme_idx = document.getElementById(\"sel2\").options.selectedIndex;\n  var content = document.getElementById(\"sel2\").options[scheme_idx].text;\n  var scheme = cy.$(\"#\" + edit_atom.id());\n  update_scheme(edit_atom.id(), content);\n  update_local_storage();\n  scheme.data(\"content\", content);\n  edit_atom = null;\n}\n\nfunction clear_local_storage() {\n  localStorage.clear();\n  window.location.reload(false);\n} //******************************************************\n\n\nfunction add_new_scheme_node() {\n  var scheme_idx = document.getElementById(\"sel1\").options.selectedIndex;\n  var scheme = document.getElementById(\"sel1\").options[scheme_idx].text;\n  var new_scheme = add_scheme(scheme);\n  var scheme_id = new_scheme.id;\n  cy.add([{\n    group: \"nodes\",\n    data: {\n      id: scheme_id.toString(),\n      content: scheme,\n      type: \"scheme\",\n      typeshape: \"diamond\"\n    },\n    classes: \"scheme-label\",\n    locked: false,\n    position: position\n  }]);\n  update_local_storage();\n}\n\nfunction delete_nodes(event) {\n  var target = event.target || event.cyTarget;\n  var id = target.id();\n  removed = target.remove();\n  delete_atom(id);\n  var i = 0;\n  var sds = get_sd();\n  var edges = sds.edges;\n  edges.forEach(function (edge) {\n    if (edges[i] !== undefined) {\n      if (edges[i].source_id === id || edges[i].target_id === id) {\n        delete_edge(edges[i].id);\n      }\n\n      ++i;\n    }\n  });\n  update_local_storage();\n}\n\nfunction redraw_visualisation() {\n  layout.stop();\n  layout.options.eles = cy.elements();\n  layout.run();\n  cy.center();\n  cy.resize();\n}\n\nfunction mp_reset() {\n  clear_local_storage();\n}\n\nfunction set_analyst_name() {\n  analyst_name = document.getElementById('analyst_name_textarea').value;\n  update_analyst_name(analyst_name);\n}\n\nfunction set_analyst_email() {\n  analyst_email = document.getElementById('analyst_email_textarea').value;\n  update_analyst_email(analyst_email);\n}\n\nclass GraphContainer extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {};\n    this.initialise_monkeypuzzle = this.initialise_monkeypuzzle.bind(this);\n  }\n\n  initialise_monkeypuzzle() {\n    //load diagram if there is one in localStorage\n    if (localStorage.getItem(\"state\")) {\n      //  this.loadJSON(localStorage.getItem(\"state\"));\n      this.initCytoscape(); //else use default\n    } else {\n      this.setState({\n        current_sadface_doc: this.setDefault()\n      });\n      localStorage.setItem(\"state\", this.state.current_sadface_doc); //   cy_data = export_cytoscape({import_json(current_sadface_doc)});\n\n      this.initCytoscape();\n    }\n  }\n\n  setDefault() {\n    this.setState({\n      analyst_email: \"Default Analyst Email\",\n      analyst_name: \"Default Analsyst Name\",\n      created: this.props.now(),\n      edges: [],\n      edited: this.props.now(),\n      id: this.props.new_uuid(),\n      metadata: {},\n      nodes: [],\n      resources: []\n    });\n  }\n\n  componentDidMount() {\n    this.initialise_monkeypuzzle();\n    this.setState({\n      cy: this.cy,\n      layout: this.layout,\n      position: this.position\n    });\n  }\n\n  render() {\n    return React.createElement(\"div\", {\n      id: \"cy\",\n      ondrop: \"drop_handler(event);\",\n      ondragover: \"dragover_handler(event);\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 780\n      },\n      __self: this\n    });\n  }\n\n}\n\nexport default GraphContainer;","map":{"version":3,"sources":["/Users/gareth/Desktop/monkeypuzzle/src/Components/CytoContainer.js"],"names":["React","Component","cytoscape","cola","edgehandles","now","new_uuid","export_cytoscape","import_json","add_scheme","add_edge","get_atom","delete_edge","get_sd","add_atom","use","cy","cm","selected","position","layout","running","cy_data","json","created_date","edited_date","analyst_email","analyst_name","document_id","default_sadface_doc","current_sadface_doc","focused","undo_stack","redo_stack","edit_atom","resource_pane_viewable_state","initialise_monkeypuzzle","localStorage","getItem","loadJSON","initCytoscape","setItem","container","document","getElementById","ready","window","elements","JSON","parse","style","selector","boxSelectionEnabled","autounselectify","selectionType","minZoom","maxZoom","build_cola_layout","run","qtip","content","id","my","at","classes","tip","width","height","toggleOffOnLeave","handleNodes","handleSize","handleColor","handleHitThreshold","handleLineWidth","handleOutlineColor","edgeType","complete","event","sourceNode","targetNode","addedEles","length","source_id","source","target_id","target","source_position","target_position","x","y","data","type","scheme","scheme_id","scheme_content","name","remove","add","group","toString","typeshape","locked","edge1","edge2","edge","update_local_storage","contextMenus","menuItems","title","onClickFunction","cyTarget","hasTrailingDivider","atom","forEach","node","delete_nodes","coreAsWell","renderedPosition","cyPosition","options","selectedIndex","redraw_visualisation","show","undo","redo","hideMenuItem","merge_nodes","on","e","pop","push","showMenuItem","png","full","jpg","opts","cola_params","animate","randomize","padding","fit","maxSimulationTime","i","undefined","opt","makeLayout","json_value","stringify","onload","loadTabs","resources","tabs","tab","add_new_atom_node","meta","new_atom","atom_id","add_source","metadata","get_selected_text","activeElement","tagName","toLowerCase","selectedTextArea","selection","value","substring","selectionStart","selectionEnd","clear_selection","getSelection","empty","removeAllRanges","set_focus","element","clear_focus","undo_item","update","redo_item","state","dragover_handler","ev","preventDefault","dataTransfer","dropEffect","drop_handler","clientX","clientY","console","log","baseNode","baseId","baseAtom","sds","j","sources","resource_id","text","offset","edges","alert","edit_atom_content","$","update_atom_text","edit_atom_metadata","update_atom_metadata","edit_scheme_content","scheme_idx","update_scheme","clear_local_storage","clear","location","reload","add_new_scheme_node","new_scheme","removed","delete_atom","stop","eles","center","resize","mp_reset","set_analyst_name","update_analyst_name","set_analyst_email","update_analyst_email","GraphContainer","constructor","props","bind","setState","setDefault","created","edited","nodes","componentDidMount","render"],"mappings":"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","sourcesContent":["import React,{Component} from 'react';\nimport cytoscape from 'cytoscape';\nimport cola from 'cytoscape-cola';\nimport edgehandles from 'cytoscape-edgehandles';\n\n//import functions\nimport {\n    now,new_uuid,export_cytoscape,import_json, add_scheme, add_edge,get_atom, delete_edge, get_sd, add_atom,} from '../lib/Sadface';\n\n\n\n\n\n\n\ncytoscape.use( edgehandles );\ncytoscape.use( cola );\n\n\nvar cy = null;\nvar cm = null;\nvar selected = [];\nvar position = null;\nvar layout = null;\nvar running = false;\nvar cy_data  = {};\nvar json;\nvar created_date = now();\nvar edited_date = now();\nvar analyst_email = \"Default Analyst Email\";\nvar analyst_name = \"Default Analsyst Name\";\nvar document_id = new_uuid();\nvar default_sadface_doc = \"{\\\"analyst_email\\\":\\\"\"+analyst_email+\"\\\",\\\"analyst_name\\\":\\\"\"+analyst_email+\"\\\",\\\"created\\\":\\\"\"+created_date+\"\\\",\\\"edges\\\":[],\\\"edited\\\":\\\"\"+edited_date+\"\\\",\\\"id\\\":\\\"\"+document_id+\"\\\",\\\"metadata\\\":{},\\\"nodes\\\":[],\\\"resources\\\": []}\";\nvar current_sadface_doc = null;\nvar focused = null;\nvar undo_stack = [];\nvar redo_stack = [];\nvar edit_atom = null;\nvar resource_pane_viewable_state = true;\n\ninitialise_monkeypuzzle();\n\nfunction initialise_monkeypuzzle() {\n\n    //load diagram if there is one in localStorage\n    if (localStorage.getItem(\"state\"))\n    {\n        loadJSON(localStorage.getItem(\"state\"));\n        initCytoscape();\n    //else use default\n    } else\n    {\n        current_sadface_doc = default_sadface_doc;\n        localStorage.setItem(\"state\", current_sadface_doc);\n        cy_data = export_cytoscape(import_json(current_sadface_doc));\n        initCytoscape();\n    }\n}\n\nfunction initCytoscape() {\n    cy = cytoscape({\n        container: document.getElementById(\"cy\"),\n        ready: function(){ window.cy = this; },\n        elements: JSON.parse(cy_data),\n        style:[\n            {   selector: \"node\", \n                style: {\n                    \"content\": \"data(content)\",\n                    \"text-opacity\": 0.7,\n                    \"width\" : \"auto\",\n                    \"height\" : \"auto\",\n                    \"text-valign\": \"bottom\",\n                    \"text-halign\": \"right\",\n                    \"text-outline-color\": \"#eee\",\n                    \"text-outline-width\": 1\n              }\n            },\n            {   selector: \"[typeshape]\", \n                style: {\n                    \"shape\":\"data(typeshape)\"\n                }\n            },\n            {   selector: \"node[typeshape='diamond']\", \n                style: {\n                    'background-color': '#CC9900'\n                }\n            },\n            {\n                selector: \"node[typeshape='diamond'][content='Conflict']\",\n                style: {\n                    'background-color': 'red'\n                }\n            },\n            {\n                selector: \"node[typeshape='diamond'][content='Support']\",\n                style: {\n                    'background-color': 'green'\n                }\n            },\n            {   selector: \"edge\", \n                style: {\n                    \"line-color\": \"#9dbaea\",\n                    \"target-arrow-shape\": \"triangle\",\n                    \"target-arrow-color\": \"#9dbaea\",\n                    \"curve-style\": \"bezier\"\n                }\n            },\n            {   selector: \":selected\", \n                style: {\n                    \"border-width\":\"1\",\n                    \"border-color\":\"black\",\n                    \"background-color\": \"#3399CC\"\n                }\n            },\n            {   selector: \".atom-label\", \n                style:{\n                    \"text-wrap\": \"wrap\",\n                    \"text-max-width\": 160\n                }\n            },\n            {   selector: \".scheme-label\", \n                style:{\n                    \"text-wrap\": \"wrap\",\n                    \"text-max-width\": 160\n                }\n            }\n            ],\n            boxSelectionEnabled: false,\n            autounselectify: false,\n            selectionType: \"single\",\n            minZoom: 0.1,\n            maxZoom: 1.5\n    });\n\n    layout = build_cola_layout();\n    layout.run();\n\n    cy.elements(\"node[type = \\\"atom\\\"]\").qtip({\n        content: function(){return 'ID: '+this.id()},\n        position: {\n            my: \"top center\",\n            at: \"bottom center\"\n        },\n        style: {\n            classes: \"qtip-bootstrap\",\n            tip: {\n                width: 16,\n                height: 8\n            }\n        }\n    });\n\n\n   cy.edgehandles({\n        toggleOffOnLeave: true,\n        handleNodes: \"node\",\n        handleSize: 10,\n        handleColor: \"orange\",\n        handleHitThreshold: 8,\n        handleLineWidth: 5,\n        //handleLineType: \"flat\",\n        handleOutlineColor: \"grey\",\n        edgeType: function(){ return \"flat\"; },\n        complete: function(event, sourceNode, targetNode, addedEles){\n            if (targetNode.length !== 0) {\n                var source_id = targetNode[0].source().id();\n                var target_id = targetNode[0].target().id();\n\n                //get the mid point between source node and target node\n                var source_position = targetNode[0].source().position();\n                var target_position = targetNode[0].target().position();\n\n                position = {};\n                position.x = ((source_position.x + target_position.x)/2);\n                position.y = ((source_position.y + target_position.y)/2);\n\n                if (targetNode[0].source().data().type == \"atom\" && targetNode[0].target().data().type == \"atom\")\n                {\n                    var scheme = add_scheme(\"Support\");\n                    var scheme_id = scheme.id;\n                    var scheme_content = scheme.name;\n                    //remove the automatically generated edge\n                    targetNode.remove();\n                    cy.add([\n                        {group: \"nodes\", data: {id: scheme_id.toString(),\n                            content: scheme_content, typeshape: \"diamond\" }, classes: \"scheme-label\", locked: false, position: position}\n                    ]);\n                    var edge1 = add_edge(source_id, scheme_id);\n                    var edge2 = add_edge(scheme_id, target_id);\n                    cy.add([\n                      { group: \"edges\", data: { id: edge1.id.toString(), source: source_id, target: scheme_id } },\n                      { group: \"edges\", data: { id: edge2.id.toString(), source: scheme_id, target: target_id } }\n                    ]);\n                } else {\n                    targetNode.remove();\n                    var edge = add_edge(source_id, target_id);\n                    cy.add([\n                      { group: \"edges\", data: { id: edge.id.toString(), source: source_id, target: target_id } }\n                    ]);\n                }\n                update_local_storage();\n            } else {\n                targetNode.remove();\n            }\n        }\n    });\n    /*\n     *\n     * Set up context menus\n     *\n     * */\n    cm = cy.contextMenus({\n        menuItems: [\n          {\n            id: \"edit-content\",\n            title: \"edit content\",\n            selector: \"node[type = \\\"atom\\\"]\",\n            onClickFunction: function (event) {\n              var target = event.target || event.cyTarget;\n             // $(\"#editContentModal\").modal(\"show\");\n            //  $(\"#edit_atom_content\").val(target.data().content);\n              edit_atom = target;\n            },\n            hasTrailingDivider: false\n          },\n          {\n            id: \"edit-metadata\",\n            title: \"edit metadata\",\n            selector: \"node[type = \\\"atom\\\"]\",\n            onClickFunction: function (event) {\n               // $(\"#edit_metadata\").empty();\n                var target = event.target || event.cyTarget;\n                var atom = get_atom(target.id());\n               // var textArea = $(\"<textarea id=\\\"\"+target.id()+\"_metadata\\\" class=\\\"form-control\\\" rows=\\\"2\\\" >\"+JSON.stringify(atom.metadata)+\"</textarea>\");\n               // $(\"#edit_metadata\").append(textArea);\n              //  $(\"#editMetadataModal\").modal(\"show\");\n                edit_atom = target;\n            },\n            hasTrailingDivider: true\n          },\n          {\n            id: \"change-scheme\",\n            title: \"change scheme\",\n            selector: \"node[typeshape = \\\"diamond\\\"]\",\n            onClickFunction: function (event) {\n                var target = event.target || event.cyTarget;\n              //  $(\"#editSchemeModal\").modal(\"show\");\n                edit_atom = target;\n            },\n            hasTrailingDivider: true\n          },\n          {\n            id: \"remove\",\n            title: \"remove\",\n            selector: \"node, edge\",\n            onClickFunction: function (event) {\n                var target = event.target || event.cyTarget;\n                if (selected.length !== 0) {\n                    selected.forEach(function(node) {\n                        delete_nodes(node);\n                    });\n                    selected = [];\n                } else {\n                    if (target.data().type==\"atom\") {\n                        delete_nodes(event);\n                        target.remove();\n                    } else if (target.data().typeshape==\"diamond\"){\n                        delete_nodes(event);\n                        target.remove();\n                    } else {\n                        delete_edge(target.id());\n                        update_local_storage();\n                        target.remove();\n                    }\n                }\n            },\n            hasTrailingDivider: true\n          },\n          {\n            id: \"add-atom\",\n            title: \"add atom\",\n            coreAsWell: true,\n            onClickFunction: function (event) {\n                position = event.renderedPosition;\n              //  $(\"#newAtomModal\").modal(\"show\");\n            }\n          },\n          {\n            id: \"add-scheme\",\n            title: \"add scheme\",\n            coreAsWell: true,\n            onClickFunction: function (event) {\n\n                position = event.position || event.cyPosition;\n\n                document.getElementById(\"sel1\").options.selectedIndex=0;\n              //  $(\"#newSchemeModal\").modal(\"show\");\n            },\n            hasTrailingDivider: true\n          },\n          {\n            id: \"redraw\",\n            title: \"redraw\",\n            coreAsWell: true,\n            onClickFunction: function (event) { redraw_visualisation(); },\n            hasTrailingDivider: true\n          },\n          {\n            id: \"undo\",\n            title: \"undo\",\n            selector: \"node, edge\",\n            show: false,\n            coreAsWell: true,\n            onClickFunction: function (event) {\n              undo();\n            },\n            hasTrailingDivider: false\n          },\n          {\n            id: \"redo\",\n            title: \"redo\",\n            selector: \"node, edge\",\n            show: false,\n            coreAsWell: true,\n            onClickFunction: function (event) {\n              redo();\n              if (redo_stack == []) {\n                cm.hideMenuItem(\"redo\");\n              }\n            },\n            hasTrailingDivider: true\n          },\n          {\n              id: \"merge_nodes\",\n              title: \"merge nodes\",\n              selector: \"node\",\n              show: false,\n              coreAsWell: true,\n              onClickFunction: function (event) {\n                  merge_nodes();\n              }\n          }\n        ]\n    });\n\n    cy.on(\"unselect\", \"node\", function (e){\n        selected.pop(e);\n        cm.hideMenuItem(\"merge_nodes\");\n    });\n\n    cy.on(\"select\", \"node\", function (e){\n        selected.push(e);\n        if(selected.length>1) {\n            cm.showMenuItem(\"merge_nodes\");\n        } else {\n            cm.hideMenuItem(\"merge_nodes\");\n        }\n    });\n\n    cy.on(\"tap\", function (e){\n        //when cytoscape is tapped remove any focus from HTML elements like the tab textareas\n        //this mainly helps with keybinds\n//        $(\":focus\").blur();\n    });\n\n    cy.on(\"layoutstart\", function(){\n        running = true;\n    });\n\n    cy.on(\"layoutstop\", function(){\n        running = false;\n        \n        var png = cy.png({ full: true });\n//        $('#download_png').attr('href', png);\n\n        var jpg = cy.jpg({ full: true });\n//        $('#download_jpg').attr('href', jpg);\n    });\n\n /*  $(\".resource-pane\").resizable({\n        handleSelector: \".splitter\",\n        resizeHeight: false,\n        resizeWidthFrom: \"right\",\n        //onDragStart: function (e, $el, opt) {},\n        onDragEnd: function (e, $el, opt) {\n            cy.resize();\n        }\n    });*/\n}\n\nfunction build_cola_layout( opts ) {\n    var cola_params = {\n        name: \"cola\",\n        animate: true,\n        randomize: true,\n        padding: 100,\n        fit: false,\n        maxSimulationTime: 1500\n    };\n    var i = 0;\n    if (opts !== undefined) {\n        opts.forEach(function(opt) {\n           cola_params[i] = opts[i];\n           ++i;\n        });\n    }\n    return cy.makeLayout( cola_params );\n}\n\n\nfunction loadJSON(json_value) {\n    json = import_json(json_value);\n    localStorage.setItem(\"state\",JSON.stringify(get_sd()));\n    current_sadface_doc = JSON.stringify(get_sd());\n    //load any sources in the stored diagram state\n    window.onload = function () {\n        loadTabs(json.resources);\n    };\n    cy_data = export_cytoscape(json);\n    if(cy !== null)\n    {\n        cy.elements().remove();\n        cy.json({elements: JSON.parse(cy_data)});\n        redraw_visualisation();\n    }\n}\n\nfunction loadTabs(tabs) {\n    tabs.forEach(function(tab) {\n//       load_tab(tab);    !!!!!fix this\n    });\n}\n\n\n/*\n *\n * Model Manipulation Functions\n *\n * */\n\nfunction add_new_atom_node(content) {\n    var meta = {\"hello\":\"world\"};\n    var new_atom = add_atom(content);\n    var atom_id = new_atom.id;\n    if (focused != null) {\n        add_source(atom_id, focused.id, content, 0, 0);\n    }\n    if (position == null) {\n        position = {\"x\": cy.width()/2, \"y\": cy.height()/2};\n    }\n    cy.add([\n        {group: \"nodes\", data: {id: atom_id.toString(),\n            content: content, type: \"atom\", typeshape: \"roundrectangle\", metadata: meta }, \n            classes: \"atom-label\", locked: false, renderedPosition: position}\n    ]);\n    node = cy.getElementById(atom_id.toString() );\n    node.qtip({\n        content: function(){return 'ID: '+this.id()},\n        position: {\n            my: \"top center\",\n            at: \"bottom center\"\n        },\n        style: {\n            classes: \"qtip-bootstrap\",\n            tip: {\n                width: 16,\n                height: 8\n            }\n        }\n    });\n    position = null;\n    update_local_storage();\n}\n\nfunction get_selected_text() {\n    if(document.activeElement.tagName.toLowerCase() == \"textarea\")\n    {\n        var selectedTextArea = document.activeElement;\n        var selection = selectedTextArea.value.substring(\n            selectedTextArea.selectionStart, selectedTextArea.selectionEnd);\n        selectedTextArea.selectionStart = selectedTextArea.selectionEnd;\n    }\n    return selection;\n}\n\nfunction clear_selection() {\n    if (window.getSelection) {\n        if (window.getSelection().empty) {  // Chrome\n            window.getSelection().empty();\n        } \n        if (window.getSelection().removeAllRanges) {  // Firefox\n            window.getSelection().removeAllRanges();\n        }\n    } \n    if (document.selection) {  // IE?\n        document.selection.empty();\n    }\n}\n\nfunction set_focus(element) {\n    focused = document.getElementById(element.id);//.id;\n}\n\nfunction clear_focus(){\n    focused = null;\n}\n\nfunction update_local_storage() {\n    var undo_item = JSON.parse(current_sadface_doc);\n    undo_stack.push(undo_item);\n    redo_stack = [];\n    cm.showMenuItem(\"undo\");\n    cm.hideMenuItem(\"redo\");\n    localStorage.setItem(\"state\", JSON.stringify(get_sd()));\n    current_sadface_doc = JSON.stringify(get_sd());\n    update();\n}\n\nfunction undo() {\n    if (undo_stack.length != 0) {\n        var redo_item = get_sd();\n        redo_stack.push(redo_item);\n        state = undo_stack.pop();\n        loadJSON(JSON.stringify(state));\n        if (undo_stack.length == 0) {\n            cm.hideMenuItem(\"undo\");\n        }\n        cm.showMenuItem(\"redo\");\n    }\n}\n\nfunction redo() {\n    if (redo_stack.length != 0) {\n        var undo_item = get_sd();\n        undo_stack.push(undo_item);\n        state = redo_stack.pop();\n        loadJSON(JSON.stringify(state));\n        if (redo_stack.length == 0) {\n            cm.hideMenuItem(\"redo\");\n        }\n        cm.showMenuItem(\"undo\");\n    }\n}\n\nfunction dragover_handler(ev) {\n     ev.preventDefault();\n     ev.dataTransfer.dropEffect = \"move\";\n}\n\nfunction drop_handler(ev) {\n    ev.preventDefault();\n    position = {x: ev.clientX-280, y: ev.clientY+200};\n    var selection = get_selected_text();\n    if(selection != null || selection != undefined){\n        add_new_atom_node(selection);\n        clear_selection();\n        clear_focus();\n    }\n    else { console.log(\"Not a valid text selection.\"); }\n}\n\nfunction merge_nodes() {\n    //From all currently selected nodes, set first in selected to the base node, move all sources and edges related to each other node in selected to base node\n    var target;\n    var id;\n    var atom;\n    var baseNode = selected[0].target || selected[0].cyTarget;\n    var baseId = baseNode.id();\n    var baseAtom = get_atom(baseId);\n    var edge;\n    if (baseAtom.type == \"atom\") {\n        sds = get_sd();\n        var i = 0;\n        selected.forEach(function(node){\n            var j = 0;\n            if (i > 0) {\n                target = selected[i].target || selected[i].cyTarget;\n                id = target.id();\n                atom = get_atom(id);\n                if (atom.type == \"atom\") {\n                    atom.sources.forEach(function(source) {\n                        add_source(baseId, atom.sources[j].resource_id, atom.sources[j].text, atom.sources[j].offset, atom.sources[j].length);\n                        ++j;\n                    });\n                    j = 0;\n                    sds.edges.forEach(function(edge) {\n                        if (sds.edges[j].source_id == id) {\n                            edge = add_edge(baseId,sds.edges[j].target_id);\n                            cy.add([\n                              { group: \"edges\", data: { id: edge.id.toString(), source: baseId, target: sds.edges[j].target_id } }\n                            ]);\n                        }\n                        if (sds.edges[j].target_id == id) {\n                            edge = add_edge(sds.edges[j].source_id, baseId);\n                            cy.add([\n                            ]);\n                        }\n                        ++j;\n                    });\n                delete_nodes(selected[i]);\n                } else {\n                    alert(\"cannot merge scheme nodes\");\n                }\n            }\n            ++i;\n        });\n        selected = [];\n        cm.hideMenuItem(\"merge_nodes\");\n    } else {\n        alert(\"cannot merge scheme nodes\");\n    }\n}\n\nfunction edit_atom_content() {\n    var content = document.getElementById(\"edit_atom_content\").value;\n    var atom = cy.$(\"#\"+edit_atom.id());\n    update_atom_text(edit_atom.id(), content);\n    update_local_storage();\n    atom.data(\"content\", content);\n    edit_atom = null;\n}\n\nfunction edit_atom_metadata() {\n    var atom = cy.$(\"#\"+edit_atom.id());\n    var content = document.getElementById(atom.id()+\"_metadata\").value;\n    if (JSON.parse(content)) {\n        var metadata = JSON.parse(content);\n        update_atom_metadata(atom.id(), metadata);\n        update_local_storage();\n        edit_atom=null;\n    } else {\n        alert(\"Metadata not in JSON format, unable to update\");\n    }\n}\n\nfunction edit_scheme_content() {\n    var scheme_idx = document.getElementById(\"sel2\").options.selectedIndex;\n    var content = document.getElementById(\"sel2\").options[scheme_idx].text;\n    var scheme = cy.$(\"#\"+edit_atom.id());\n    update_scheme(edit_atom.id(), content);\n    update_local_storage();\n    scheme.data(\"content\", content);\n    edit_atom = null;\n}\n\nfunction clear_local_storage() {\n    localStorage.clear();\n    window.location.reload(false);\n}\n//******************************************************\n\nfunction add_new_scheme_node() {\n    var scheme_idx = document.getElementById(\"sel1\").options.selectedIndex;\n    var scheme = document.getElementById(\"sel1\").options[scheme_idx].text;\n    var new_scheme = add_scheme(scheme);\n    var scheme_id = new_scheme.id;\n\n    cy.add([\n        {group: \"nodes\", data: {id: scheme_id.toString(),\n            content: scheme, type: \"scheme\", typeshape: \"diamond\" }, classes: \"scheme-label\", locked: false, position: position}\n    ]);\n    update_local_storage();\n}\n\nfunction delete_nodes(event) {\n    var target = event.target || event.cyTarget;\n    var id = target.id();\n    removed = target.remove();\n    delete_atom(id);\n    var i = 0;\n    var sds = get_sd();\n    var edges = sds.edges;\n    edges.forEach(function(edge) {\n        if (edges[i] !== undefined) {\n            if (edges[i].source_id === id || edges[i].target_id === id) {\n                delete_edge(edges[i].id);\n            }\n            ++i;\n        }\n    });\n    update_local_storage();\n}\n\nfunction redraw_visualisation() {\n    layout.stop();\n    layout.options.eles = cy.elements();\n    layout.run();\n    cy.center();\n    cy.resize();\n}\n\nfunction mp_reset()\n{\n    clear_local_storage();\n}\n\nfunction set_analyst_name()\n{\n    analyst_name = document.getElementById('analyst_name_textarea').value;\n    update_analyst_name(analyst_name);\n}\n\nfunction set_analyst_email()\n{\n    analyst_email = document.getElementById('analyst_email_textarea').value;\n    update_analyst_email(analyst_email);\n}\n\n\n\n\n\n\nclass GraphContainer extends React.Component{\n    constructor(props){\n        super(props);\n        \n\n        this.state = {\n        \t\n        }\n        this.initialise_monkeypuzzle = this.initialise_monkeypuzzle.bind(this);\n        }\n    \n\n\n    \n\n    initialise_monkeypuzzle(){\n          //load diagram if there is one in localStorage\n        if (localStorage.getItem(\"state\"))\n        {\n          //  this.loadJSON(localStorage.getItem(\"state\"));\n            this.initCytoscape();\n        //else use default\n        } else\n        {\n            this.setState({current_sadface_doc: this.setDefault()})\n            localStorage.setItem(\"state\", this.state.current_sadface_doc);\n         //   cy_data = export_cytoscape({import_json(current_sadface_doc)});\n            this.initCytoscape();\n        }\n    }\n\n\n\n\n   \n\n  setDefault(){\n    this.setState({\n        analyst_email: \"Default Analyst Email\",\n        analyst_name: \"Default Analsyst Name\",\n        created: this.props.now(),\n        edges:[],\n        edited: this.props.now(),\n        id: this.props.new_uuid(),\n        metadata:{},\n        nodes:[],\n        resources: [],\n\n\n\n    });\n}\n\n\n    componentDidMount(){\n        this.initialise_monkeypuzzle();\n        this.setState({\n            cy: this.cy,\n            layout: this.layout,\n            position: this.position,\n        })\n   \n    }\n\n    render(){\n        return(\n            <div id=\"cy\" ondrop=\"drop_handler(event);\" ondragover=\"dragover_handler(event);\"></div>\n        )\n    }\n}\n\n\n\n\nexport default GraphContainer;"]},"metadata":{},"sourceType":"module"}